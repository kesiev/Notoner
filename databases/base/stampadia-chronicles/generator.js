GENERATOR=function(){function e(o,t){let i;e.cache||(e.cache={}),this.load=n=>{if(e.cache[o])i=e.cache[o],n();else{const r=new XMLHttpRequest;n&&(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status?(e.cache[o]=r.responseText,i=e.cache[o],n()):n())}),r.open("GET",o+(t?"?"+Math.random():""),!0),r.send()}},this.getSVG=()=>i}function o(e){const o={circle:{width:"r",height:"r",x:"cx",y:"cy"},default:{width:"width",height:"height",x:"x",y:"y"}},t={circle:{width:2,height:2}},i=document.createElement("div");let n=0,r=0,a=[];i.innerHTML=e.getSVG(),this.setPatcher=e=>r=e,this.get=(e,t)=>e.getAttribute((o[e.tagName]||o.default)[t]),this.getNum=(e,o)=>1*this.get(e,o)*(t[e.tagName]&&t[e.tagName][o]?t[e.tagName][o]:1),this.setNum=(e,o,i)=>this.set(e,o,i/(t[e.tagName]&&t[e.tagName][o]?t[e.tagName][o]:1)),this.set=(e,t,i)=>e.setAttribute((o[e.tagName]||o.default)[t],i),this.createNode=e=>document.createElementNS("http://www.w3.org/2000/svg",e),this.setClassName=(e,o)=>e.setAttribute("class",o),this.cloneNodeBy=(e,o,t,i,n,r)=>{let a;a="string"==typeof e?this.getById(e):e;const s=this.copyNode(a);return o&&this.setId(s,o),this.moveNodeAt(s,this.getNum(a,"x")+t,this.getNum(a,"y")+i),void 0!==n&&this.resizeNode(s,n,r),this.insertBefore(a,s),s},this.copyNode=e=>{const o=this.createNode(e.tagName);return["x","y","width","height","style","cx","cy","r","d","class","transform"].forEach((t=>{e.getAttribute(t)&&o.setAttribute(t,e.getAttribute(t))})),o.innerHTML=e.innerHTML,o},this.moveNodeAt=(e,o,t)=>{const i=this.getNum(e,"x"),n=this.getNum(e,"y"),r=o-i,a=t-n;this.setNum(e,"x",o),this.setNum(e,"y",t),[e.querySelectorAll("tspan"),e.querySelectorAll("rect"),e.querySelectorAll("circle")].forEach((e=>{for(let o=0;o<e.length;o++)this.setNum(e[o],"x",this.getNum(e[o],"x")+r),this.setNum(e[o],"y",this.getNum(e[o],"y")+a)}))},this.resizeNode=(e,o,t)=>{this.setNum(e,"width",o),this.setNum(e,"height",t)},this.insertBefore=(e,o)=>e.parentNode.insertBefore(o,e),this.getById=(e,o)=>(o||i).querySelector("#"+e),this.setId=(e,o)=>e.id=o,this.setClassName=(e,o)=>e.setAttribute("class",o),this.setImage=(e,o)=>this.getById(e).setAttribute("xlink:href",o),this.delete=e=>{e.parentNode.removeChild(e)},this.deleteById=e=>{let o=this.getById(e);o||(o=i.querySelector('[inkscape\\:label="'+e+'"]')),o&&this.delete(o)},this.setAttributeNumber=(e,o,t)=>{t=Math.floor(1e3*t)/1e3,e.setAttribute(o,t)},this.setText=(e,o)=>{const t=(""+o).split("\n"),i=e.querySelector("tspan"),n=i.getAttribute("style"),r=this.getNum(i,"x");let a=this.getNum(i,"y");a-=3.1*(t.length-1)/2,e.innerHTML="",t.forEach((o=>{const t=this.createNode("tspan");this.setAttributeNumber(t,"x",r),this.setAttributeNumber(t,"y",a),t.setAttribute("style",n),t.innerHTML=o,e.appendChild(t),a+=3.1}))},this.assignDownloadToAnchor=(e,o,t,i)=>{const n=new Blob([t],{type:o}),r=window.URL.createObjectURL(n);e.href=r,e.download=i},this.assignSVGDownloadToAnchor=(e,o)=>{this.assignDownloadToAnchor(e,"image/svg+xml",this.getSVG(),o)},this.assignPDFDownloadToAnchor=(e,o)=>{this.getPDF((t=>{this.assignDownloadToAnchor(e,"application/pdf",t,o)}))},this.downloadSVG=e=>{const o=document.createElement("a");document.body.appendChild(o),o.style.display="none",this.assignSVGDownloadToAnchor(o,e),o.click(),document.body.removeChild(o)},this.downloadPDF=e=>{this.getPDF((o=>{const t=document.createElement("a");document.body.appendChild(t),t.style.display="none",this.assignDownloadToAnchor(t,"application/pdf",o,e),t.click(),document.body.removeChild(t)}))},this.getSVG=()=>r?r(i.innerHTML):i.innerHTML,this.getPDF=e=>{if(a.length)a.push(e);else if(n)e(n);else{a.push(e);let o=document.createElement("div");o.innerHTML=this.getSVG();const t=o.firstElementChild;t.getBoundingClientRect();const i=new jspdf.jsPDF({orientation:"l",unit:"mm"});i.svg(t).then((()=>{n=i.output("arraybuffer"),a.forEach((e=>e(n))),a=[]}))}}}const t=function(t,i,n,r,a){const s=[{regex:/{roomId:([^}]*)}/g,replace:"{roomSymbol}{room:1}"},{regex:/{markRoom:([^}]*)}/g,replace:"{markRoomSymbol}{room:1}"},{regex:/{ifRoomIsMarked:([^}]*)}/g,replace:"{markRoomSymbol}{room:1}"},{regex:/{ifRoomIsNotMarked:([^}]*)}/g,replace:"{notMarkRoomSymbol}{room:1}"},{regex:/{teleportToRoom:([^}]*)}/g,replace:"{moveSymbol} anywhere in {roomLabelSymbol}{room:1}"},{regex:/{teleportToRiddleRoom:([^}]*)}/g,replace:"{moveSymbol} anywhere in {roomRiddle:1}"},{regex:/{ifMoveOn:([^}]*)}/g,replace:"{moveSymbol} {item:1}"},{regex:/{markItem:([^}]*)}/g,replace:"{itemMarkSymbol}{item:1}"},{regex:/{applyModifierOnRoomMarked:([^,]+),([^}]+)\}/g,replace:"{markRoomSymbol}{room:2}{and}{modifierCondition:1}{then}{modifierAction:1}"},{regex:/{applyModifierOnRoomNotMarked:([^,]+),([^}]+)\}/g,replace:"{notMarkRoomSymbol}{room:2}{and}{modifierCondition:1}{then}{modifierAction:1}"},{regex:/{applyModifier:([^}]+)}/g,replace:"{modifier:1}"},{regex:/{discoverRoom:([^}]*)}/g,replace:"discover {roomLabelSymbol}{room:1}"},{regex:/{drawItemAt:([^,]+),([^}]+)\}/g,replace:"draw {itemId:1} in {roomLabelSymbol}{room:2}"},{regex:/{regainSkill}/g,replace:'gain hero ability "{stealHeroSkill:1}"'}],l=r=r||Math.random();let m,d,h,c,p,f,g,y,u,k,R,v,b,w,x,T,I={},M={},E=0,S=[],N=[],D=[],O=0,C=!1,P=0,B=0,G=0,A=[],F=[],H=[],L=0,q={},K="",X="",Y=[],z=0,W=0,V=[],U=[],_={index:{},byRoomId:{},rooms:[]},Q={},j=[],J=[],Z={},$={};function ee(e){return(r=(9301*r+49297)%233280)/233280*e}function oe(e){return JSON.parse(JSON.stringify(e))}function te(e,o){return e.id>o.id?1:e.id<o.id?-1:0}function ie(e,o){return e.length>o.length?-1:e.length<o.length?1:0}function ne(e,o,t){return!(e<t.x||e>=t.x+t.width||o<t.y||o>=t.y+t.height)}function re(e,o,t){return t.id-e-o-2}function ae(e){for(let o=0;o<10;o++)for(let o=0;o<e.length;o++){const t=se(e),i=e[o];e[o]=e[t],e[t]=i}}function se(e){return Math.floor(ee(e.length))}function le(e){return e[se(e)]}function me(e,o){if(!(e&&e.length&&o&&o.length))return!1;for(let t=0;t<e.length;t++)if(-1!=o.indexOf(e[t]))return!0;return!1}function de(e){let o=0;do{o=le(_.rooms)}while(o.id==e);let t=e-o.id;return le(o.labels)+" Room "+(a&&a.solveRoomRiddles?"("+o.id+") ":"")+(t>0?"+ ":"- ")+Math.abs(t)+(a&&a.solveRoomRiddles?" = "+e:"")}function he(e,o,t){const i=e.getNum(o,"x"),n=e.getNum(o,"y"),r=e.getNum(o,"width"),a=e.getNum(o,"height"),s=r/2,l=a/2;switch(t){case 0:e.delete(o);break;case 1:break;case 2:e.cloneNodeBy(o,0,s,0),e.moveNodeAt(o,i-s,n);break;case 3:e.cloneNodeBy(o,0,-s,-l),e.cloneNodeBy(o,0,s,-l),e.moveNodeAt(o,i,n+l);break;case 4:e.cloneNodeBy(o,0,-s,-l),e.cloneNodeBy(o,0,s,-l),e.cloneNodeBy(o,0,-s,l),e.moveNodeAt(o,i+s,n+l);break;case 5:e.cloneNodeBy(o,0,-r,-l),e.cloneNodeBy(o,0,0,-l),e.cloneNodeBy(o,0,r,-l),e.cloneNodeBy(o,0,-s,l),e.moveNodeAt(o,i+s,n+l);break;case 6:e.cloneNodeBy(o,0,-r,-l),e.cloneNodeBy(o,0,0,-l),e.cloneNodeBy(o,0,r,-l),e.cloneNodeBy(o,0,-r,l),e.cloneNodeBy(o,0,0,l),e.moveNodeAt(o,i+r,n+l);break;case 7:e.cloneNodeBy(o,0,-r,-a),e.cloneNodeBy(o,0,0,-a),e.cloneNodeBy(o,0,r,-a),e.cloneNodeBy(o,0,-r,0),e.cloneNodeBy(o,0,0,0),e.cloneNodeBy(o,0,r,0),e.moveNodeAt(o,i,n+a);break;case 8:e.cloneNodeBy(o,0,-r,-a),e.cloneNodeBy(o,0,0,-a),e.cloneNodeBy(o,0,r,-a),e.cloneNodeBy(o,0,-r,0),e.cloneNodeBy(o,0,0,0),e.cloneNodeBy(o,0,r,0),e.cloneNodeBy(o,0,-s,a),e.moveNodeAt(o,i+s,n+a);break;case 9:e.cloneNodeBy(o,0,-r,-a),e.cloneNodeBy(o,0,0,-a),e.cloneNodeBy(o,0,r,-a),e.cloneNodeBy(o,0,-r,0),e.cloneNodeBy(o,0,0,0),e.cloneNodeBy(o,0,r,0),e.cloneNodeBy(o,0,-r,a),e.cloneNodeBy(o,0,0,a),e.moveNodeAt(o,i+r,n+a);break;case 10:e.cloneNodeBy(o,0,-r-s,-a),e.cloneNodeBy(o,0,-s,-a),e.cloneNodeBy(o,0,s,-a),e.cloneNodeBy(o,0,s+r,-a),e.cloneNodeBy(o,0,-r,0),e.cloneNodeBy(o,0,0,0),e.cloneNodeBy(o,0,r,0),e.cloneNodeBy(o,0,-r,a),e.cloneNodeBy(o,0,0,a),e.moveNodeAt(o,i+r,n+a);break;case 11:e.cloneNodeBy(o,0,-r-s,-a),e.cloneNodeBy(o,0,-s,-a),e.cloneNodeBy(o,0,s,-a),e.cloneNodeBy(o,0,s+r,-a),e.cloneNodeBy(o,0,-r-s,0),e.cloneNodeBy(o,0,-s,0),e.cloneNodeBy(o,0,s,0),e.cloneNodeBy(o,0,r+s,0),e.cloneNodeBy(o,0,-r,a),e.cloneNodeBy(o,0,0,a),e.moveNodeAt(o,i+r,n+a);break;default:e.cloneNodeBy(o,0,-r-s,-a),e.cloneNodeBy(o,0,-s,-a),e.cloneNodeBy(o,0,s,-a),e.cloneNodeBy(o,0,s+r,-a),e.cloneNodeBy(o,0,-r-s,0),e.cloneNodeBy(o,0,-s,0),e.cloneNodeBy(o,0,s,0),e.cloneNodeBy(o,0,r+s,0),e.cloneNodeBy(o,0,-r-s,a),e.cloneNodeBy(o,0,-s,a),e.cloneNodeBy(o,0,s,a),e.moveNodeAt(o,i+r+s,n+a)}}function ce(e,o){if(e.isStartingRoom||o&&-1!=o.indexOf(e.id))return[];let t=[e],i={},n={},r=0;for(i[e.id]=1;r<t.length;){let a=t[r++],s=a.exits;for(let r=0;r<s.length;++r){let l=s[r];if(i[l.toRoom.id]||l.toRoom.isOptionalRoom||o&&-1!=o.indexOf(l.toRoom.id))continue;let m=l.toRoom;if(i[m.id]=1,m.isStartingRoom){let o=[];for(;a!==e;)o.push(a.id),a=n[a.id];return o.push(a.id),o.reverse(),o}n[m.id]=a,t.push(m)}}return[]}function pe(e){return e.replace(/\{([^}]*)\}/g,((e,o)=>{const t=o.split("+"),i=[];if(t.forEach((e=>{c[e]&&i.push(e)})),i.length){const e=le(i);p[e]&&0!=p[e].length||(p[e]=oe(c[e]));const o=se(p[e]),t=p[e][o];return p[e].splice(o,1),t}return e}))}function fe(e){e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replaceAll("{hide}","^*v")).replaceAll("{nameLine}","_____________________________")).replaceAll("{heroClass}",d.heroClass)).replaceAll("{newRule}",Z.actions.newRule)).replaceAll("{and}",Z.actions.and)).replaceAll("{or}",Z.actions.or)).replaceAll("{then}",Z.actions.then)).replaceAll("{rollDie}","roll a die: ")).replaceAll("{nothing}","nothing happens")).replaceAll("{stopReading}","stop reading")).replace(/\{sumDice:([0-9]+)\}/g,((e,o)=>"sum "+o+" dice"))).replace(/\{activateAbility:([0-9]+)\}/g,((e,o)=>"activate "+o+" "+(1==o?"ability":"abilities")))).replace(/\{range:([0-9]+)-([0-9]+)\}/g,((e,o,t)=>o==t?"="+o:o+"~"+t))).replaceAll("{ifHeroDied}","hero died")).replaceAll("{ifAfterEnemyRollInFight}","enemy turn roll")).replaceAll("{ifAfterHeroRollInFight}","hero turn roll")).replaceAll("{ifAfterRollInFight}","any battle turn roll")).replaceAll("{ifAfterHeroLoseHp}","hero loses HP")).replace(/\{ifHeroPerformAction:([^}]+)\}/g,((e,o)=>"hero activates "+o))).replace(/\{ifEnemyPerformAction:([^}]+)\}/g,((e,o)=>"enemy activates "+o))).replace(/\{ifPerformAction:([^}]+)\}/g,((e,o)=>"any "+o+" activation"))).replaceAll("{ifHeroTurn}","hero turn")).replaceAll("{ifBeforeHeroRollInFight}","before hero turn roll")).replaceAll("{ifEveryBattleRoundStarts}","a battle round starts")).replace(/\{ifNextEnemyRolls:([0-9]+)\}/g,((e,o)=>"next "+o+" enemy turn rolls"))).replace(/\{ifNextHeroRolls:([0-9]+)\}/g,((e,o)=>"next "+o+" hero turn rolls"))).replace(/\{ifEnemyRolls:([0-9]+)\}/g,((e,o)=>"enemy turn rolled "+o))).replace(/\{ifHeroRolls:([0-9]+)\}/g,((e,o)=>"hero turn rolled "+o))).replace(/\{ifRolls:([0-9]+)\}/g,((e,o)=>"rolled "+o+" in battle"))).replaceAll("{pass}","pass")).replace(/\{fightingEnemyLoseHp:([0-9]+),([0-9]+),([0-9]+)\}/g,((e,o,t,i)=>"-"+o+"HP to "+(1*t?1==t?"1 enemy":"up to "+t+" enemies":"all enemies")+" in range "+i))).replace(/\{actionEffect:([-0-9]+)\}/g,((e,o)=>"effect "+(o>0?"+":"")+o))).replace(/\{modifyDice:([0-9]+),([-0-9]+)\}/g,((e,o,t)=>(t>0?"add":"reduce")+" "+o+" "+(1==o?"die":"dice")+" value by "+Math.abs(t)))).replace(/\{activateOnly:([-0-9]+)\}/g,((e,o)=>"can activate "+o+" "+(1==o?"ability":"abilities")+" only"))).replace(/\{reroll:([0-9]+)\}/g,((e,o)=>"reroll all "+o+" once"))).replace(/\{performByRoomSize:([^}]+)\}/g,((e,o)=>o+" by current room cells count"))).replace(/\{performFreeActionWithPower:([0-9]+),([0-9]+)\}/g,((e,o,t)=>"activate 1 "+(1==o?"ability":"abilities")+" using value "+t))).replaceAll("{ifEnterRoom}","enter {roomUnspacedLabelSymbol}")).replaceAll("{ifCrossDoor}","cross door")).replaceAll("{ifMoveOnStairs}","{moveSymbol} on stairs")).replaceAll("{ifNoFoes}","no foes")).replaceAll("{ifKilledLastFoe}","killed last foe")).replaceAll("{goBack}","move back")).replaceAll("{moveOnStairs}","{moveSymbol} on stairs")).replaceAll("{roomIsEmpty}","{roomUnspacedLabelSymbol} is empty")).replaceAll("{noEscape}","no escape")).replaceAll("{teleportToStartingRoom}","{moveSymbol} anywhere in starting {roomUnspacedLabelSymbol}")).replace(/\{discoverAnyRoom:([0-9]+)\}/g,((e,o)=>"select "+o+" "+(1==o?"room":"rooms")+", discover "+(1==o?"it":"them")))).replace(/\{ifPayHp:([0-9]+)\}/g,((e,o)=>"{paySymbol}"+o+"HP"))).replace(/\{ifHpLeft=:([0-9]+)\}/g,((e,o)=>"HP left ="+o))).replaceAll("{gainFullHp}","+"+m.maxHp+"HP")).replaceAll("{loseFullHp}","-"+m.maxHp+"HP")).replaceAll("{killHero}","-"+(m.maxHp+1)+"HP")).replace(/\{loseFullHp-:([0-9]+)\}/g,((e,o)=>"-"+(m.maxHp-o)+"HP"))).replaceAll("{gainHalfHp}","+"+Math.ceil(m.maxHp/2)+"HP")).replaceAll("{loseHalfHp}","-"+Math.ceil(m.maxHp/2)+"HP")).replace(/\{gainHp:([0-9]+)\}/g,((e,o)=>"+"+o+"HP"))).replace(/\{loseHp:([0-9]+)\}/g,((e,o)=>"-"+o+"HP"))).replace(/\{ifPayXp:([0-9]+)\}/g,((e,o)=>"{paySymbol}"+o+"XP"))).replace(/\{gainXp:([0-9]+)\}/g,((e,o)=>"+"+o+"XP"))).replace(/\{loseXp:([0-9]+)\}/g,((e,o)=>"-"+o+"XP"))).replace(/\{ifPayGold:([0-9]+)\}/g,((e,o)=>"{paySymbol}"+o+"G"))).replace(/\{ifGoldLeft<half\}/g,((e,o)=>"<"+(Math.floor(L/2)+1)+"G left"))).replace(/\{ifGoldLeft>half\}/g,((e,o)=>">"+Math.floor(L/2)+"G left"))).replace(/\{ifGoldSpentInFifth:([0-9]+)-([0-9]+)\}/g,((e,o,t)=>Math.floor(L/5)*(o-1)+(1==o?0:1)+"~"+(5==t?L:Math.floor(L/5)*t)+"G spent"))).replace(/\{andPayGoldToReach:([0-9]+)\}/g,((e,o)=>"+ G to reach >="+o))).replace(/\{gainGold:([0-9]+)\}/g,((e,o)=>"+"+o+"G"))).replace(/\{loseGold:([0-9]+)\}/g,((e,o)=>"-"+o+"G"))).replace(/\{ifRolled:([0-9]+),([0-9]+)\}/g,((e,o,t)=>o+" "+(1==o?"die":"dice")+" is "+t))).replace(/\{ifDiscardDie:([0-9]+),([0-9]+)\}/g,((e,o,t)=>"discard "+o+" rolled "+t))).replace(/\{ifSetDie:([0-9]+),([0-9]+),([0-9]+)\}/g,((e,o,t,i)=>"set "+o+" rolled "+t+" to "+i))).replace(/\{setDieTo:([0-9]+),([0-9]+)\}/g,((e,o,t)=>"set "+o+" "+(1==o?"die":"dice")+" to "+t))).replace(/\{discardAnyDie:([0-9]+)\}/g,((e,o)=>"discard "+o+" "+(1==o?"die":"dice")))).replace(/\{discardAllDie<=:([0-9]+)\}/g,((e,o)=>"discard dice <="+o))).replace(/\{flipDieUpsideDown:([0-9]+)\}/g,((e,o)=>"flip "+o+" "+(1==o?"die":"dice")))).replaceAll("{playLowerDieFirst}","play lower die first")).replaceAll("{placeDiceInSameColumn}","play dice in same column")).replaceAll("{placeDiceInSameRow}","play dice in same row");for(const o in q)e=e.replaceAll("{"+o+"}",q[o]);return e=(e=(e=(e=(e=(e=(e=(e=e.replaceAll("{itemMarkSymbol}",Z.items.mark)).replaceAll("{markRoomSymbol}",Z.rooms.markRoom)).replaceAll("{notMarkRoomSymbol}",Z.rooms.notMarkRoom)).replaceAll("{roomSymbol}",Z.rooms.symbol)).replaceAll("{roomUnspacedLabelSymbol}",Z.rooms.unspacedLabel)).replaceAll("{roomLabelSymbol}",Z.rooms.label)).replaceAll("{moveSymbol}",Z.actions.move)).replaceAll("{paySymbol}",Z.actions.pay)}function ge(e){return[{regex:/\{ifKeyword:([^}]+)\}/g,verb:"know"},{regex:/\{ifNotKeyword:([^}]+)\}/g,verb:"don't know"},{regex:/\{ifLoseKeyword:([^}]+)\}/g,verb:"forget"},{regex:/\{loseKeyword:([^}]+)\}/g,verb:"forget"},{regex:/\{getKeyword:([^}]+)\}/g,verb:"learn"}].forEach((o=>{e=e.replace(o.regex,((e,t)=>{let i=I[t];return i||console.warn("Can't find keyword",t),o.verb+" '"+(i?i.label+"'":"{missingKeyword}")}))})),[{regex:/\{ifKeywordSet:([^}]+)\}/g,verb:"know any"},{regex:/\{ifNotKeywordSet:([^}]+)\}/g,verb:"don't know any"},{regex:/\{ifLoseKeywordSet:([^}]+)\}/g,verb:"forget any"},{regex:/\{loseKeywordSet:([^}]+)\}/g,verb:"forget any"},{regex:/\{getKeywordSet:([^}]+)\}/g,verb:"learn any"}].forEach((o=>{e=e.replace(o.regex,((e,t)=>{let i=M[t];return i||console.warn("Can't find keyword",t),o.verb+" '"+(i?i.label+"...'":"{missingKeywordSet}")}))})),e}function ye(e){const o={roomIds:{},itemIds:{}};return e=ge(e=pe(e)),[{regex:/\{payEquip:([^}]+)\}/g,verb:Z.equipment.pay},{regex:/\{loseEquip:([^}]+)\}/g,verb:Z.equipment.lose},{regex:/\{getEquip:([^}]+)\}/g,verb:Z.equipment.get},{regex:/\{nameEquip:([^}]+)\}/g}].forEach((o=>{e=e.replace(o.regex,((e,t)=>{let i=q[t];return i||(i=le(Y).equipment.label),(o.verb?o.verb:"")+i}))})),s.forEach((t=>{e=e.replace(t.regex,(function(){const e=arguments;return t.replace.replace(/{([^:}]*):([^}]*)}/g,((t,i,n)=>{switch(i){case"roomRiddle":case"room":return o.roomIds[e[n]]||(o.roomIds[e[n]]=le(U)),"roomRiddle"==i?de(o.roomIds[e[n]].id):o.roomIds[e[n]].id;case"itemId":case"item":return Z.items.roomsTable[1];case"stealHeroSkill":return"ATK -1 RNG 1";case"modifierCondition":return N[le(D)].condition;case"modifierAction":return N[le(D)].action;case"modifier":return N[le(D)].full;default:return t}}))}))})),e=fe(e)}function ue(e,o){e=(e=(e=(e=(e=ge(e=pe(e))).replace(/\{payEquip:([^}]+)\}/g,((e,o)=>Z.equipment.pay+q[o]))).replace(/\{loseEquip:([^}]+)\}/g,((e,o)=>Z.equipment.lose+q[o]))).replace(/\{getEquip:([^}]+)\}/g,((e,o)=>Z.equipment.get+q[o]))).replace(/\{nameEquip:([^}]+)\}/g,((e,o)=>q[o])),s.forEach((t=>{e=e.replace(t.regex,(function(){const e=arguments;return t.replace.replace(/{([^:}]*):([^}]*)}/g,((t,i,n)=>{switch(i){case"roomRiddle":case"room":{let r;return o&&(r=o.roomIds[e[n]]),r||(r=q.roomIds[e[n]]),r?"roomRiddle"==i?de(r.id):r.id:(console.warn("can't find room",e[n],"in line",t),"{missingRoom}")}case"modifierCondition":return N[e[n]].condition;case"modifierAction":return N[e[n]].action;case"modifier":return N[e[n]].full;case"item":return Z.items.roomsTable[o.itemIds[e[n]]];case"itemId":return e[n];case"stealHeroSkill":return o.stealHeroSkill;default:return t}}))}))}));for(const t in o)e=e.replaceAll("{"+t+"}",o[t]);return e=fe(e)}function ke(e,o,t){if(e.text)return e.text;if(o||e.fakeLine){let o=e.fakeLine||e[t];for(let e=0;e<3;e++)o=ye(o);return o=o.replace(/{[^}]*}/g,'"..."'),o}{let o=e.line||e[t];for(let t=0;t<3;t++)o=ue(o,e.placeholders);return o}}function Re(e){return Array.isArray(e)?e[se(e)]:e}function ve(e,o,t,i,n){let r={id:o.id,isAvailable:!!t,equipment:o};return e.push(r),n&&(n["equip-"+i]=o.label,n["equip-"+o.id]=o.label),r}function be(e,o,t){let i;if(e.length<3&&o.length)for(var n=0;n<o.length;n++)if(o[n].id==t)return i=o[n],o.splice(n,1),i;return!1}function we(e,o){let t;if(e.length<3&&o.length){let e=se(o);return t=o[e],o.splice(e,1),t}return!1}this.prepared=!1,this.setSymbolsMap=e=>Z=e,this.setMixMode=e=>C=e,this.setRoomsModels=e=>P=e,this.setComplexityEvaluation=e=>x=e,this.setShredderMode=e=>w=e,this.setModifiers=e=>E=e,this.setModifiersModel=e=>O=e,this.setRoomPriorities=e=>b=e,this.setKeywords=e=>g=e,this.setEquipment=e=>f=e,this.setTruthMap=e=>v=e,this.setRoomIds=e=>z=e,this.setMapGuidesEvery=e=>W=e,this.setHeroModels=e=>h=e,this.setEnemyModels=e=>R=e,this.setQuests=e=>u=e,this.setFlavorTexts=e=>y=e,this.setPlaceholderModels=e=>k=e,this.setGold=e=>L=e,this.setQuestsStructure=e=>H=e,this.setFooter=e=>K=e,this.setRandomizers=e=>{c=oe(e),p={}};const xe=function(e,o,t,i,n,r,a){return this.priorityId=e,this.x=o,this.y=t,this.isFake=!1,this.width=i,this.height=n,this.isCorridor=!!r,this.isStartingRoom=!!a,this.isMarkable=this.isStartingRoom,this.hasEnemies=!1,this.isExclusive=!1,this.itemsIndex=[],this.items=[],this.entrancesIndex=[],this.entrances=[],this.exits=[],this.description=[],this.isOptionalRoom=!1,this.genericItemId=0,this.addItem=function(e,o,t){if(this.entrancesIndex[o]&&this.entrancesIndex[o][e])console.warn("Conflicting space in room",this," @",e,",",o,"want place",t,"but there is an entrance");else{if(!this.itemsIndex[o]||!this.itemsIndex[o][e]){const i={x:e,y:o,item:t};return this.itemsIndex[o]||(this.itemsIndex[o]=[]),this.itemsIndex[o][e]||(this.itemsIndex[o][e]=[]),this.itemsIndex[o][e].push(i),this.items.push(i),!0}console.warn("Conflicting space in room",this," @",e,",",o,"want place",t,"but there is an item",this.itemsIndex[o][e])}},this.addEntrance=function(e,o,t){const i={x:e-=this.x,y:o-=this.y,fromRoom:t};this.entrancesIndex[o]||(this.entrancesIndex[o]=[]),this.entrancesIndex[o][e]||(this.entrancesIndex[o][e]=[]),this.entrancesIndex[o][e].push(i),this.entrances.push(i)},this.removeEntrance=function(e,o,t){if(e-=this.x,o-=this.y,this.entrancesIndex[o]&&this.entrancesIndex[o][e]){let i=this.entrancesIndex[o][e];for(let n=0;n<i.length;n++)if(i[n].x==e&&i[n].y==o&&i[n].fromRoom==t){let e=this.entrances.indexOf(i[n]);-1!=e&&this.entrances.splice(e,1),i.splice(n,1)}i.length||(this.entrancesIndex[o][e]=0)}},this.getFreeSpaces=function(){const e=[];for(let o=0;o<this.height;o++)for(let t=0;t<this.width;t++)this.itemsIndex[o]&&this.itemsIndex[o][t]||this.entrancesIndex[o]&&this.entrancesIndex[o][t]||e.push({x:t,y:o});return e},this.addExit=function(e,o,t,i,n,r){this.exits.push({toRoom:r,x:e,y:o,fromX:t,fromY:i,side:n})},this.removeExit=function(e,o,t,i){for(let n=0;n<this.exits.length;n++)this.exits[n].toRoom===t&&(this.removeEntrance(e,o,t),i||(this.exits.splice(n,1),n--))},this.setId=function(e){this.id=e},this.removeRooms=function(e){const o=[];this.exits.forEach((t=>{-1==e.indexOf(t.toRoom)&&o.push(t)})),this.exits=o},this.createEntrances=function(){this.exits.forEach((e=>{e.toRoom.addEntrance(e.x,e.y,this)}))},this.shuffleExits=function(){ae(this.exits)},this.makeFake=function(){this.isFake=!0,this.exits=[],this.itemsIndex=[],this.items=[],this.entrancesIndex=[],this.entrances=[],this.description=[]},this.makeOptional=function(){this.isOptionalRoom=!0},this.makeHidden=function(){this.makeOptional(),this.exits.forEach((e=>{e.toRoom.removeExit(e.x,e.y,this)})),this.exits=[],this.entrances=[],this.entrancesIndex=[]},this.makeDeadEnd=function(){this.makeOptional();var e=le(this.exits.filter((e=>!e.toRoom.isDeadEndRoom)));this.exits.forEach((o=>{o!==e&&(o.toRoom.removeExit(o.x,o.y,this),this.removeExit(o.fromX,o.fromY,o.toRoom,!0))})),this.exits=[e]},this.applyDelta=function(e){this.id+=e},this};function Te(e,o){return success=!0,C?(success&=!e.room.isExclusive,success&=!o.isExclusive||!e.room.isBusy,success&=!o.hasEnemies||!e.room.hasEnemies,success&=!o.isMarkable||!e.room.isMarkable):success&=o.allowBusyRooms||!e.room.isBusy,success&&(o.isOptionalRoom||o.isHiddenRoom||o.isDeadEndRoom)&&(success=function(e){if(void 0===$[e]){let o=[e];$[e]=!0;for(let t=0;t<U.length;t++)if(!U[t].isStartingRoom&&U[t].id!=e&&!ce(U[t],o).length){$[e]=!1;break}}return $[e]}(e.room.id)),success&=!o.items||e.freeSpaces.length>=o.items.length,success&=!o.stealHeroSkill||Me(o.stealHeroSkill),success&=!o.roomDescriptions||e.room.description.length+o.roomDescriptions[0].length<=2,success}function Ie(e,o){o&&o.forEach((o=>{if(_.index[o]){if(-1!=_.index[o]){let e=_.byRoomId[_.index[o]];e.splice(e.indexOf(o),1),0==e.length&&delete _.byRoomId[_.index[o]],_.index[o]=-1}}else _.index[o]=e,_.byRoomId[e]||(_.byRoomId[e]=[]),_.byRoomId[e].push(o)}))}function Me(e){return!!m.tagsCount[e]}function Ee(e,o){let t;return t=e?1==e?o.singular:o.plural:o.zero,t.replaceAll("{value}",e)}return this.addRoom=function(e,o,t,i,n,r,a){const s=new xe(e,Re(o),Re(t),Re(i),Re(n),r,a);return U.push(s),s},this.scatterRooms=function(){let e,o,t,r,a=!1,s=le(b),l=[];for(U.forEach((e=>{var o=s[e.priorityId];l[o]||(l[o]=[]),l[o].push(e)})),l.forEach((e=>ae(e))),U=l.flat();!a;){e=9999,o=9999;let s=0,l=0,h=ee(2*Math.PI);for(let t=0;t<U.length;t++){h+=.1+ee(1);let i=!1,n=U[t],r=Math.sin(h),a=Math.cos(h),c=0,p=0;for(n.x=0,n.y=0;!i;){i=!0;for(let e=0;e<t;e++)if(m=n,d=U[e],!(m.x+m.width<=d.x||m.x>=d.x+d.width||m.y+m.height<=d.y||m.y>=d.y+d.height)){i=!1;break}i||(c+=r,p+=a,Math.abs(n.x-c)>Math.abs(n.y-p)?n.x>c?n.x--:n.x++:n.y>p?n.y--:n.y++)}n.x=Math.floor(n.x),n.y=Math.floor(n.y),n.x<e&&(e=n.x),n.y<o&&(o=n.y),n.x+n.width>s&&(s=n.x+n.width),n.y+n.height>l&&(l=n.y+n.height)}t=s-e,r=l-o,a=t<=i&&r<=n}var m,d;return!!a&&(e-=Math.floor((i-t)/2),o-=Math.floor((n-r)/2),U.forEach((t=>{t.x-=e,t.y-=o})),!0)},this.assignIdRooms=function(){const e=[];for(let o=0;o<z;o++)e.push(o);ae(e),U.forEach(((o,t)=>o.setId(e[t])))},this.prepareExits=function(){const e={},o=[];U.forEach((o=>{for(let t=o.x;t<o.x+o.width;t++)for(let i=o.y;i<o.y+o.height;i++)U.forEach((n=>{if(o!==n){const r=Math.min(o.id,n.id)+"-"+Math.max(o.id,n.id);e[r]||(e[r]=[]),ne(t-1,i,n)&&e[r].push({from:{room:o,x:t,y:i},to:{room:n,x:t-1,y:i},sides:["left","right"]}),ne(t+1,i,n)&&e[r].push({from:{room:o,x:t,y:i},to:{room:n,x:t+1,y:i},sides:["right","left"]}),ne(t,i-1,n)&&e[r].push({from:{room:o,x:t,y:i},to:{room:n,x:t,y:i-1},sides:["up","down"]}),ne(t,i+1,n)&&e[r].push({from:{room:o,x:t,y:i},to:{room:n,x:t,y:i+1},sides:["down","up"]})}}))}));for(const o in e)if(e[o].length){const t=le(e[o]);t.from.room.addExit(t.to.x,t.to.y,t.from.x,t.from.y,t.sides[0],t.to.room),t.to.room.addExit(t.from.x,t.from.y,t.to.x,t.to.y,t.sides[1],t.from.room)}U.forEach((e=>{j.push(e),e.isCorridor&&e.exits.length<2?V.push(e):o.push(e)})),o.forEach((e=>e.removeRooms(V))),o.forEach((e=>e.createEntrances())),o.forEach((e=>e.shuffleExits())),U=o},this.optimizeIds=function(){let e=1e4;return j.forEach((o=>{o.exits.forEach((o=>{const t=re(o.x,o.y,o.toRoom);t<e&&(e=t)}))})),j.forEach((o=>o.applyDelta(-e))),e},this.sortRooms=function(){U.sort(te)},this.getRoutes=function(){const e={},o=[];return U.forEach((o=>{e[o.id]={room:o,freeSpaces:o.getFreeSpaces()}})),U.forEach((t=>{t.isStartingRoom||t.isOptionalRoom||o.push(ce(t).map((o=>e[o])))})),o.sort(ie),o},this.getQuestSubroute=function(e,o,t){let i=o.minRooms||t.length;if(e.length<i)return!1;if((!o.ignoreForHeroTags||!me(o.ignoreForHeroTags,d.tags))&&(!o.onlyForHeroTags||me(o.onlyForHeroTags,d.tags))){const o=oe(Y),i=oe(f);let r=!0;if(t.forEach((e=>{e.equipment&&e.equipment.forEach((e=>{let t=be(o,i,e.id);t?ve(o,t):r=!1})),e.globalModifier&&G&&(r=!1)})),r){const o=[],i=[];if(t.forEach(((e,o)=>{let t=e.atPercentage;t.from&&(t=t.from+Math.floor(ee(t.to-t.from))),i.push({step:e,id:o,atPercentage:t})})),i.sort(((e,o)=>e.atPercentage<o.atPercentage?-1:e.atPercentage>o.atPercentage?1:0)),w){const e={};toVisit=[],distance=0,U.forEach((o=>{o.isStartingRoom?(toVisit.push(o),e[o.id]=!0):o.isFake&&(e[o.id]=!0)}));do{let t=[];toVisit.forEach((n=>{n.exits.forEach((n=>{if(!n.toRoom.isFake&&!e[n.toRoom.id]){var r={room:n.toRoom,freeSpaces:n.toRoom.getFreeSpaces()};o[distance]||(o[distance]={fitSteps:{},step:-1}),i.forEach((e=>{Te(r,e.step)&&(o[distance].fitSteps[e.id]||(o[distance].fitSteps[e.id]=[]),o[distance].fitSteps[e.id].push(r))})),e[n.toRoom.id]=!0,t.push(n.toRoom)}}))})),toVisit=t,distance++}while(toVisit.length)}else e.forEach(((e,t)=>{let n={room:e,id:t,fitSteps:{},step:-1};i.forEach((o=>{Te(e,o.step)&&(n.fitSteps[o.id]=[e])})),o.unshift(n)}));let a=-1;if(r=!0,i.forEach((e=>{for(;r;)if(a++,o[a]){if(o[a].fitSteps[e.id])break}else r=!1;r&&(e.room=a)})),r){let e=o.length-1,a=1e3,s=-1;const l=[];for(var n=i.length-1;n>=0;n--){let t,m=i[n],d=Math.max(Math.min(Math.floor(m.atPercentage/101*o.length),e),m.room),h=0==m.atPercentage||100==m.atPercentage;for(t=d;t>=m.room;t--)if(o[t].fitSteps[m.id]){if(h&&t!=d){r=!1;break}l[m.id]=le(o[t].fitSteps[m.id]),m.room=t,t>s&&(s=t),t<a&&(a=t);break}if(e=t-1,!r)break}return!!r&&(l.length,t.length,{subroute:l,farthestRoom:s,nearestRoom:a})}}}return!1},this.addQuest=function(e,o,t){const i=[],n=[],r=this.getRoutes();let a=0;if(e.forEach((e=>{const s=[];if(-1==o.indexOf(e)&&(e.steps.forEach((o=>{let i={},n={},a=[];if(longestRoute=0,shortestRoute=0,r.forEach((t=>{const r=this.getQuestSubroute(t,e,o);r&&(i[r.nearestRoom]||(i[r.nearestRoom]=[]),i[r.nearestRoom].push(r),n[r.farthestRoom]||(n[r.farthestRoom]=[]),n[r.farthestRoom].push(r),a.push(r),(!longestRoute||r.farthestRoom>longestRoute)&&(longestRoute=r.farthestRoom),(!shortestRoute||r.nearestRoom<shortestRoute)&&(shortestRoute=r.nearestRoom))})),e.debugger,a.length){var l;switch(t||e.distance){case"nearest":l=le(i[shortestRoute]);break;case"farthest":l=le(n[longestRoute]);break;default:l=le(a)}s.push({subroute:l.subroute,quest:e,steps:o})}})),s.length)){let e=le(s),o=e.quest.complexity;n.push(a),a+=o,i.push(e)}})),i.length){let e,o=ee(a);for(let t=0;t<n.length&&o>=n[t];t++)e=i[t];return this.applyQuest(e.subroute,e.quest,e.steps),e.quest}return!1},this.evaluateQuestsComplexity=function(){for(let e in u)u[e].forEach((e=>{if(x){let o=1;e.steps[0].forEach((e=>o+=.3+(e.equipment?.3:0)+(e.isHiddenRoom||e.isDeadEndRoom||e.isOptionalRoom?1:0))),o*=e.probability?e.probability/100:1,e.complexity=o}else e.complexity=e.probability?e.probability/100:1}))},this.addQuestsMetadata=function(){for(let e in u)u[e].forEach((e=>{e.steps.forEach((o=>{let t={startingRoom:B},i={};o.forEach((e=>{t[e.id]=e,(e.isHiddenRoom||e.isDeadEndRoom||e.isOptionalRoom)&&(e.isExclusive=!0),e.roomDescriptions&&e.roomDescriptions.forEach((o=>{o.forEach((o=>{o.replace(/{markRoom:([^}]*)}/g,((e,o)=>i[o]=1)),(o.match("{ifNoFoes}")||o.match("{ifKilledLastFoe}")||o.match("{roomIsEmpty}"))&&(e.isExclusive=!0)}))})),e.items&&e.items.forEach((o=>{"enemy"==o.id&&(e.hasEnemies=!0)}))}));for(let n in i)t[n]?t[n].isMarkable=!0:console.warn("Missing room reference in",e,"step",o)}))}))},this.addQuests=function(){let e,o=[];H.forEach((t=>{if(!t.probability||ee(100)<t.probability)for(let i=0;i<t.count;i++)t.debugger,e=this.addQuest(u[t.questType],o,t.distance),e?o.push(e):a&&a.logMissingQuests&&console.log("Can't add requested",t.questType,"at",t.distance)}))},this.generateDictionaries=function(){for(let e in _.byRoomId)_.rooms.push({id:e,labels:_.byRoomId[e]})},this.applyQuest=function(e,o,t){const i={roomIds:{},itemIds:{}};t.forEach(((o,t)=>{i.roomIds[o.id]=e[t].room,q.roomIds[o.id]=e[t].room})),U.forEach((e=>{i.roomIds["id-"+e.id]=e,e.isStartingRoom&&(i.roomIds.startingRoom=e)})),o.generator&&o.generator(Q,i),t.forEach(((o,t)=>{const n=e[t];if(n.room.isBusy=!0,o.items&&o.items.forEach((e=>{const o=se(n.freeSpaces),t=n.freeSpaces.splice(o,1)[0];e.genericItem?(n.room.genericItemId++,n.room.addItem(t.x,t.y,{id:"genericItem",itemId:n.room.genericItemId,isHidden:e.isHidden}),i.itemIds[e.genericItem]=n.room.genericItemId):n.room.addItem(t.x,t.y,e)})),o.globalModifier&&(G={line:o.globalModifier,placeholders:i}),o.stealHeroSkill){let e=function(e){let o=[];if(Me(e)){m.skills.forEach(((t,i)=>{t.skills.forEach(((t,n)=>{t.tags&&-1!=t.tags.indexOf(e)&&o.push({col:i,row:n,text:t.skill.replace(/\n/g," "),skill:t})}))}));let t=le(o);if(t)return t.skill.tags.forEach((e=>m.tagsCount[e]--)),m.skills[t.col].skills[t.row].skill="",m.skills[t.col].skills[t.row].cost="",t}}(o.stealHeroSkill);i.stealHeroSkill=e.text}o.isDeadEndRoom&&(n.room.isDeadEndRoom=!0)})),t.forEach(((o,t)=>{if(o.roomDescriptions){const n=le(o.roomDescriptions),r=e[t].room;n.forEach((e=>{r.description.push({line:e,placeholders:i})})),o.isMarkable&&(r.isMarkable=!0),o.hasEnemies&&(r.hasEnemies=!0),o.isExclusive&&(r.isExclusive=!0),o.shuffleRoomDescriptions&&ae(r.description),o.equipment&&o.equipment.forEach((e=>{let t=be(Y,f,e.id);t?ve(Y,t,e.isAvailable,e.placeholder,q):console.warn("Can't find quest equipment",o)})),o.isHiddenRoom?r.makeHidden():o.isDeadEndRoom?r.makeDeadEnd():o.isOptionalRoom&&r.makeOptional(),r.isOptionalRoom&&($={}),Ie(r.id,o.labels)}})),o.otherDescriptions&&o.otherDescriptions.forEach((e=>{const o=le(e.roomDescriptions),t=i.roomIds[e.at];o.forEach((e=>{t.description.push({line:e,placeholders:i})})),Ie(t.id,e.labels)})),o.adventureTitle&&(X=le(o.adventureTitle),this.metadata.title.line=X),a&&a.dumpSelection&&this.metadata.selection.push({quest:o,route:e})},this.addFlavorTexts=function(){const e=oe(y);j.forEach((o=>{if(o.description.length<2)if(o.isCorridor){if(e.corridors.length){let t=se(e.corridors),i=e.corridors[t];a&&a.flavorText&&(i=a.flavorText),e.corridors.splice(t,1),o.description.unshift({text:i})}}else if(e.rooms.length){let t=se(e.rooms),i=e.rooms[t];a&&a.flavorText&&(i=a.flavorText),e.rooms.splice(t,1),o.description.unshift({text:i})}}))},this.sortEquipment=function(){Y.sort(((e,o)=>e.isAvailable&&!o.isAvailable?-1:!e.isAvailable&&o.isAvailable?1:e.equipment.label<o.equipment.label?-1:e.equipment.label>o.equipment.label?1:0))},this.indexModifiers=function(){for(let e in E)for(let o in E[e]){let t=E[e][o],i=t.roomDescription.split("{then}"),n=e+"."+o;S[t.type]||(S[t.type]=[]),S[t.type].push(t),D.push(n),N[n]={full:t.roomDescription,condition:i[0],action:i[1]}}},this.addNoise=function(){const e=[],o={},t={},r=[];function a(i,n){const r=i+","+n;t[r]||(F.push({id:"fakeEntrance",x:i,y:n}),o[r]&&(e.splice(e.indexOf(o[r]),1),delete o[r]),t[r]=1)}for(let t=0;t<n;t++)for(let a=0;a<n;a++){const s={x:a,y:t};let l=!1,m=!1,d=!1;U.forEach((e=>{ne(a,t,e)?l=e:ne(a+1,t,e)?m=e:ne(a,t+1,e)&&(d=e)})),l||(o[a+","+t]=s,e.push(s),a+1==i||m||r.push({id:"fakeDoorRight",x:s.x,y:s.y,dx:s.x+1,dy:s.y}),t+1==n||d||r.push({id:"fakeDoorDown",x:s.x,y:s.y,dx:s.x,dy:s.y+1}))}for(let e=0;e<20;e++)if(r.length){const e=se(r),o=r[e];r.splice(e,1),F.push(o),a(o.x,o.y),a(o.dx,o.dy)}for(let o=0;o<20;o++)if(e.length){const o=se(e),t=e[o];switch(e.splice(o,1),le(["fakeEnemy","fakeGenericItem"])){case"fakeEnemy":F.push({id:"fakeEnemy",x:t.x,y:t.y,level:Math.floor(ee(4))});break;case"fakeGenericItem":F.push({id:"fakeGenericItem",x:t.x,y:t.y,itemId:1+Math.floor(ee(2))})}}for(;Y.length<3;){let e=we(Y,f);if(!e)break;ve(Y,e).isFake=!0}},this.addFakeRooms=function(){for(const e in u)u[e].forEach((e=>{le(e.steps).forEach((e=>{e.roomDescriptions.forEach((e=>{J.push(e)}))}))}));V.forEach((e=>{e.makeFake();le(J).forEach((o=>{e.description.push({fakeLine:(a&&a.showFake?"[FAKE] ":"")+o})})),U.push(e)}))},this.generateEnemies=function(){R.forEach(((e,o)=>{var t=oe(e.skills);d.enemyModels[o].skills.forEach((e=>t.push(e))),A.push({isVirtual:e.isVirtual,level:o,gainXp:o||1,defense:o||1,skills:le(t),truth:{eyes:o,horns:2,foes:1,level1:0==o?1:0,level2:1==o?1:0,level3:2==o?1:0,level4:3==o?1:0,zombie:4==o?1:0}})}))},this.generateHero=function(){let e=0;const o={low:0,high:0,all:0};U.forEach((t=>{t.items.forEach((t=>{if("enemy"==t.item.id)if(e++,t.item.ignoreXp)a&&a.dumpXPs&&console.log("XP","Ignoring",t.item);else{const e=A[0].gainXp+(t.item.level?A[t.item.level].gainXp:0);if(o.all+=e,a&&a.dumpXPs&&console.log("XP","Adding Lv.",t.item.level,"enemy for",A[0].gainXp,"+",t.item.level?A[t.item.level].gainXp:0,"=",e,"XPs from",t.item),0===t.item.level)o.low+=e;else o.high+=e}}))})),a&&a.dumpXPs&&console.log("XP","Total XPs",o),o.low<3&&o.high>3&&(o.high-=3-o.low,o.low=3);const t=e*d.damageRatio;d.skills.forEach(((e,i)=>{const n=Math.ceil(d.hpRamp[i]*t);let r=0;if(r=void 0!==d.xpRamp[i].value?d.xpRamp[i].value:o[d.xpRamp[i].xpGroup]*d.xpRamp[i].percentage,"floor"===d.xpRamp[i].round)r=Math.floor(r)||1;else r=Math.ceil(r);m.skills[i].xp=r,m.skills[i].hp=n,m.maxHp+=n}))},this.selectHeroModel=function(){let e=[];if(h.forEach((o=>{o.isBetaTesting||e.push(o)})),d=le(e),a&&a.heroId&&h.forEach((e=>{e.id==a.heroId&&(d=e)})),m={maxHp:0,model:d,goldNotes:{line:d.goldNotes,placeholders:{}},tagsCount:{},skills:[],defense:[]},d.equipment.forEach((e=>{let o=be(Y,f,e.id);o?ve(Y,o,e.isAvailable,e.placeholder,q):console.warn("Can't find hero equipment",e)})),d.skills.forEach(((e,o)=>{e.forEach(((e,o)=>{e.tags&&e.tags.forEach((e=>{m.tagsCount[e]||(m.tagsCount[e]=0),m.tagsCount[e]++}))})),m.defense.push(d.defense[o]),m.skills.push({xp:0,hp:0,skills:e})})),d.placeholders)for(var o in d.placeholders)q[o]=le(d.placeholders[o])},this.prepareGlobalPlaceholders=function(){for(const e in k)q[e]=le(k[e]);q.roomIds={},this.metadata.header.line=q.adventureHeader},this.prepareQuestGeneratorInterface=function(){Q={shuffleArray:ae,random:ee,getRandom:le,getRandomId:se,globalPlaceholders:q,debug:a}},this.prepareKeywordsIndex=function(){g.list.forEach((e=>I[e.id]=e)),g.sets.forEach((e=>M[e.id]=e))},this.setupMetadata=function(){this.metadata={seed:l,title:{line:"{blankTitle}"},header:{line:"{blankHeader}"},selection:[]}},this.solvePlaceholders=function(){U.forEach((e=>{e.description=e.description.map((e=>ke(e)))})),this.metadata.title=ke(this.metadata.title),this.metadata.header=ke(this.metadata.header)},this.generateTruthLies=function(){const e={fakeRooms:0,rooms:0,ones:0,seed:l},o=[],t=[];U.forEach((o=>{o.isFake?e.fakeRooms++:(e.rooms++,o.items.forEach((o=>{switch(o.item.id){case"enemy":for(const t in A[o.item.level].truth)e[t]||(e[t]=0),e[t]+=A[o.item.level].truth[t];break;case"genericItem":1==o.item.itemId&&e.ones++}})))})),v.forEach((i=>{let n=e[i.id];if(i.pair&&(n%2?(o.push(i.odd),t.push(i.pair)):(o.push(i.pair),t.push(i.odd))),i.lie){const e=[];let r=n+i.lie.range[0],a=n+i.lie.range[1];for(o.push(Ee(n,i)),void 0!==i.lie.max&&a>i.lie.max&&(a=i.lie.max),void 0!==i.lie.min&&r<i.lie.min&&(r=i.lie.min);r<=a;)r!=n&&e.push(Ee(r,i)),r+=i.lie.step||1;e.length&&t.push(le(e))}})),c.truth=oe(o),c.lie=oe(t)},this.generateModifiers=function(){let e={},o=[],t=le(O);if(U.forEach((t=>{let i=!1;if(!t.isFake&&t.description.length<2&&t.items.forEach((e=>{"enemy"==e.item.id&&(i=!0)})),i){let i=ce(t).length;e[i]||(o.push(i),e[i]=[]),e[i].push(t)}})),G)for(let o in e)e[o].forEach((e=>e.description.unshift(G)));else o.sort(),t.forEach((t=>{let i=Math.floor(t.atPercentage/100*o.length),n=e[o[i]];if(n){let e=se(n),o=n[e];if(o){let i=le(S[t.modifierType]);n.splice(e,1),a&&a.dumpSelection&&this.metadata.selection.push({modifier:i,room:o}),o.description.unshift({line:i.roomDescription,placeholders:{}})}}}))},this.selectRoomsModel=function(){let e;le(P).forEach((o=>{let t=o.times||1;for(let i=0;i<t;i++)e=this.addRoom(o.type,0,0,o.width,o.height,o.isCorridor,o.isStarting),o.isStarting&&(e.addItem(1,1,{id:"stairs"}),B=e)}))},this.prepare=function(){if(!this.prepared){let e;this.prepared=!0,a&&a.dumpSentences&&(e={equipment:oe(f)}),this.prepareQuestGeneratorInterface(),this.selectRoomsModel(),this.indexModifiers(),this.addQuestsMetadata(),this.evaluateQuestsComplexity(),this.setupMetadata(),this.prepareGlobalPlaceholders(),this.prepareKeywordsIndex(),this.selectHeroModel(),this.scatterRooms(),this.assignIdRooms(),this.prepareExits(),this.optimizeIds(),this.addQuests(),this.generateDictionaries(),this.generateEnemies(),this.generateHero(),this.generateModifiers(),this.addNoise(),this.addFakeRooms(),this.addFlavorTexts(),this.sortRooms(),this.sortEquipment(),this.generateTruthLies(),a&&a.dumpSentences&&(e.equipment.forEach((e=>{console.warn("[E] "+ke(e,!0,"label")+": "+ke(e,!0,"action"))})),J.forEach((e=>e.forEach((e=>console.warn("[Q] "+ke({fakeLine:e}))))))),this.solvePlaceholders()}},this.debug=function(){const e=30,o=15,t=document.createElement("canvas"),r=document.createElement("div");let a="<table border=1>";t.style.border="2px solid #ccc",t.width=i*e,t.height=n*e;const s=t.getContext("2d");this.prepare(),F.forEach((o=>{const t=o.x,i=o.y,n=t*e,r=i*e;switch(o.id){case"fakeEntrance":s.beginPath(),s.fillStyle="#fcc",s.fillRect(n,r,e,e),s.stroke();break;case"fakeDoorRight":case"fakeDoorDown":break;default:s.beginPath(),s.fillStyle="#eee",s.fillRect(n,r,e,e),s.stroke()}})),F.forEach((t=>{const i=t.x,n=t.y,r=i*e,a=n*e;switch(t.id){case"fakeDoorRight":case"fakeDoorDown":s.beginPath(),s.strokeStyle="#f0f",s.moveTo(r+o,a+o),"fakeDoorRight"==t.id?s.lineTo(r+o+e,a+o):s.lineTo(r+o,a+o+e),s.stroke()}})),U.forEach((t=>{a+="<tr>",a+="<td>"+t.id+"</td>",a+="<td>@"+t.x+","+t.y+" "+t.width+"x"+t.height+"</td>",s.beginPath(),s.strokeStyle="#000",s.rect(t.x*e,t.y*e,t.width*e,t.height*e),t.isStartingRoom&&s.rect(t.x*e+3,t.y*e+3,t.width*e-6,t.height*e-6),s.stroke(),s.font="15px Arial",s.fillStyle="#f00",s.textAlign="center",s.textBaseline="middle",s.fillText(t.id,t.x*e+t.width*e/2,t.y*e+t.height*e/2),a+="<td>",t.exits.forEach((t=>{const i=t.x*e,n=t.y*e;switch(a+="@"+t.x+","+t.y+" door "+re(t.x,t.y,t.toRoom)+" &raquo; room "+t.toRoom.id+"<br>",s.beginPath(),s.strokeStyle="#0ff",s.moveTo(i+o,n+o),t.side){case"right":s.lineTo(i,n+o);break;case"left":s.lineTo(i+e,n+o);break;case"down":s.lineTo(i+o,n);break;case"up":s.lineTo(i+o,n+e)}s.stroke()})),a+="</td>",a+="</tr>",t.items.forEach((i=>{const n=t.x+i.x,r=t.y+i.y,a=n*e,l=r*e;switch(i=i.item,s.font="15px Arial",s.textAlign="center",s.textBaseline="middle",i.id){case"enemy":s.fillStyle="#f00",s.fillText("E"+i.level,a+o,l+o);break;case"genericItem":i.isHidden?s.fillStyle="#099":s.fillStyle="#0ff",s.fillText("g"+Z.items.map[i.itemId],a+o,l+o);break;default:s.fillStyle="#f0f",s.fillText({stairs:"S"}[i.id]||"?",a+o,l+o)}})),t.entrances.forEach((i=>{const n=t.x+i.x,r=t.y+i.y,a=n*e,l=r*e;s.fillStyle="#000",s.fillText(re(n,r,t),a+o,l+o)}))})),r.innerHTML=a+"</table>",document.body.style.backgroundColor="#fff",document.body.style.color="#000",document.body.style.overflow="scroll",document.body.appendChild(t),document.body.appendChild(r)},this.debugDatabase=function(){console.warn("\n\nDebugging data for database\n\n");var e={};for(let o in u){u[o].forEach((o=>{let t=!1;questLabels={},o.steps.forEach((e=>{e.forEach((e=>{e.labels?e.labels.forEach((e=>questLabels[e]=1)):t=!0}))})),o.otherDescriptions&&o.otherDescriptions.forEach((e=>{e.labels&&e.labels.forEach((e=>questLabels[e]=1))}));for(let t in questLabels)e[t]||(e[t]=[]),e[t].push(o);t&&console.log("Quest",o.id,"has missing labels")}))}for(let o in e)e[o].length>1&&(console.warn("Duplicate label",o),e[o].forEach((e=>{console.log(" \\_ ",e.id)})));console.log(_)},this.createDownloadPDFAnchor=function(e,o){this.createSVG((t=>{t.assignPDFDownloadToAnchor(e,o)}))},this.downloadPDF=function(e){this.createSVG((o=>{o.downloadPDF(e)}))},this.downloadSVG=function(e){this.createSVG((o=>{o.downloadSVG(e)}))},this.showSVG=function(){this.createSVG((e=>{e.getSVG();const o=document.createElement("div");o.style.display="inline-block",o.innerHTML=e.getSVG(),document.body.appendChild(o);let t=document.createElement("input");t.type="button",t.value="Download PDF",t.onclick=()=>{this.downloadPDF("dungeon.pdf")},document.body.appendChild(t),t=document.createElement("input"),t.type="button",t.value="Download SVG",t.onclick=()=>{this.downloadSVG("dungeon.svg")},document.body.appendChild(t)}))},this.createSVG=function(r){if(T)r(T);else{this.prepare();const s=new e(t+"svg/model.svg",!0);s.load((()=>{T=new o(s),a&&a.svgPatcher&&T.setPatcher(a.svgPatcher);const e=[],t=T.getById("gridCell"),l=T.getNum(t,"width"),d=T.getNum(t,"height");for(let o=0;o<n;o++){const t=[];e.push(t);for(let e=0;e<i;e++)t.push(0),T.cloneNodeBy("gridCell","c_"+e+"_"+o,e*l,o*d)}for(let e=0;e<n;e++)T.setText(T.cloneNodeBy("gridRow",0,0,e*d),e+1);for(let e=0;e<i;e++)T.setText(T.cloneNodeBy("gridCol",0,e*l,0),e+1);for(let e=0;e<n;e+=W)for(let o=0;o<i;o+=W)T.cloneNodeBy("gridGuide",0,o*l,e*d,l*W,d*W);const h=T.getNum(T.getById("roomHeight"),"height"),c={};U.forEach(((e,o)=>{a&&a.drawRooms?e.isFake?T.cloneNodeBy("startingRoom",0,e.x*l+2,e.y*d+2,l*e.width-4,d*e.height-4):(T.cloneNodeBy("startingRoom",0,e.x*l,e.y*d,l*e.width,d*e.height),e.isOptionalRoom&&T.cloneNodeBy("startingRoom",0,e.x*l+.5,e.y*d+.5,l*e.width-1,d*e.height-1),e.isStartingRoom&&T.cloneNodeBy("startingRoom",0,e.x*l+1,e.y*d+1,l*e.width-2,d*e.height-2)):e.isStartingRoom&&T.cloneNodeBy("startingRoom",0,e.x*l,e.y*d,l*e.width,d*e.height),e.exits.forEach((e=>{const o=function(e){switch(e.side){case"up":return e.x+"-v-"+(e.y+1);case"left":return e.x+1+"-h-"+e.y;case"down":return e.x+"-v-"+e.y;case"right":return e.x+"-h-"+e.y}}(e);if(!c[o])switch(c[o]=1,e.side){case"up":T.cloneNodeBy("doorDown",0,e.x*l,e.y*d);break;case"down":T.cloneNodeBy("doorUp",0,e.x*l,e.y*d);break;case"right":T.cloneNodeBy("doorLeft",0,e.x*l,e.y*d);break;case"left":T.cloneNodeBy("doorRight",0,e.x*l,e.y*d)}})),e.items.forEach((o=>{const t=o.x+e.x,i=o.y+e.y,n=t*l,r=i*d;if(!(o=o.item).isHidden)switch(o.id){case"enemy":{const e=T.cloneNodeBy("gridEnemy",0,n,r);he(T,T.getById("gridEnemyLevel",e),o.level);break}case"genericItem":{const e=T.cloneNodeBy("gridItem",0,n,r);T.setText(T.getById("gridItemId",e),Z.items.map[o.itemId]);break}case"stairs":T.cloneNodeBy("gridStairs","map-stairs",n,r)}}));let t={};e.entrances.forEach((o=>{const i=o.x+e.x,n=o.y+e.y,r=i*l,s=n*d,m=i+","+n;t[m]||(t[m]=1,a&&a.drawRoomNumbers?T.setText(T.cloneNodeBy("gridNumber",0,r,s),e.id):T.setText(T.cloneNodeBy("gridNumber",0,r,s),re(i,n,e)))}));let i,n=h*o;const r=T.cloneNodeBy("roomData",0,0,n);if(e.isStartingRoom?(T.delete(T.getById("roomCoords",r),r),T.setId(T.getById("roomHeight",r),"list-stairs")):(T.delete(T.getById("roomStarting",r),r),T.setText(T.getById("roomPosition",r),e.x+1+","+(e.y+1)),T.setText(T.getById("roomSize",r),e.width+"x"+e.height)),a&&a.showRoomAttributes){let o=T.getById("roomId",r);T.delete(T.getById("roomCheckbox",r)),T.moveNodeAt(T.getById("roomId",r),T.getNum(o,"x")-2,T.getNum(o,"y")),T.setText(o,(e.isMarkable?"x":"")+(e.isExclusive?"E":"")+(e.hasEnemies?"!":"")+e.id)}else T.setText(T.getById("roomId",r),e.id);if(e.description[0]){let t=T.getById("roomLine1",r);if(i=e.description[0].split("^*v"),T.setText(t,i[0]||""),T.setClassName(t,"room-"+o+"-0-l"),i[1]){let e=T.cloneNodeBy("roomLine1UpsideDown",0,0,-n);T.setText(e,i[1]),T.setClassName(e,"room-"+o+"-0-r")}}else T.delete(T.getById("roomLine1",r));if(e.description[1]){let t=T.getById("roomLine2",r);if(i=e.description[1].split("^*v"),T.setText(t,i[0]||""),T.setClassName(t,"room-"+o+"-1-l"),i[1]){let e=T.cloneNodeBy("roomLine2UpsideDown",0,0,-n);T.setText(e,i[1]),T.setClassName(e,"room-"+o+"-1-r")}}else T.delete(T.getById("roomLine2",r))}));let p=T.getNum(T.getById("heroBox"),"width");m.skills.forEach(((e,o)=>{const t=T.cloneNodeBy("heroTier",0,p*o,0);T.setText(T.getById("heroSkillUp",t),(e.skills[0].cost?"("+e.skills[0].cost+")\n":"")+e.skills[0].skill||""),T.setText(T.getById("heroSkillDown",t),(e.skills[1].cost?"("+e.skills[1].cost+")\n":"")+e.skills[1].skill||""),T.setText(T.getById("heroDefense",t),m.defense[o]?"+"+m.defense[o]+" DEF":"-"),he(T,T.getById("heroXp",t),e.xp),he(T,T.getById("heroHp",t),e.hp)})),T.setText(T.getById("goldNotes"),ke(m.goldNotes)),p=T.getNum(T.getById("enemyBox"),"width"),A.forEach(((e,o)=>{if(!e.isVirtual){const t=T.cloneNodeBy("enemyTier",0,p*o,0);0==o?T.delete(T.getById("enemySymbol",t)):T.delete(T.getById("enemyOutline",t)),T.setText(T.getById("enemySkillUp",t),e.skills[0]||""),T.setText(T.getById("enemySkillDown",t),e.skills[1]||""),T.setText(T.getById("enemyXp",t),"+"+e.gainXp+" XP"),T.setText(T.getById("enemyDefense",t),e.defense?"+"+e.defense+" DEF":"-"),he(T,T.getById("enemyLevel",t),e.level)}})),a&&a.skipNoise||F.forEach((e=>{const o=e.x,t=e.y,i=o*l,n=t*d;switch(e.id){case"fakeEntrance":T.setText(T.cloneNodeBy("gridNumber",0,i,n),Math.abs(re(o,t,le(U))));break;case"fakeEnemy":{const o=T.cloneNodeBy("gridEnemy",0,i,n);he(T,T.getById("gridEnemyLevel",o),e.level);break}case"fakeGenericItem":{const o=T.cloneNodeBy("gridItem",0,i,n);T.setText(T.getById("gridItemId",o),Z.items.map[e.itemId]);break}case"fakeDoorDown":T.cloneNodeBy("doorDown",0,e.x*l,e.y*d);break;case"fakeDoorRight":T.cloneNodeBy("doorRight",0,e.x*l,e.y*d)}}));const f=T.getNum(T.getById("goldLeft"),"width")+.56;for(let e=0;e<L;e++)T.cloneNodeBy((L-e)%10?"goldLeft":"goldLeftMark",0,f*e,0);const g=T.getNum(T.getById("serviceCheckbox"),"width")+1.2;Y.forEach(((e,o)=>{const t=T.cloneNodeBy("serviceBox",0,0,o*g),i=ke(e.equipment,e.isFake,"label"),n=ke(e.equipment,e.isFake,"action");T.setText(T.getById("serviceName",t),(e.isFake&&a&&a.showFake?"[FAKE] ":"")+i+" ("+n+")"),e.isAvailable||T.delete(T.getById("serviceCheckbox",t))})),T.setText(T.getById("adventureTitle"),this.metadata.title),T.setText(T.getById("adventureHeader"),this.metadata.header),T.setText(T.getById("footer"),K),T.deleteById("serviceBox"),T.deleteById("goldLeft"),T.deleteById("goldLeftMark"),T.deleteById("heroTier"),T.deleteById("enemyTier"),T.deleteById("gridCol"),T.deleteById("gridRow"),T.deleteById("gridCell"),T.deleteById("gridNumber"),T.deleteById("startingRoom"),T.deleteById("doorUp"),T.deleteById("doorDown"),T.deleteById("doorLeft"),T.deleteById("doorRight"),T.deleteById("roomData"),T.deleteById("gridStairs"),T.deleteById("gridEnemy"),T.deleteById("gridItem"),T.deleteById("gridGuide"),T.deleteById("guides"),T.deleteById("roomLine1UpsideDown"),T.deleteById("roomLine2UpsideDown"),T._rooms=U,r(T)}))}},this},i=function(e){e||(e={}),e.root||(e.root="");const o=[],n={version:"1.0",filePrefix:"stampadia",projectName:"Chronicles of Stampadia",year:"2021",by:"KesieV",homepage:"kesiev.com/stampadia",sourcesPage:"github.com/kesiev/stampadia"};let r,a,s,l,m,d,h,c,p,f,g,y,u,k,R,v,b,w,x,T,I,M;function E(e,o){const t=(new Date).getFullYear();let i=o+"";for(;i.length<10;)i="0"+i;for(const o in n)e=e.replaceAll("{"+o+"}",n[o]);return e=e.replaceAll("{seed}",i),e=t==n.year?e.replaceAll("{rangeYear}",t):e.replaceAll("{rangeYear}",n.year+"-"+t)}this.initialize=function(t,n,E){if(void 0===n)M||(M=!0,this.initialize(t,0,Date.now()));else if(!i.loaded&&o[n]){const i=document.createElement("script");i.setAttribute("src",e.root+o[n]+"?"+E),i.setAttribute("async","false"),i.onload=e=>this.initialize(t,n+1,E),document.head.firstElementChild.appendChild(i)}else i.loaded=!0,w={crippled:{enemy:{id:"[CODEX-Modifiers] Enemy - Crippled: Enemies moves -1.",type:"good",roomDescription:"{ifEnemyPerformAction:MOVE}{then}It drags forward crippled, {actionEffect:-1}"},hero:{id:"[CODEX-Modifiers] Hero - Paralysis: Hero moves -1.",type:"bad",roomDescription:"{ifHeroPerformAction:MOVE}{then}Your legs feel so heavy, {actionEffect:-1}"}},scared:{enemy:{id:"[CODEX-Modifiers] Enemy - Fear: Enemies -1 a die of choice.",type:"good",roomDescription:"{ifAfterEnemyRollInFight}{then}It trembles with fear, {modifyDice:1,-1}"},hero:{id:"[CODEX-Modifiers] Hero - Fear: Hero -1 a die of choice.",type:"bad",roomDescription:"{ifAfterHeroRollInFight}{then}Fear makes you flinch, {modifyDice:1,-1}"}},blind:{enemy:{id:"[CODEX-Modifiers] Enemy - Blind: Enemies plays just 1 die.",type:"good",roomDescription:"{ifAfterEnemyRollInFight}{then}It can't see you, {activateOnly:1}"},hero:{id:"[CODEX-Modifiers] Hero - Blind: Hero plays just 1 die.",type:"bad",roomDescription:"{ifAfterHeroRollInFight}{then}You see nothing, {activateOnly:1}"}},stunned:{enemy:{id:"[CODEX-Modifiers] Enemy - Stunned: Hero rerolls his 1s.",type:"good",roomDescription:"{ifHeroRolls:1}{then}The enemy looks stunned, {reroll:1}"},hero:{id:"[CODEX-Modifiers] Enemy - Haste: Enemies rerolls his 1s.",type:"bad",roomDescription:"{ifEnemyRolls:1}{then}It's moving so quickly, {reroll:1}"}},muddy:{room:{id:"[CODEX-Modifiers] Terrain - Mud: Everybody moves -1.",type:"balanced",roomDescription:"{ifPerformAction:MOVE}{then}The muddy floor slows you down, {actionEffect:-1}"}},tallGrass:{room:{id:"[CODEX-Modifiers] Terrain - Tall grass: Everybody -1 a die of choice.",type:"balanced",roomDescription:"{ifAfterRollInFight}{then}The tall grass hinders, {modifyDice:1,-1}"}},darkness:{room:{id:"[CODEX-Modifiers] Terrain - Darkness: Everybody plays just 1 die.",type:"balanced",roomDescription:"{ifAfterRollInFight}{then}It's too dark here, {activateOnly:1}"}},arena:{room:{id:"[CODEX-Modifiers] Terrain - Arena: Everybody rerolls his 1s.",type:"balanced",roomDescription:"{ifRolls:1}{then}It's a fight to the death, {reroll:1}"}}},m={corridors:["A short and dry corridor.","Rocks creak as you walk down the hall.","Something muddy squishes under your feets.","It's pitch black here.","Unreadable inscriptions runs along the corridor walls.","The wind howl along the narrow corridor.","Candles are along the walls.","Your image is reflected by thousands of crystals on the wall.","The walls and the floor were scratched by some beast.","You feel the urge to leave this narrow room as soon as possible.","You hear a door slamming.","Your footsteps echo throughout the dungeon.","Ink stains trickle down the stairs.","Green grass pops out between the floor tiles.","The wooden door closes behind you.","Pieces of glass, soaked by black ink, are scattered along dark corridor.","This corridor is so dark that you begin doubting of your own existence.","Water drips from stalactites.","Green ooze covers the walls.","Ceiling is so low you have to crawl.","This dirt tunnel is about to collapse.","Broken stone gates used to block intruders.","Hundreds of bats call this place home.","You smell burnt wood."],rooms:["A dim light is filtering through the curtains.","A huge chandelier on the ceiling lights up the room.","The floor is so clean that it reflects your image.","Some heads are hanging from the ceiling.","There is a huge statue of a cube in the middle of the room.","Four columns are projecting their long shadows on the floor.","You step in a huge marble amphitheater.","You hear some whispers.","There are fresh bloodstains on the woody floor.","This room stench is unbearable.","The walls of this room are gold plated.","You feel fatigued and this is not a good sign.","You managed to dodge a dart fired by a statue.","Your throat suddenly gets dry.","Eerie glows of torches are speckling the dark walls of the cellar.","On the gigantic apse in ruin, a purple bonfire is still burning.","Multiple ancient mud prints head to the recessed altar.","Only the faint shimmer of blades breaks through the dark armory.","A mysterious disturbing buzz fills the cave, invading your brain.","Weird machines and glyphs stamps are stocked in the workroom.","A rusty knife is still stuck in a boar stinking carcass, lying on the table.","Faded ink sketches of lethal creatures and traps are hanging on the walls.","By going through the charming courtyard, warm sun rays pacify your spirit.","Rivulets of a thick black fluid gush from the wall of the rhomboid room.","A maze of mirrors hides the way out. Your trembling legs start moving...","Heap of bones lies tidy in the vault corners, attended by peaceful statues.","Amazing sea-green luminescences reflect in the almost dry pond of the cave.","Something in the room appears so familiar to you... A thrill crosses your skin.","The countless leaves of a titanic oak are piled up in the court floor.","You enter in a room with no openings welcomed by a fierce stink of death.","Every angle is rounded with plaster. Hounds?","A small stream runs from a crack in the wall.","This looks like a giant chessboard.","Echoes suggest a much bigger room.","Your mouth fills with the taste of... strawberry?","Above is a night sky with unknown constellations.","Oversize furniture make you feel insignificant.","You hear a strange hum from the ground."]},d=[{id:"warrior",heroClass:"Warrior",goldNotes:"Gold ({ifCrossDoor}{then}{ifPayGold:1})",tags:["importantStartingItem"],skills:[[{skill:"ATK -1\nRNG 1"},{skill:"Move\n-3"}],[{skill:"DEF -3"},{skill:"Move\n-2",tags:["losable"]}],[{skill:"Gain HP\n-5",cost:"pay 1G",tags:["losable"]},{skill:"ATK -3\nRNG 1",tags:["losable"]}],[{skill:"ATK\nRNG 2",tags:["losable"]},{skill:"Move"}]],placeholders:{familiarName:["Dog","Wolf","Bear"]},defense:[1,1,1,1],xpRamp:[{value:0},{xpGroup:"low",round:"floor",percentage:1},{xpGroup:"high",round:"floor",percentage:.35},{xpGroup:"high",round:"floor",percentage:.65}],hpRamp:[.5,.15,.25,.1],damageRatio:.7,equipment:[{placeholder:"heroItem",id:"resurrection",isAvailable:!0}],enemyModels:[{skills:[]},{skills:[]},{skills:[["DEF -3","ATK -3\nRNG 2"]]},{skills:[]},{skills:[]}]},{id:"wizard",heroClass:"Wizard",goldNotes:"Gold ({ifCrossDoor}{then}{ifPayGold:1})",tags:["weak"],skills:[[{skill:"ATK -2\nRNG 2"},{skill:"Move\n-3"}],[{skill:"Move\n-1"},{skill:"Move\n-3",tags:["losable"]}],[{skill:"DEF\n-2",tags:["losable"]},{skill:"ATK -1\nRNG 3"}],[{skill:"Gain HP\n-5",cost:"pay 1G"},{skill:"ATK\nRNG 1",tags:["losable"]}]],placeholders:{familiarName:["Owl","Cat","Lizard"]},defense:[1,1,1,1],xpRamp:[{value:0},{xpGroup:"low",round:"floor",percentage:1},{xpGroup:"high",round:"floor",percentage:.35},{xpGroup:"high",round:"floor",percentage:.65}],hpRamp:[.6,.15,.15,.1],damageRatio:.7,equipment:[{placeholder:"heroItem",id:"fireball",isAvailable:!0}],enemyModels:[{skills:[["ATK -1\nRNG 2","Move\n-3"]]},{skills:[]},{skills:[]},{skills:[]},{skills:[]}]},{id:"dwarf",heroClass:"Dwarf",goldNotes:"Gold ({ifCrossDoor}{then}{ifPayGold:1})",skills:[[{skill:"ATK -1\nRNG 1"},{skill:"Move\n-4"}],[{skill:"DEF -2"},{skill:"Move\n-3",tags:["losable"]}],[{skill:"ATK -2\nALL 2",cost:"pay 1G",tags:["losable"]},{skill:"DEF -3"}],[{skill:"ATK -1\nRNG 2",cost:"pay 2G",tags:["losable"]},{skill:"ATK\nRNG 1",cost:"pay 2G",tags:["losable"]}]],placeholders:{familiarName:["Beaver","Mole","Hedgehog"]},defense:[1,1,1,1],xpRamp:[{value:0},{xpGroup:"low",round:"floor",percentage:1},{xpGroup:"high",round:"floor",percentage:.35},{xpGroup:"high",round:"floor",percentage:.65}],hpRamp:[.35,.3,.25,.1],damageRatio:.7,equipment:[{placeholder:"heroItem",id:"mead",isAvailable:!0}],enemyModels:[{skills:[]},{skills:[]},{skills:[]},{skills:[]},{skills:[]}]},{id:"ranger",heroClass:"Ranger",goldNotes:"Gold ({ifCrossDoor}{then}{ifPayGold:1})",skills:[[{skill:"ATK -1\nRNG 1"},{skill:"Move\n-3"}],[{skill:"ATK -1\nRNG =2",tags:["losable"]},{skill:"Copy\n-1",tags:["losable"]}],[{skill:"Copy\n-1",tags:["losable"]},{skill:"DEF -2"}],[{skill:"ATK\nRNG 3",tags:["losable"]},{skill:"Move",tags:["losable"]}]],placeholders:{familiarName:["Falcon","Pidgeon","Snake"]},defense:[1,1,1,1],xpRamp:[{value:0},{xpGroup:"low",round:"floor",percentage:1},{xpGroup:"high",round:"floor",percentage:.35},{xpGroup:"high",round:"floor",percentage:.65}],hpRamp:[.5,.15,.25,.1],damageRatio:.7,equipment:[{placeholder:"heroItem",id:"focus",isAvailable:!0}],enemyModels:[{skills:[]},{skills:[]},{skills:[["DEF -3","ATK -3\nRNG 2"]]},{skills:[]},{skills:[]}]},{id:"rogue",heroClass:"Rogue",goldNotes:"Gold ({ifCrossDoor}{then}{ifPayGold:1})",skills:[[{skill:"ATK -1\nRNG 1"},{skill:"Move\n-2"}],[{skill:"DEF -3"},{skill:"Lock\n-3",tags:["losable"]}],[{skill:"DEF -2",tags:["losable"]},{skill:"Move",tags:["losable"]}],[{skill:"Lock\n-2",tags:["losable"]},{skill:"ATK\nRNG 2",tags:["losable"]}]],placeholders:{familiarName:["Mouse","Crow","Raccoon"]},defense:[1,1,1,1],xpRamp:[{value:0},{xpGroup:"low",round:"floor",percentage:1},{xpGroup:"high",round:"floor",percentage:.35},{xpGroup:"high",round:"floor",percentage:.65}],hpRamp:[.5,.15,.25,.1],damageRatio:.7,equipment:[{placeholder:"heroItem",id:"frag",isAvailable:!0}],enemyModels:[{skills:[]},{skills:[]},{skills:[["DEF -3","ATK -3\nRNG 2"]]},{skills:[]},{skills:[]}]}],S=[],[{label:"Golem",id:"golem",setName:"golemSet",beatenBySet:"manticoreSet"},{label:"Manticore",id:"manticore",setName:"manticoreSet",beatenBySet:"hellhoundSet"},{label:"Hellhound",id:"hellhound",setName:"hellhoundSet",beatenBySet:"golemSet"}].forEach((e=>{for(let o=1;o<4;o++)S.push("{getKeyword:"+e.id+"-"+o+"}")})),s={randomBookQuote:["Bi-Anca painted all the walls","Frank is our first Brother","The stagger Lee lived twice","Peter piers them all","Marianne guided us here","The word of Preuk helped","Sam and Marcus gave us voice","Beep is up, Test is down","Supp-Japan was a wizard god","Court-Jus balanced our world"],randomShopKeeper:['"Thank you, stranger!"',"The shopkeeper stares at you",'"Here you are, {heroClass}."','"Thank you, {heroClass}."','"Thanks for the gold!"','"Hope it helps!"','"The best of the {placeName} for you!"','"You take. Me thanks."'],randomDarkShopKeeper:['"Hee hee... Thank you..."',"A grin opens on the shopkeeper face",'"Very well, then..."','"Have fun, hee..."',"The shopkeeper rubs his hands",'"Thaaank yooou, tee hee!"','"Now leave"','"..."'],randomGambler:['"Feeling lucky, huh?"','"Wanna play a little game?"','"It looks like you like playing games, huh? Come here!"','"Do you want to play with me?"','"Let\'s bet, kid."','"I\'ve a little game for you!"'],randomTeleportation:["You disappear","You vanish into thin air","You feel dizzy"],randomMysteryHappens:["You hear a click under your feets","You hear a noise somewhere","Everything rumbles around you"],randomTrap:["A dart hits you on a leg","You step on a spike","A small red spider bites you"],randomSmallKey:["a small key","a rusty key","a tiny key","a copper key","a wooden key"],randomSaint:['"Let me help you."','"You need assistance. Here."','"May the Gods be with you."','"Come here. Take this."','"I bless you."'],randomAltar:['"Bow down."','"Pray the gods."','"Sacrifice."','"..."'],randomBossEntrance:['"How you dare to face the {villainName}! Now, die!"','"You will die by the hand of the great {villainName}!"','"This {placeName} will be your tomb, {heroClass}!"','"This {placeName} will be the last thing you\'ll see!"','"Now die, {heroClass}!"','"You and your {goodGuyName} will die!"','"I\'ll kill you first, then the {goodGuyName}!"','"The {goodGuyName} will regret sending you here!"','"A {heroClass} this time... very well! Bring it on!"'],randomTwinBossEntrance:['"Do you think you can beat the {villainName} Twins?"','"We are the {villainName} Twins and now you\'ll die!"','"The {villainName} Twins will crush you!"','"You are all alone, {heroClass}!"'],randomFinalFormAnnounce:['"Behold our final form, {heroClass}!"','"This isn\'t even our final form!"','"Now see our full power!"','"We\'ve had enough of playing!"'],randomBadFeeling:["Are not you feeling good","There is something wrong","Your stomach hurts","Your eyes burn","You feel weak arms"],randomBossRevenge:["\"That's the right price for the {goodGuyName}'s indolence!\"","\"A simple {heroClass} can't save the {goodGuyName}'s {goodGuyRelativeName} life!\"",'{goodGuyName}\'s {goodGuyRelativeName}: "Please, help me!"','{goodGuyName}\'s {goodGuyRelativeName}: "The {villainName} kidnapped me! Help!"','"The {goodGuyName}\'s {goodGuyRelativeName} life is mine!"','"The {goodGuyName} will never see the {goodGuyRelativeName} again!"','"The {goodGuyName}\'s {goodGuyRelativeName} will be my reward!"'],randomSaveRelativeRequest:['"The {villainName} kidnapped my {goodGuyRelativeName}... Help!"','"My {goodGuyRelativeName} is in danger... Please, help me!"','"Please, save my {goodGuyRelativeName}!"'],randomThankYou:['"Thank you!"','"You have my thanks!"','"I owe you. Thanks!"'],randomSphinxAnswerAccept:['"That\'s your answer."','"..."','"Very well."','"Interesting."','"Is that true?"','"We\'ll see."'],randomSphinxOk:['"...pleases me."','"...is the truth."','"...is the right one."'],randomSphinxKo:['"...is disappointing."','"...condamned you."','"...is illogic."'],randomMurderer:['"That {victimName} was a too easy fight... Hey, YOU!"','"That {victimName} taste was so good..."','"Hey {heroClass}! Are you here for that {victimName}?"','"I wonder why the {villainName} wanted that {victimName} dead... What?"'],randomHiddenFoe:['"Damn {heroClass}! How did you manage to find me?!"','"It was the best hiding place in the {placeName}!"','"So you came, at last."','"Did the {goodGuyName} tell you where I was? Damn!"','"Finding me will be your worst mistake."'],randomEnemyChallenge:['"You will never leave the {placeName} alive, {heroClass}!"','"Stop right there!"','"Now is your turn to die, {heroClass}!"','"You will pay for this!"','"I\'ll avenge the {villainName}!"','"Where are you going, {heroClass}?"'],randomMagicTree:["A tree is growing visibly in the middle of the room.","There is a magic tree, growing at an unnatural speed.","The branches of the tree sway as if they were alive.","The Fruit of the tree pulsates with a dim light."],randomGoodGuyLost:['"I missed the {goodGuyName}!"','"I\'ve lost the {goodGuyName}..."',"The {goodGuyName} is no longer here",'"Where did the {goodGuyName} go?"'],randomGoodGuyLongFollowMe:['"Hurry! Let\'s go!"','"Let\'s find the {villainName}! This way!"','"There is no time to waste! Follow me!"'],randomFollowMe:['"We\'re on the right track!"','"This way!"','"Follow me!"',"\"Oh! It's you! Let's go!\""],randomVillainFound:['"It\'s the {villainName}. Go there!"','"Time to end the {villainName} life!"','"It\'s the {villainName}! Go!"','"We\'ve found the {villainName}!"'],randomSlaverBuy:['"Okay, the beast is yours."','"Make good use of it, heh!"','"Thank you!"','"You got a great deal!"'],randomMobsterPay:['"Thanks from the {villainName}!"','"You serve the {villainName} well!"','"Hail to the {villainName}!"','"The {villainName} will be glad!"'],randomGoodDying:['"So... rry..."','"Fare... well..."','"I... can\'t..."','"I... Thank... you."'],randomBadDying:['"Why... You... Ugh!"','"Please... help... Ugh!"','"Why... Ugh..."','"Ugh!"'],randomCorpse:["Bloodstains are on the floor","There is a corpse here","You see a dead body"],randomOk:['"Let me handle this."','"Roger that."','"Understood."','"It\'s settled then."'],randomConfusion:["You are sitting in the middle of nowhere.","You feel like you're floating into the void.",'"Am... I... still in Stampadia?"',"Being a {heroClass} makes no longer sense.","You are doubting yourself. Are you still a {heroClass}?","There is nothing here. Not even yourself.","Is it all in your mind?"],randomFear:["You feel the taste of blood in your mouth.","You have the feeling that you will not be able to do it.","This time it really is the end for you.","Hopes leave you in an instant."],randomResurrection:['"The {villainName}... is BACK!"','"Take my life, {villainName}! Gwaah!"','"Sorry, {heroClass}! I revived the {villainName}!"','"The final step of my plan... is over!"','"I... I improved the {villainName}!"'],randomZombieEntrance:['"Kill... me..."','"I\'m... suffering..."','"What... am I?"','"Please... kill me..."','"My body... is..."'],randomBrokenTeleport:["There is an unfinished teleport to a secret room.","Someone broke this secret room teleport.","There is a secret room teleport that doesn't work well.","Someone teared down this secret room teleport."],randomArchitectEntrance:['"This is not the time, {heroClass}! Go away!"','"How you dare to challenge The Architect?"','"It\'s too soon, {heroClass}!"',"\"I'm everywhere! You can't kill me!\"",'"It\'s the {heroClass}! I have to hurry!"','"You can\'t have my tools, {heroClass}!"','"Damn! You found me!"'],randomArchitectLoseDie:['"Using my magic dice is not fair, {heroClass}!"','"Y... you can\'t have that magic die! No!"','"You... can\'t take one of my magic dies! Stop!"','"My... my precious magic dice!"'],randomCurseJoke:['"I see you\'re struggling with my little gift, {heroClass}!"','"You liked my gift, {heroClass}?"','"Are you having fun with my curse, {heroClass}?"','"I see my curse is still on you, {heroClass}!"'],randomCursedEnding:["...but you'll never see the sunrise again.","...but long hairs are appearing on your body.","...but your body has aged suddenly.","...but long roots are sprouting from your legs.","...but your hands are slowly turning to stone.","...but you have just a few days left to live."],randomGotItem:["You've got the","You found the"],randomDefendLoop:['"You\'ve to protect the loop!"','"Stop breaking the loop!"','"I\'ve to protect the loop!"','"The loop must be protected!"'],randomLoopBoss:['"Will the loop really end?"','"The loop must go on!"','"You can\'t stop it!"'],randomGold:["{gainGold:1}","{gainGold:2}"],randomGoodReward:["{gainHp:1}","{gainXp:1}","{gainGold:3}"],randomBadReward:["nothing","{loseHp:1}","{loseGold:3}"],randomGoodLoot:["an Heart Shard, {gainHp:1}","a Star Pin, {gainXp:1}","a bag of gold, {gainGold:3}"],randomBadLoot:["nothing","a Mimic, {loseHp:1}"],randomHighCost:["{ifPayHp:2}","{ifPayXp:3}","{payEquip:equip-heroItem}"],randomHighPrize:["{gainGold:5}","{gainFullHp}"],randomGoodFountain:["a clean fountain, {gainHp:1}","a fresh fountain, {gainHp:2}"],randomBadFountain:["a muddy fountain, {loseHp:1}","a black fountain, {loseHp:2}"],randomGoodRoomEffect:["This room is blessed, {gainHp:1}"],randomBadRoomEffect:["Poisonous gas fills the room, {loseHp:1}"],getRandomCard:S},l=[{skills:[["ATK -1\nRNG 1","Move\n-2"]]},{skills:[["DEF -4","Move\n-1"],["DEF -3","Move\n-2"]]},{skills:[["DEF -4","ATK -2\nRNG 1"],["DEF -4","ATK -3\nRNG 2"]]},{skills:[["ATK\nRNG 1","ATK -2\nRNG 1"],["ATK\nRNG 1","ATK -2\nRNG 2"]]},{isVirtual:!0,skills:[[]]}],h={adventureHeader:["{nameLine} the {heroClass} in","The {heroClass} {nameLine} in"],villainName:["Blood Dragon","Dark Lord","Hydra","Chimera","Basilisk","Minotaur","King Goblin","Mists Queen","Butcher","Cyclop","Demon","Red Oni","Devil","Unnamed","Dark One","Destroyer","Souls Thief","Dark Lady","Fallen Angel","Mad Valkyrie","Cruel Gorgon","Usurper"],winningScene:["You are carried in triumph to the capital!","You did it!","You won!","You are a legend!","You are a hero!","You will always be remembered!"],goodGuyName:["Great Saviour","King","Prince","Princess","Sarge","Queen","Old Sage","Guardian","Cleric","Counsellor","Hermit"],goodGuyRelativeName:["Friend","Wife","Son","Child","Lover"],bossKey:["Diamond Rhombus","Skull Key","Bloody Key","Invisibility Orb","Sacred Key","Discovery Scroll","Flaming Gem","Lost Key","Rupture Seal","Recall Seal","Trauma Orb","Frozen Heart","Spirit Stone","Forgotten Stamp"],placeName:["Mountain","Island","Valley","Temple","Land","City","Capital","Lake","Forest","Abbey","Swamp","Catacomb","Borough","Mill","Desert","Shore","Hill","Woods","Village","Castle","Cliff"],explorerName:["Archaeologist","Explorer","Spy","Hunter","Scholar","Detective","Recruit","Wanderer","Scribe","Chronicler"],documentName:["Inscription","Scroll","Document","Message","Register","Engraving"],victimName:["Adventurer","Kid","Girl","Boy","Man","Woman","Elder"],epicWeapon:["Black Shythe","Void Cutter","Bloody Claw","Black Blade"],epicWeaponPart:["Shard","Part","Piece"],madScientistName:["Necromancer","Scientist","Doctor"],lowerSoldierName:["Captain","Private","Spy"],higherSoldierName:["Sergeant","Major"]},T=[{id:"eyes",zero:"No eyes",singular:"{value} eye",plural:"{value} eyes",pair:"Pair eyes",odd:"Odd eyes",lie:{range:[-2,2],min:0}},{id:"fakeRooms",zero:"I see the truth",singular:"One lie",plural:"{value} lies",pair:"Pair lies",odd:"Odd lies",lie:{range:[-1,1],min:0,max:2}},{id:"foes",zero:"No foes",singular:"{value} foe",plural:"{value} foes",pair:"Pair foes",odd:"Odd foes",lie:{range:[-1,1],min:0}},{id:"horns",zero:"No horns",singular:"{value} horn",plural:"{value} horns",lie:{range:[-4,4],step:2,min:0}},{id:"level1",zero:"No blind",singular:"{value} blind",plural:"{value} blinds",pair:"Pair blinds",odd:"Odd blinds",lie:{range:[-1,1],min:0}},{id:"level2",zero:"No cyclops",singular:"{value} cyclop",plural:"{value} cyclops",pair:"Pair cyclops",odd:"Odd cyclops",lie:{range:[-1,1],min:0}},{id:"level3",zero:"No pairs",singular:"{value} pair",plural:"{value} pairs",pair:"Pair pairs",odd:"Odd pairs",lie:{range:[-1,1],min:0}},{id:"ones",zero:"No one",singular:"{value} one",plural:"{value} ones",pair:"Pair ones",odd:"Odd ones",lie:{range:[-2,2],min:0}},{id:"rooms",zero:"No place",singular:"{value} place",plural:"{value} places",pair:"Pair rooms",odd:"Odd rooms",lie:{range:[-1,1],min:0}},{id:"seed",pair:"Pair day",odd:"Odd day"}],I=[{id:"resurrection",label:"Resurrection",action:"{ifHeroDied}{and}{ifPayGold:2}{then}{gainFullHp}, {moveOnStairs}"},{id:"fireball",label:"Fireball",action:"{ifAfterHeroRollInFight}{then}{fightingEnemyLoseHp:1,0,2}"},{id:"taunt",label:"Taunt",action:"{ifAfterEnemyRollInFight}{and}{ifPayXp:1}{then}{discardAnyDie:1}"},{id:"dash",label:"Dash",action:"{ifAfterEnemyRollInFight}{and}{ifPayXp:2}{then}{discardAnyDie:2}"},{id:"rage",label:"Rage",action:"{ifAfterHeroRollInFight}{and}{ifPayXp:2}{then}{setDieTo:1,6}"},{id:"tactic",label:"Tactic",action:"{ifAfterHeroRollInFight}{and}{ifPayXp:2}{then}{setDieTo:2,5}"},{id:"mirror",label:"Small mirror",action:"{ifAfterEnemyRollInFight}{then}{teleportToRoom:equip-mirror-room}"},{id:"testBravery",label:"Test: Bravery",action:"{ifBeforeHeroRollInFight}{and}{pass}{then}{gainGold:6}"},{id:"testMercy",label:"Test: Mercy",action:"{ifAfterEnemyRollInFight}{and}{ifSetDie:1,1,6}{then}{gainGold:5}"},{id:"testCalm",label:"Test: Calm",action:"{ifAfterHeroRollInFight}{and}{ifDiscardDie:1,6}{then}{gainGold:4}"},{id:"backflip",label:"Backflip",action:"{ifAfterHeroRollInFight}{and}{ifDiscardDie:1,1}{then}{flipDieUpsideDown:1}"},{id:"spin",label:"Spin",action:"{ifAfterHeroRollInFight}{and}{ifPayGold:2}{then}{playLowerDieFirst}"},{id:"lunge",label:"Lunge",action:"{ifAfterHeroRollInFight}{and}{ifPayGold:2}{then}{placeDiceInSameColumn}"},{id:"sweep",label:"Sweep",action:"{ifAfterHeroRollInFight}{and}{ifPayGold:2}{then}{placeDiceInSameRow}"},{id:"mead",label:"Mead",action:"{ifAfterHeroRollInFight}{then}{discardAnyDie:1}{and}{setDieTo:1,6}"},{id:"epicWeapon",label:"{epicWeapon}",action:"{ifHeroTurn}{then}{fightingEnemyLoseHp:2,0,4}"},{id:"book",label:"Book",action:"{ifAfterHeroRollInFight}{and}{loseHp:1}{then}{fightingEnemyLoseHp:1,1,2}"},{id:"apple",label:"Apple",action:"{ifBeforeHeroRollInFight}{then}{gainHalfHp}"},{id:"invisibility",label:"Invisibility",action:"{ifNextEnemyRolls:3}{then}{discardAllDie<=:5}"},{id:"focus",label:"Focus",action:"{ifAfterHeroRollInFight}{then}{sumDice:2}, {activateAbility:1}, {pass}"},{id:"grenade",label:"Grenade",action:"{ifAfterHeroRollInFight}{then}{performByRoomSize:ATK}"},{id:"smoke",label:"Smoke",action:"{ifAfterHeroRollInFight}{then}{performByRoomSize:Move}"},{id:"sonic",label:"Sonic",action:"{ifAfterHeroRollInFight}{then}{performByRoomSize:DEF}"},{id:"frag",label:"Frag",action:"{ifAfterHeroLoseHp}{then}{fightingEnemyLoseHp:1,2,3}"},{id:"smallDie",label:"Small die",action:"{ifAfterHeroRollInFight}{then}{performFreeActionWithPower:1,4}"},{id:"bigDie",label:"Big die",action:"{ifAfterHeroRollInFight}{then}{performFreeActionWithPower:1,5}"},{id:"hugeDie",label:"Huge die",action:"{ifAfterHeroRollInFight}{then}{performFreeActionWithPower:1,6}"},{id:"curse",label:"Curse",action:"{loseFullHp-:2}{then}You lifted your curse, {markRoom:bossRoom}"},{id:"jacket",label:"Jacket",action:"{ifCrossDoor}{then}{fightingEnemyLoseHp:1,2,1}"}],x={list:[{id:"computer",label:"Computer"},{id:"electricity",label:"Electricity"},{id:"spaceship",label:"Spaceship"},{id:"city",label:"City"},{id:"ink",label:"Ink"},{id:"press",label:"Press"},{id:"end",label:"End"},{id:"luck",label:"Luck"},{id:"unluck",label:"Unluck"},{id:"time",label:"Time"},{id:"break",label:"Break"},{id:"loop",label:"Loop"},{id:"golem-1",label:"Golem 1"},{id:"golem-2",label:"Golem 2"},{id:"golem-3",label:"Golem 3"},{id:"manticore-1",label:"Manticore 1"},{id:"manticore-2",label:"Manticore 2"},{id:"manticore-3",label:"Manticore 3"},{id:"hellhound-1",label:"Hellhound 1"},{id:"hellhound-2",label:"Hellhound 2"},{id:"hellhound-3",label:"Hellhound 3"}],sets:[{id:"golemSet",label:"Golem"},{id:"manticoreSet",label:"Manticore"},{id:"hellhoundSet",label:"Hellhound"}]},r=function(){const e=40,o="{ifMoveOn:puzzle}{and}{ifRoomIsMarked:circleRoom}{and}{ifRoomIsMarked:triangleRoom}{and}{ifRoomIsNotMarked:squareRoom}{then}",t="{ifMoveOn:puzzle}{and}{ifRoomIsNotMarked:circleRoom}{and}{ifRoomIsMarked:triangleRoom}{and}{ifRoomIsMarked:squareRoom}{then}",i="{ifMoveOn:puzzle}{and}{ifRoomIsMarked:circleRoom}{and}{ifRoomIsNotMarked:triangleRoom}{and}{ifRoomIsMarked:squareRoom}{then}",n="{hide}{randomGoodReward}, {markItem:puzzle}",r=[["A painting of the Eye Of The Gods is hanging on the wall.",o+"The painting burns"+n],["The needle of the huge compass hanging from the ceiling is spinning.",o+"The needle stops"+n],["An image of your home comes to your mind.",t+"You miss home"+n],["There is a glass of wine on an altar.",t+"The wine disappear"+n],["There is a coin with a squared hole on the floor.",i+"The coin liquefies"+n],["There a bolt from some kind of machine on the floor.",i+"The bolt turns into ink"+n]];let a={id:"challengerRoom",labels:["Challenger","Card"],atPercentage:{from:1,to:99},items:[{genericItem:"challenger"}],roomDescriptions:[]},s={beasts:[{label:"Golem",id:"golem",setName:"golemSet",beatenBySet:"manticoreSet"},{label:"Manticore",id:"manticore",setName:"manticoreSet",beatenBySet:"hellhoundSet"},{label:"Hellhound",id:"hellhound",setName:"hellhoundSet",beatenBySet:"golemSet"}],events:[[a],[{id:"shopperRoom",labels:["Booster"],atPercentage:{from:1,to:99},items:[{genericItem:"shopper"}],roomDescriptions:[["{ifMoveOn:shopper}{and}{ifPayGold:3}{then}You open a booster pack{hide}{getRandomCard}","{ifMoveOn:shopper}{and}{ifPayGold:3}{then}You open a booster pack{hide}{getRandomCard}"],["{ifMoveOn:shopper}{then}You found a collectable card, {getRandomCard}, {markItem:shopper}"]]}]]};for(var l=0;l<s.beasts.length;l++)for(var m=1;m<4;m++){let e=s.beasts[l];a.roomDescriptions.push(['"Beat my '+e.label+" "+m+'!"{newRule}{ifMoveOn:challenger}{and}{ifLoseKeywordSet:'+e.beatenBySet+"}{then}{randomHighPrize}, {markItem:challenger}","{ifMoveOn:challenger}{and}{ifLoseKeywordSet:"+e.setName+"}{andPayGoldToReach:"+(m+1)+"}{then}{randomHighPrize}, {markItem:challenger}"])}return[{id:"[CODEX-Events] Subquest - The Guardians: Kill 2 mini-boss and earn bonus XPs.",minRooms:3,steps:[[{id:"guardian1",labels:["Near Guardian"],atPercentage:60,items:[{id:"enemy",level:2}],roomDescriptions:[['"We are the Guardian Twins. We cannot let you pass.", {markRoom:guardian1}',"{ifKilledLastFoe}{and}{markRoom:guardian2}{then}{gainXp:2}"]]},{id:"guardian2",labels:["Far Guardian"],atPercentage:99,items:[{id:"enemy",level:2}],roomDescriptions:[['"We are the Guardian Twins. We cannot let you pass.", {markRoom:guardian2}',"{ifKilledLastFoe}{and}{ifRoomIsMarked:guardian1}{then}{gainXp:2}"]]}]]},{id:"[CODEX-Events] Subquest - The Fountains: Decide between two effects.",minRooms:3,steps:[[{id:"room1",labels:["Near Waters"],atPercentage:60,items:[{genericItem:"switch"}],roomDescriptions:[["{ifMoveOn:switch}{and}{ifRoomIsNotMarked:room1}{then}You drink{hide}from {randomGoodFountain+randomBadFountain}, {markRoom:room1}, {markRoom:room2}"]]},{id:"room2",labels:["Far Waters"],atPercentage:99,items:[{genericItem:"switch"}],roomDescriptions:[["{ifMoveOn:switch}{and}{ifRoomIsNotMarked:room2}{then}You drink{hide}from {randomGoodFountain+randomBadFountain}, {markRoom:room2}, {markRoom:room1}"]]}]]},{id:"[CODEX-Events] Subquest - The Linked Rooms: Walk on a cell and enable another room effect.",minRooms:3,steps:[[{id:"switchRoom",labels:["Switch"],atPercentage:{from:1,to:99},items:[{genericItem:"switch"}],roomDescriptions:[["{ifMoveOn:switch}{then}{randomMysteryHappens}{hide}{markRoom:switchRoom}, {markItem:switch}"]]},{id:"switchEffect",labels:["Switched"],atPercentage:{from:1,to:99},roomDescriptions:[["{ifRoomIsMarked:switchRoom}{and}{ifRoomIsNotMarked:switchEffect}{then}{hide}{randomGoodRoomEffect+randomBadRoomEffect}, {markRoom:switchEffect}"]]}]]},{id:"[CODEX-Events] Subquest - The Key And The Chests: Find the key and open one of two random chests.",minRooms:3,steps:[[{id:"keyRoom",labels:["Lock Key"],atPercentage:60,items:[{genericItem:"key"}],roomDescriptions:[["{ifMoveOn:key}{then}You found {randomSmallKey}, {markRoom:keyRoom}, {markItem:key}"]]},{id:"chestRoom1",atPercentage:1,labels:["First Chest"],items:[{genericItem:"chest"}],roomDescriptions:[["{ifMoveOn:chest}{and}{ifRoomIsMarked:keyRoom}{and}{ifRoomIsNotMarked:chestRoom1}{then}You found{hide}{randomGoodLoot+randomBadLoot}, {markRoom:chestRoom1}, {markRoom:chestRoom2}"]]},{id:"chestRoom2",labels:["Last Chest"],atPercentage:99,items:[{genericItem:"chest"}],roomDescriptions:[["{ifMoveOn:chest}{and}{ifRoomIsMarked:keyRoom}{and}{ifRoomIsNotMarked:chestRoom2}{then}You found{hide}{randomGoodLoot+randomBadLoot}, {markRoom:chestRoom1}, {markRoom:chestRoom2}"]]}]]},{id:"[CODEX-Events] Subquest - The Key And The Chest (good): Find the key and open one good chest.",minRooms:3,steps:[[{id:"keyRoom",labels:["Good Key"],atPercentage:99,items:[{genericItem:"key"}],roomDescriptions:[["{ifMoveOn:key}{then}You found {randomSmallKey}, {markRoom:keyRoom}, {markItem:key}"]]},{id:"chestRoom1",labels:["Tiny Chest"],atPercentage:1,items:[{genericItem:"chest"}],roomDescriptions:[["{ifMoveOn:chest}{and}{ifRoomIsMarked:keyRoom}{then}You found{hide}{randomGoodLoot}, {markItem:chest}"]]}]]},{id:"[CODEX-Events] Subquest - The Gambler: Bet Gold, roll a die and you may win more gold.",minRooms:3,steps:[[{id:"keyRoom",labels:["Betting","Bet"],atPercentage:99,items:[{genericItem:"gambler"}],roomDescriptions:[["Gambler: {randomGambler}","{ifMoveOn:gambler}{and}{ifPayGold:3}{then}{markItem:gambler}, {rollDie}{range:1-4} {nothing}, {range:5-6} {gainGold:6}"]]}]]},{id:"[CODEX-Events] Subquest - The Elemental Chest: Find the 2 elemental keys and open a chest containing equipment.",minRooms:3,steps:[{key:"Water Droplet",shortKey:"Droplet",name:"Flaming Chest",content:"rage"},{key:"Cloud Curl",shortKey:"Curl",name:"Rock Chest",content:"taunt"},{key:"Bright Spark",shortKey:"Spark",name:"Windy Chest",content:"dash"},{key:"Small Rock",shortKey:"Rock",name:"Wet Chest",content:"tactic"}].map((e=>[{id:"keyRoom1",labels:["First "+e.shortKey],atPercentage:20,items:[{genericItem:"key"},{id:"enemy",level:0}],roomDescriptions:[["{ifMoveOn:key}{then}You found a "+e.key+", {markRoom:keyRoom1}, {markItem:key}"]]},{id:"keyRoom2",labels:["Last "+e.shortKey],atPercentage:60,items:[{genericItem:"key"},{id:"enemy",level:1}],roomDescriptions:[["{ifMoveOn:key}{then}You found a "+e.key+", {markRoom:keyRoom2}, {markItem:key}"]]},{id:"chestRoom",labels:["Great Chest"],atPercentage:99,items:[{genericItem:"chest"}],equipment:[{id:e.content}],roomDescriptions:[["{ifMoveOn:chest}{and}{ifRoomIsMarked:keyRoom1}{and}{ifRoomIsMarked:keyRoom2}{then}You opened the "+e.name+"...{hide}{getEquip:equip-"+e.content+"}, {markItem:chest}"]]}]))},{id:"[CODEX-Events] Subquest - The Trainer: Face his test and earn gold.",minRooms:1,debug:!0,steps:[{sentence:"A coward hero has no use.",test:"testBravery"},{sentence:"A hero respects the enemy.",test:"testMercy"},{sentence:"A hero doesn't rush his strength.",test:"testCalm"}].map((e=>[{id:"trainerRoom",labels:["Training"],atPercentage:99,items:[{genericItem:"trainer"}],equipment:[{id:e.test}],roomDescriptions:[['{ifMoveOn:trainer}{then}Trainer: "'+e.sentence+'", {getEquip:equip-'+e.test+"}, {markItem:trainer}"]]}]))},{id:"[CODEX-Events] Subquest - The Bloody Gambler: Bet HP, roll a die and you may win more HP.",minRooms:3,steps:[[{id:"keyRoom",labels:["Risky","Risk"],atPercentage:99,items:[{genericItem:"gambler"}],roomDescriptions:[["Bloody Gambler: {randomGambler}","{ifMoveOn:gambler}{and}{loseHp:1}{then}{markItem:gambler}, {rollDie}{range:1-3} {nothing}, {range:4-6} {gainHp:2}"]]}]]},{id:"[CODEX-Events] Subquest - The Altar: Sacrify important resources for other advantages.",minRooms:2,steps:[[{id:"keyRoom",labels:["Pray","Prayer"],atPercentage:99,items:[{genericItem:"altar"}],roomDescriptions:[["{ifMoveOn:altar}{and}{randomHighCost}{then}Altar: {randomAltar}, {randomHighPrize}, {markItem:altar}"]]}]]},{id:"[CODEX-Events] Subquest - The Sphynx: Give the right answer, meet the Sphynx and get your reward.",minRooms:3,steps:[[{id:"answerRoom",labels:["Answer"],atPercentage:10,items:[{genericItem:"sphynx"}],shuffleRoomDescriptions:!0,roomDescriptions:[['{ifMoveOn:sphynx}{and}{ifRoomIsMarked:answerRoom}{then}Sphinx: "Your answer..."{hide}{randomSphinxOk}, {randomGoodReward}, {markItem:sphynx}','{ifMoveOn:sphynx}{and}{ifRoomIsMarked:questionRoom}{then}Sphinx: "Your answer..."{hide}{randomSphinxKo}, {randomBadReward}, {markItem:sphynx}']]},{id:"questionRoom",labels:["Question"],atPercentage:99,items:[{genericItem:"statue"}],shuffleRoomDescriptions:!0,roomDescriptions:[['{ifMoveOn:statue}{and}"{truth}"{then}Sphinx: {randomSphinxAnswerAccept}, {markRoom:answerRoom}, {markItem:statue}','{ifMoveOn:statue}{and}"{lie}"{then}Sphinx: {randomSphinxAnswerAccept}, {markRoom:questionRoom}, {markItem:statue}']]}],[{id:"answerRoom",labels:["Answer"],atPercentage:10,items:[{genericItem:"sphynx"}],shuffleRoomDescriptions:!0,roomDescriptions:[['{ifMoveOn:sphynx}{and}{ifRoomIsMarked:questionRoom}{then}Sphinx: "Your answer..."{hide}{randomSphinxOk}, {randomGoodReward}, {markItem:sphynx}','{ifMoveOn:sphynx}{and}{ifRoomIsMarked:answerRoom}{then}Sphinx: "Your answer..."{hide}{randomSphinxKo}, {randomBadReward}, {markItem:sphynx}']]},{id:"questionRoom",labels:["Question"],atPercentage:99,items:[{genericItem:"statue"}],shuffleRoomDescriptions:!0,roomDescriptions:[['{ifMoveOn:statue}{and}"{truth}"{then}Sphinx: {randomSphinxAnswerAccept}, {markRoom:questionRoom}, {markItem:statue}','{ifMoveOn:statue}{and}"{lie}"{then}Sphinx: {randomSphinxAnswerAccept}, {markRoom:answerRoom}, {markItem:statue}']]}]]},{id:"[CODEX-Events] Subquest - The Murderer: Avenge the dead body or steal its gold?",minRooms:3,steps:[[{id:"corpseRoom",labels:["Victim","Innocence"],atPercentage:10,items:[{genericItem:"corpse"}],roomDescriptions:[['{ifMoveOn:corpse}{and}"I\'ll avenge this {victimName} death!"{then}{markRoom:killerRoom}, {markItem:corpse}','{ifMoveOn:corpse}{and}"This dead {victimName} won\'t need this..."{then}{randomGold}, {markItem:corpse}']]},{id:"killerRoom",labels:["Vegeance","Justice"],atPercentage:99,items:[{id:"enemy",level:1}],roomDescriptions:[["{randomMurderer}","{ifKilledLastFoe}{and}{ifRoomIsMarked:killerRoom}{then}{hide}You avenged the {victimName}, {randomGoodReward}"]]}]]},{id:"[CODEX-Events] Subquest - The Barman: Pay gold for health or a short mission.",minRooms:2,steps:[[{id:"barmanRoom",labels:["Alcohol","Serving","Drinking"],atPercentage:10,items:[{genericItem:"barman"}],roomDescriptions:[['{ifMoveOn:barman}{and}{ifPayGold:1}{then}Barman: "Well..."{hide}"Someone is hiding here...", {markRoom:missionRoom}, {markItem:barman}',"{ifMoveOn:barman}{and}{ifPayGold:3}{then}Barman: {randomShopKeeper}, {gainHp:1}, {markItem:barman}"]]},{id:"missionRoom",labels:["Rumors","Rumored"],atPercentage:99,items:[{id:"enemy",level:1}],roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsNotMarked:missionRoom}{then}{roomIsEmpty}, {stopReading}","{randomHiddenFoe}"]]}],[{id:"barmanRoom",labels:["Alcohol","Serving","Drinking"],atPercentage:10,items:[{genericItem:"barman"}],roomDescriptions:[['{ifMoveOn:barman}{and}{ifPayGold:1}{then}Barman: "Well..."{hide}"Something is hiding here...", {markRoom:missionRoom}, {markItem:barman}',"{ifMoveOn:barman}{and}{ifPayGold:3}{then}Barman: {randomShopKeeper}, {gainHp:1}, {markItem:barman}"]]},{id:"missionRoom",labels:["Rumors","Rumored"],atPercentage:99,items:[{genericItem:"item"}],roomDescriptions:[["{ifMoveOn:item}{and}{ifRoomIsMarked:missionRoom}{then}You found{hide}{randomGoodLoot+randomBadLoot}, {markItem:item}"]]}]]},{id:"[CODEX-Events] Subquest - The Shapes Puzzle: Get the right shapes to solve the puzzle.",minRooms:3,steps:[[{id:"squareRoom",labels:["Shapes"],atPercentage:{from:1,to:99},items:[{genericItem:"square"},{genericItem:"triangle"}],roomDescriptions:[["{ifMoveOn:square}{then}The engraved square on the floor is now glowing, {markItem:square}, {markRoom:squareRoom}","{ifMoveOn:triangle}{then}The engraved triangle on the floor is now glowing, {markItem:triangle}, {markRoom:triangleRoom}"]]},{id:"circleRoom",labels:["Shape"],atPercentage:{from:1,to:99},items:[{genericItem:"circle"},{id:"enemy",level:1}],roomDescriptions:[["{ifMoveOn:circle}{then}The engraved circle on the floor is now glowing, {markItem:circle}, {markRoom:circleRoom}"]]},{id:"triangleRoom",labels:["Hint"],atPercentage:{from:1,to:99},items:[{genericItem:"puzzle"}],roomDescriptions:r}],[{id:"squareRoom",labels:["Shapes"],atPercentage:{from:1,to:99},items:[{genericItem:"square"},{genericItem:"circle"}],roomDescriptions:[["{ifMoveOn:square}{then}The engraved square on the floor is now glowing, {markItem:square}, {markRoom:squareRoom}","{ifMoveOn:circle}{then}The engraved circle on the floor is now glowing, {markItem:circle}, {markRoom:circleRoom}"]]},{id:"triangleRoom",labels:["Shape"],atPercentage:{from:1,to:99},items:[{genericItem:"triangle"},{id:"enemy",level:1}],roomDescriptions:[["{ifMoveOn:triangle}{then}The engraved triangle on the floor is now glowing, {markItem:triangle}, {markRoom:triangleRoom}"]]},{id:"circleRoom",labels:["Hint"],atPercentage:{from:1,to:99},items:[{genericItem:"puzzle"}],roomDescriptions:r}],[{id:"triangleRoom",labels:["Shapes"],atPercentage:{from:1,to:99},items:[{genericItem:"triangle"},{genericItem:"circle"}],roomDescriptions:[["{ifMoveOn:triangle}{then}The engraved triangle on the floor is now glowing, {markItem:triangle}, {markRoom:triangleRoom}","{ifMoveOn:circle}{then}The engraved circle on the floor is now glowing, {markItem:circle}, {markRoom:circleRoom}"]]},{id:"squareRoom",labels:["Shape"],atPercentage:{from:1,to:99},items:[{genericItem:"square"},{id:"enemy",level:1}],roomDescriptions:[["{ifMoveOn:square}{then}The engraved square on the floor is now glowing, {markItem:square}, {markRoom:squareRoom}"]]},{id:"circleRoom",labels:["Hint"],atPercentage:{from:1,to:99},items:[{genericItem:"puzzle"}],roomDescriptions:r}]]},{id:"[CODEX-Events] Subquest - The Nothing: A teleport to a place that leaves you no choice.",minRooms:2,steps:[[{id:"teleportRoom",labels:["Sleeping"],atPercentage:10,items:[{genericItem:"teleport"}],roomDescriptions:[["{ifMoveOn:teleport}{and}{ifRoomIsMarked:teleportRoom}{then}{randomTeleportation}, {markItem:teleport}, {teleportToRoom:hiddenRoom}"]]},{id:"switchRoom",labels:["Wake Up"],atPercentage:99,items:[{id:"enemy",level:1}],roomDescriptions:[["{ifKilledLastFoe}{then}{randomMysteryHappens}, {markRoom:teleportRoom}"]]},{id:"hiddenRoom",labels:["Hidden"],isHiddenRoom:!0,atPercentage:{from:1,to:99},items:[{genericItem:"item"}],roomDescriptions:[["{randomConfusion}","{ifMoveOn:item}{then}You found the Red Coin, {randomGoodReward}, {teleportToRoom:teleportRoom}"],["{randomConfusion}","{ifMoveOn:item}{then}You found the Blue Coin, {randomBadReward}, {teleportToRoom:teleportRoom}"]]}],[{id:"teleportRoom",labels:["Sleeping"],atPercentage:10,items:[{genericItem:"teleport"}],roomDescriptions:[["{ifMoveOn:teleport}{and}{ifRoomIsMarked:teleportRoom}{then}{randomTeleportation}, {markItem:teleport}, {teleportToRoom:hiddenRoom}"]]},{id:"switchRoom",labels:["Wake Up"],atPercentage:99,items:[{id:"enemy",level:0}],roomDescriptions:[["{ifKilledLastFoe}{then}{randomMysteryHappens}, {markRoom:teleportRoom}"]]},{id:"hiddenRoom",labels:["Hidden"],isHiddenRoom:!0,atPercentage:{from:1,to:99},items:[{id:"enemy",level:2,ignoreXp:!0}],roomDescriptions:[["{randomConfusion}","{ifNoFoes}{then}{randomTeleportation}, {teleportToRoom:teleportRoom}"]]}]]},{probability:e,id:"[CODEX-Events] Subquest - The Beastcrafters: A simple trading card game Stampadians used to play. Buy or find new cards and play.",steps:s.events},{id:"[CODEX-Events] Subquest - The Broken Teleport: Solve the riddle to reach an item.",minRooms:2,steps:[{content:"apple"},{content:"invisibility"},{content:"jacket"}].map((e=>[{id:"teleportRoom",labels:["Damaged"],atPercentage:10,items:[{genericItem:"teleport"}],roomDescriptions:[["{randomBrokenTeleport} Can you fix it?",'{ifMoveOn:teleport}{and}{ifRoomIsNotMarked:teleportRoom}{then}A sign says "{teleportToRiddleRoom:secretRoom}"']]},{id:"secretRoom",labels:[],isHiddenRoom:!0,atPercentage:{from:1,to:99},items:[{genericItem:"item"}],equipment:[{id:e.content}],roomDescriptions:[["{ifMoveOn:item}{then}{getEquip:equip-"+e.content+"}, {markItem:item}, {markRoom:teleportRoom}, {teleportToRoom:teleportRoom}"]]}]))},{id:"[CODEX-Events] Subquest - The Tapeworm: Kill the monster to stop him digesting you.",minRooms:3,steps:[[{id:"monsterRoom",labels:["Eater","Parasite","Head"],items:[{id:"enemy",level:2}],atPercentage:99,roomDescriptions:['"Yummy meat... escaped... stomach?"','"{heroClass} food... hurts!"','"Food... go back... belly!"'].map((e=>[e,"{ifKilledLastFoe}{then}{gainHp:1}, {markRoom:monsterRoom}"]))},{id:"digestingRoom",labels:["Stomach","Eating"],atPercentage:{from:50,to:98},roomDescriptions:[["Organic walls are trying to squeeze you.","{ifEnterRoom}{and}{ifRoomIsNotMarked:monsterRoom}{then}The whole room is trying to digest you, {loseHp:1}"]]}]]},{id:"[CODEX-Events] Subquest - The Monk: Donate 1G to draw one room walls.",minRooms:1,steps:[[{id:"monkRoom",labels:["Map","Mapping","Peeking"],atPercentage:{from:1,to:99},items:[{genericItem:"monk"}],roomDescriptions:[['{ifMoveOn:monk}{and}{ifPayGold:1}{then}Monk: "Peek at my map!", {discoverAnyRoom:1}, {markItem:monk}']]}]]},{id:"[CODEX-Events] Subquest - The Traitor: Kill the enemy to learn where the boss is lurking.",minRooms:1,steps:[[{id:"traitorRoom",labels:["Traitor","Information"],atPercentage:100,items:[{id:"enemy",level:2}],roomDescriptions:[['{ifKilledLastFoe}{then}"What you\'re looking for... is... here...", {discoverRoom:bossRoom}']]}]]},{id:"[CODEX-Events] Subquest - The Landslide: Free a room from rubbles or prevent it from collapsing to get an reward.",minRooms:1,steps:[[{id:"landslideRoom",labels:["Landslide","Fallen","Broken"],atPercentage:{from:1,to:99},isOptionalRoom:!0,items:[{genericItem:"pickup"}],roomDescriptions:[["{ifRoomIsMarked:landslideRoom}{then}This room is collapsed, {goBack}","{ifMoveOn:pickup}{then}You found{hide}{randomGoodLoot}, {markItem:pickup}"]]},{id:"switchRoom",labels:["Earthquake","Disaster"],atPercentage:{from:1,to:99},items:[{genericItem:"switch"},{id:"enemy",level:1,ignoreXp:!0}],roomDescriptions:[["{ifMoveOn:switch}{then}{randomMysteryHappens}{hide}{markRoom:landslideRoom}, {markItem:switch}"]]}],[{id:"landslideRoom",labels:["Landslide","Fallen","Blocked"],atPercentage:{from:1,to:99},isOptionalRoom:!0,items:[{genericItem:"pickup"}],roomDescriptions:[["{ifRoomIsNotMarked:landslideRoom}{then}This room is collapsed, {goBack}","{ifMoveOn:pickup}{then}You found{hide}{randomGoodLoot}, {markItem:pickup}"]]},{id:"fixerRoom",labels:["Fixer","Worker"],atPercentage:{from:1,to:99},items:[{genericItem:"helper"},{id:"enemy",level:2}],roomDescriptions:[['{ifKilledLastFoe}{then}"Thank you!"{hide}"I\'ll help you with that room!", {markRoom:landslideRoom}, {markItem:helper}']]}]]},{id:"[CODEX-Events] Subquest - The Architect: Beat him to get one of his items.",minRooms:1,steps:[[{id:"architectRoom",labels:["Architect","Construction","Die","Dice"],atPercentage:{from:50,to:70},items:[{id:"enemy",level:1}],equipment:[{id:"smallDie"}],roomDescriptions:[["Architect: {randomArchitectEntrance}","{ifKilledLastFoe}{then}{randomArchitectLoseDie}, {getEquip:equip-smallDie}"]]}],[{id:"architectRoom",labels:["Architect","Construction","Die","Dice"],atPercentage:{from:70,to:80},items:[{id:"enemy",level:1}],equipment:[{id:"bigDie"}],roomDescriptions:[["Architect: {randomArchitectEntrance}","{ifKilledLastFoe}{then}{randomArchitectLoseDie}, {getEquip:equip-bigDie}"]]}],[{id:"architectRoom",labels:["Architect","Construction","Die","Dice"],atPercentage:99,items:[{id:"enemy",level:2}],equipment:[{id:"hugeDie"}],roomDescriptions:[["Architect: {randomArchitectEntrance}","{ifKilledLastFoe}{then}{randomArchitectLoseDie}, {getEquip:equip-hugeDie}"]]}]]}]}(),c=function(){const e=40,o=[];return[{cost:"{ifPayGold:3}",answer:"{randomShopKeeper}",effect:"{gainHp:1}"},{cost:"{ifPayGold:7}",answer:"{randomShopKeeper}",effect:"{gainHp:2}"},{cost:"{ifPayGold:4}",answer:"{randomShopKeeper}",effect:"{gainXp:1}"},{cost:"{ifPayXp:1}",answer:"{randomDarkShopKeeper}",effect:"{gainHp:1}"},{cost:"{ifPayXp:2}",answer:"{randomDarkShopKeeper}",effect:"{gainHp:2}"},{cost:"{ifPayXp:2}",answer:"{randomDarkShopKeeper}",effect:"{gainGold:5}"}].forEach((e=>{o.push(["{ifMoveOn:item}{and}"+e.cost+"{then}"+e.answer+", "+e.effect+", {markItem:item}"])})),[{id:"[CODEX-Events] Bonus - The Random Item: A random bonus item.",minRooms:2,steps:[[{id:"spawn",labels:["Item"],atPercentage:99,roomDescriptions:[["{ifMoveOn:item}{then}{hide}You found {randomGoodLoot}, {markItem:item}"]],items:[{genericItem:"item"}]}]]},{id:"[CODEX-Events] Bonus - The NPC: Learn about the Stampadia lore by Stampadians.",minRooms:2,steps:[[{id:"spawn",labels:["Guy","Talking","Chat","Chatting"],atPercentage:99,roomDescriptions:[['{ifMoveOn:item}{then}Traveller: "Are the wall of this dungeon moving?"'],['{ifMoveOn:item}{then}Traveller: "Is this world just... someone\'s dream?"'],['{ifMoveOn:item}{then}Traveller: "Is the Monk I meet around ever the same?"'],['{ifMoveOn:item}{then}Traveller: "Is this the first time I enter this place?"'],['{ifMoveOn:item}{then}Ghost: "You don\'t have to use both of them."'],['{ifMoveOn:item}{then}Ghost: "What you see is not always what you get."'],['{ifMoveOn:item}{then}Ghost: "Sometimes looking back is not a waste of money."'],['{ifMoveOn:item}{then}Ghost: "The second time is always easier."'],['{ifMoveOn:item}{then}Ghost: "Time is money. Make sure to spend it well."'],['{ifMoveOn:item}{then}Monk: "Excuse me, where the exit is located? Thanks!", {markItem:item}'],['{ifMoveOn:item}{then}Monk: "Excuse me, what is your name? Thanks!", {markItem:item}'],['{ifMoveOn:item}{then}Monk: "Excuse me, was the previous room squared? Thanks!", {markItem:item}'],['{ifMoveOn:item}{then}Monk: "Excuse me, do you know the {goodGuyName}? Thanks!", {markItem:item}'],['{ifMoveOn:item}{then}Monk: "Excuse me, are you a {heroClass}? Thanks!", {markItem:item}'],['{ifMoveOn:item}{then}Monk: "Excuse me, is the {villainName} here? Thanks!", {markItem:item}'],['{ifMoveOn:item}{then}Monk: "Excuse me, are we at the {placeName}? Thanks!", {markItem:item}'],['{ifMoveOn:item}{then}Carpenter: "Someone here asked for my help..."'],['{ifMoveOn:item}{then}Carpenter: "Where is the machine I\'ve to fix?"'],['{ifMoveOn:item}{then}Carpenter: "Did you find any spare parts lying around?"'],['{ifMoveOn:item}{then}Carpenter: "Damn... is the ink already out?"'],['{ifMoveOn:item}{then}Carpenter: "They will have to pay me well for this job!"'],['{ifMoveOn:item}{then}Sergio: "And so I\'m here. A philosopher in a world of monsters."'],['{ifMoveOn:item}{then}Sergio: "Is this really the best possible world?"'],['{ifMoveOn:item}{then}Sergio: "I spent my life spent inventing such a weird world..."'],['{ifMoveOn:item}{then}Sergio: "Maybe we need a new world. With a lot of self-irony."'],['{ifMoveOn:item}{then}Sergio: "Is this really the best possible world?"'],['{ifMoveOn:item}{then}Sergio: "Dignity, of course. And some good self-irony."']],items:[{genericItem:"item"}]}]]},{id:"[CODEX-Events] Bonus - The Teleports: Teleport from a room to another.",minRooms:4,steps:[[{id:"roomA",isExclusive:!0,labels:["Near Teleport","First Teleport"],atPercentage:1,roomDescriptions:[["{ifMoveOn:item1}{then}{randomTeleportation}{hide}{teleportToRoom:roomB}"]],items:[{genericItem:"item1"}]},{id:"roomB",isExclusive:!0,labels:["Far Teleport","Last Teleport"],atPercentage:99,roomDescriptions:[["{ifMoveOn:item2}{then}{randomTeleportation}{hide}{teleportToRoom:roomA}"]],items:[{genericItem:"item2"}]}]]},{id:"[CODEX-Events] Bonus - The Shop: Pay gold or other valuables for useful items.",minRooms:2,steps:[[{id:"spawn",labels:["Shop","Shopping","Sale"],atPercentage:99,roomDescriptions:o,items:[{genericItem:"item"}]}]]},{id:"[CODEX-Events] Bonus - The Saint: They will help you when you're in danger.",minRooms:4,steps:[[{id:"roomA",labels:["Sacred"],atPercentage:{from:50,to:99},roomDescriptions:[["{ifMoveOn:saint}{and}{ifHpLeft=:0}{then}Saint: {randomSaint}, {gainHp:2}, {markItem:saint}"]],items:[{genericItem:"saint"}]}]]},{id:"[CODEX-Events] Bonus - The Magic Tree: It grows a healing fruit after some time.",minRooms:2,steps:[[{id:"roomA",labels:["Rotten","Tree"],atPercentage:{from:1,to:99},roomDescriptions:[["{randomMagicTree}","{ifMoveOn:tree}{and}{ifGoldLeft<half}{then}You pick a Fruit, {randomGoodReward}, {markItem:tree}"]],items:[{genericItem:"tree"}]}],[{id:"roomA",labels:["Blooming","Tree"],atPercentage:{from:1,to:99},roomDescriptions:[["{randomMagicTree}","{ifMoveOn:tree}{and}{ifGoldLeft>half}{then}You pick a Fruit, {randomGoodReward}, {markItem:tree}"]],items:[{genericItem:"tree"}]}]]},{id:"[CODEX-Events] Bonus - The Mirror: Go back to this room using an item.",minRooms:2,steps:[[{id:"equip-mirror-room",labels:["Reflection","Twin"],atPercentage:99,equipment:[{id:"mirror"}],roomDescriptions:[["{ifMoveOn:mirror}{then}You see your reflection on a large mirror, {markItem:mirror}, {getEquip:equip-mirror}"]],items:[{genericItem:"mirror"}]}]]},{probability:e,id:"[CODEX-Events] Bonus - The Clover: It may bring good luck in your future adventures...",minRooms:2,steps:[[{id:"roomA",labels:["Lucky"],atPercentage:99,roomDescriptions:[["{ifMoveOn:item}{and}{ifLoseKeyword:luck}{then}You found{hide}{randomGoodLoot}, {markItem:item}","{ifMoveOn:item}{and}{ifNotKeyword:luck}{then}You found a clover, {getKeyword:luck}, {markItem:item}"]],items:[{genericItem:"item"}]}]]},{id:"[CODEX-Events] Bonus - The Clown: Pay him/her to learn cool stunts!",minRooms:1,steps:[[{id:"clownRoom",labels:["Jumping","Circus"],atPercentage:99,equipment:[{id:"backflip"}],roomDescriptions:[['{ifMoveOn:clown}{and}{ifPayGold:5}{then}Clown: "Nice jump, {heroClass}!", {getEquip:equip-backflip}, {markItem:clown}']],items:[{genericItem:"clown"}]}],[{id:"clownRoom",labels:["Dancing","Music","Circus"],atPercentage:99,equipment:[{id:"spin"}],roomDescriptions:[['{ifMoveOn:clown}{and}{ifPayGold:5}{then}Clown: "Nice dancing, {heroClass}!", {getEquip:equip-spin}, {markItem:clown}']],items:[{genericItem:"clown"}]}],[{id:"clownRoom",labels:["Stretching","Circus"],atPercentage:99,equipment:[{id:"lunge"}],roomDescriptions:[['{ifMoveOn:clown}{and}{ifPayGold:5}{then}Clown: "Nice stretch, {heroClass}!", {getEquip:equip-lunge}, {markItem:clown}']],items:[{genericItem:"clown"}]}],[{id:"clownRoom",labels:["Sweeping","Circus"],atPercentage:99,equipment:[{id:"sweep"}],roomDescriptions:[['{ifMoveOn:clown}{and}{ifPayGold:5}{then}Clown: "Nice sweep, {heroClass}!", {getEquip:equip-sweep}, {markItem:clown}']],items:[{genericItem:"clown"}]}]]},{id:"[CODEX-Events] Bonus - The Wildness (good): Earn a buff after fighting an enemy.",minRooms:1,steps:[{labels:["Bear","Hungry"],intro:"A giant roaring bear stares at you with a hungry gaze.",action:"It was a grueling fight",effect:"{applyModifierOnRoomMarked:scared.enemy,biteRoom}"},{labels:["Porcupine","Spikes"],intro:"A giant porcupine seems to have a particular interest in you.",action:"Its thorns remain on your body",effect:"{applyModifierOnRoomMarked:crippled.enemy,biteRoom}"},{labels:["Fly","Spores"],intro:"A huge winged moth is spreading spores all over the room.",action:"The spores stick to your body",effect:"{applyModifierOnRoomMarked:blind.enemy,biteRoom}"},{labels:["Colors","Whirlwind"],intro:"A whirlwind of light seems to engulf the colors from every corner of the room.",action:"Colors explode on you",effect:"{applyModifierOnRoomMarked:stunned.enemy,biteRoom}"}].map((e=>[{id:"biteRoom",labels:e.labels,atPercentage:99,globalModifier:e.effect,roomDescriptions:[[e.intro,"{ifKilledLastFoe}{then}"+e.action+", {markRoom:biteRoom}"]],items:[{id:"enemy",level:2}]}]))},{id:"[CODEX-Events] Bonus - The Powder Magazine: Choose between 2 room-size based weapons.",minRooms:2,steps:[[{id:"magazineRoom",labels:["Magazine","Powder","Grenade","Smoke"],atPercentage:{from:1,to:99},equipment:[{id:"grenade"},{id:"smoke"}],roomDescriptions:[["{ifMoveOn:item1}{and}{ifPayGold:4}{then}{getEquip:equip-grenade}, {markItem:item1}, {markItem:item2}","{ifMoveOn:item2}{and}{ifPayGold:2}{then}{getEquip:equip-smoke}, {markItem:item1}, {markItem:item2}"]],items:[{genericItem:"item1"},{genericItem:"item2"}]}],[{id:"magazineRoom",labels:["Magazine","Powder","Grenade","Sonic"],atPercentage:{from:1,to:99},equipment:[{id:"grenade"},{id:"sonic"}],roomDescriptions:[["{ifMoveOn:item1}{and}{ifPayGold:4}{then}{getEquip:equip-grenade}, {markItem:item1}, {markItem:item2}","{ifMoveOn:item2}{and}{ifPayGold:2}{then}{getEquip:equip-sonic}, {markItem:item1}, {markItem:item2}"]],items:[{genericItem:"item1"},{genericItem:"item2"}]}]]}]}(),p=[{id:"[CODEX-Events] Malus - The Switch Trap: Step on a trap to get injured.",steps:[[{id:"trap",labels:["Trap"],atPercentage:99,items:[{genericItem:"switch"}],roomDescriptions:[["{ifMoveOn:switch}{then}{hide}{randomTrap}, {loseHp:1}, {markItem:switch}"]]}]]},{id:"[CODEX-Events] Malus - The Loop Rooms: It will teleport you to the starting room.",steps:[[{id:"trap",labels:["Shrimp","Way Back"],atPercentage:{from:50,to:99},roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsNotMarked:trap}{then}{markRoom:trap}, {teleportToStartingRoom}"]]}]]},{id:"[CODEX-Events] Malus - The Teleport Trap: It will teleport you to a room with an enemy.",minRooms:4,steps:[[{id:"switch",labels:["Bad Teleport"],atPercentage:51,roomDescriptions:[["{ifMoveOn:item1}{then}{randomTeleportation}{hide}{markItem:item1}, {teleportToRoom:trap}"]],items:[{genericItem:"item1"}]},{id:"trap",labels:["Surprise Attack"],atPercentage:99,roomDescriptions:[['"You fell in my trap!"'],['"What are you doing here?!"'],['"Hey... YOU!"'],['"Well well... What we have here?"']],items:[{id:"enemy",level:2}]}]]},{id:"[CODEX-Events] Malus - The Random Trap: Dodge a trap rolling a die.",steps:[[{id:"trap",labels:["Rolling Trap","Random Trap","Killing Fate"],atPercentage:99,roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsNotMarked:trap}{then}{markRoom:trap}, {rollDie}{range:1-4} {loseHp:1}, {range:5-6} {nothing}"],["{ifEnterRoom}{and}{ifRoomIsNotMarked:trap}{then}{markRoom:trap}, {rollDie}{range:1-2} {loseHp:2}, {range:3-6} {nothing}"]]}]]},{id:"[CODEX-Events] Malus - The Last Fight (1): An enemy will challenge you on your way back.",ignoreForHeroTags:["weak"],steps:[[{id:"enemy",labels:["Avenging","Last Fight"],atPercentage:50,items:[{id:"enemy",level:2}],roomDescriptions:[["{ifRoomIsNotMarked:startingRoom}{then}{roomIsEmpty}, {stopReading}","{randomEnemyChallenge}"]]}]]},{id:"[CODEX-Events] Malus - The Last Fight (2): An enemy will challenge you on your way back.",onlyForHeroTags:["weak"],steps:[[{id:"enemy",labels:["Avenging","Last Fight"],atPercentage:50,items:[{id:"enemy",level:2,ignoreXp:!0}],roomDescriptions:[["{ifRoomIsNotMarked:startingRoom}{then}{roomIsEmpty}, {stopReading}","{randomEnemyChallenge}"]]}]]},{id:"[CODEX-Events] Malus - The Timed Traps: Defuse it with the right timing or it will trigger!",minRooms:2,steps:[[{id:"roomA",labels:["Bomb","Clicking"],atPercentage:99,roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsNotMarked:roomA}{and}{ifGoldLeft<half}{then}You triggered a trap, {randomBadReward}, {markRoom:roomA}","{ifEnterRoom}{and}{ifRoomIsNotMarked:roomA}{and}{ifGoldLeft>half}{then}You managed to defuse a trap, {markRoom:roomA}"]]}],[{id:"roomA",labels:["Bomb","Clicking"],atPercentage:99,roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsNotMarked:roomA}{and}{ifGoldLeft>half}{then}You triggered a trap, {randomBadReward}, {markRoom:roomA}","{ifEnterRoom}{and}{ifRoomIsNotMarked:roomA}{and}{ifGoldLeft<half}{then}Someone triggered a trap, {markRoom:roomA}"]]}]]},{id:"[CODEX-Events] Malus - The Witch: Pay her or she will curse you!",minRooms:2,steps:[[{id:"witchRoom",labels:["Witch"],items:[{genericItem:"witch"}],atPercentage:{from:10,to:40},roomDescriptions:[['{ifMoveOn:witch}{and}{ifPayGold:3}{then}Witch: "Thank you, {heroClass}! Heh heh...", {markRoom:witchRoom}, {markItem:witch}']]},{id:"cursedRoom",labels:["Witched"],atPercentage:99,roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsNotMarked:cursedRoom}{and}{ifRoomIsNotMarked:witchRoom}{then}{randomBadFeeling}, {randomBadReward}, {markRoom:cursedRoom}"]]}]]},{id:"[CODEX-Events] Malus - The Mercenary: Eliminate an enemy or pay The Mercenary to do that.",minRooms:3,steps:[[{id:"mercenaryRoom",labels:["Assassin","Killer"],items:[{genericItem:"mercenary"}],atPercentage:10,roomDescriptions:[["{ifMoveOn:mercenary}{and}{ifPayGold:5}{then}Mercenary: {randomOk}, {markRoom:mercenaryRoom}, {markItem:mercenary}"]]},{id:"enemyRoom",labels:["Target","Murdered"],atPercentage:99,roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsMarked:mercenaryRoom}{then}{randomCorpse}, {roomIsEmpty}, {stopReading}","{randomEnemyChallenge}"]],items:[{id:"enemy",level:2}]}]]},{probability:40,id:"[CODEX-Events] Malus - The Small Horn: It may bring bad luck in your future adventures...",minRooms:2,steps:[[{id:"roomA",labels:["Unlucky"],atPercentage:99,roomDescriptions:[["{ifEnterRoom}{and}{ifRoomIsNotMarked:roomA}{and}{ifKeyword:unluck}{then}{randomBadReward}, {loseKeyword:unluck}, {markRoom:roomA}","{ifEnterRoom}{and}{ifRoomIsNotMarked:roomA}{then}You found a small horn, {getKeyword:unluck}, {markRoom:roomA}"]]}]]},{id:"[CODEX-Events] Bonus - The Wildness (bad): Earn a debuff after fighting an enemy.",minRooms:1,steps:[{labels:["Scorpion","Tail"],intro:"A huge distracted scorpion is slowly swinging its tail.",action:"With one last swipe the tail stings you",effect:"{applyModifierOnRoomMarked:stunned.hero,biteRoom}"},{labels:["Light","Floater"],intro:"A ball of light floats slowly around the room, illuminating its walls.",action:"It explodes with a dazzling light",effect:"{applyModifierOnRoomMarked:blind.hero,biteRoom}"},{labels:["Bat","Hanging"],intro:"A giant bat wrapped in its own wings hangs silently from the ceiling.",action:"It has been an horrific battle",effect:"{applyModifierOnRoomMarked:scared.hero,biteRoom}"},{labels:["Coil","Snake"],intro:"A huge coiled snake is staring at you hissing.",action:"The dying snake bites you",effect:"{applyModifierOnRoomMarked:crippled.hero,biteRoom}"}].map((e=>[{id:"biteRoom",labels:e.labels,atPercentage:99,globalModifier:e.effect,roomDescriptions:[[e.intro,"{ifKilledLastFoe}{then}"+e.action+", {markRoom:biteRoom}"]],items:[{id:"enemy",level:1,ignoreXp:!0}]}]))}],f=[{id:"[CODEX-Events] Filler (easy) - The Weak: One level 0 enemy.",steps:[[{id:"spawn",atPercentage:1,roomDescriptions:[['"Hey, the {heroClass} is here! Help!"'],['"Oh... no!"'],['"S... step away!"'],['"Argh!"']],items:[{id:"enemy",level:0}]}]]},{id:"[CODEX-Events] Filler (easy) - The Pair: Two level 0 enemies.",steps:[[{id:"spawn",atPercentage:1,roomDescriptions:[['"Y...you shall not pass!"'],['"You\'re outnumbered! Surrender now!"'],['"Let\'s kill! The boss will give us a promotion!"'],['"Finally some training!"']],items:[{id:"enemy",level:0},{id:"enemy",level:0}]}]]},{id:"[CODEX-Events] Filler (easy) - The One (1): One level 1 enemy.",ignoreForHeroTags:["weak"],steps:[[{id:"spawn",atPercentage:1,roomDescriptions:[['"Hey you! Stop there!"'],['"I\'ll avenge my brothers!"'],['"Give me all your money!"'],['"Yikes!"']],items:[{id:"enemy",level:1}]}]]},{id:"[CODEX-Events] Filler (easy) - The One (2): One level 1 enemy.",ignoreForHeroTags:["weak"],steps:[[{id:"spawn",atPercentage:1,roomDescriptions:[['"Don\'t move a muscle, {heroClass}!"'],['"Damn {heroClass}! You killed my sister!"'],['"Hey, {heroClass}! I recognize you!"'],['"Hands up, {heroClass}!"']],items:[{id:"enemy",level:1}]}]]}],g=[{id:"[CODEX-Events] Filler (medium) - The Swarm: Three level 0 enemy.",steps:[[{id:"spawn",atPercentage:50,roomDescriptions:[['"We want your items! We want your life!"'],['"What do you want? What do you want?"'],['"Tee-hee! We are going to kill you!"']],items:[{id:"enemy",level:0},{id:"enemy",level:0},{id:"enemy",level:0}]}]]},{id:"[CODEX-Events] Filler (medium) - The Pair: Two level 1 enemies.",steps:[[{id:"spawn",atPercentage:50,roomDescriptions:[['"Any last word, fool?"'],['"It\'s time to die, thief!"'],['"This may be a challenge for us! Let\'s do our best!"']],items:[{id:"enemy",level:1},{id:"enemy",level:1}]}]]},{id:"[CODEX-Events] Filler (medium) - The One (1): One level 2 enemy.",ignoreForHeroTags:["weak"],steps:[[{id:"spawn",atPercentage:50,roomDescriptions:[['"Your quest ends here!"'],['"Raaawwwrrr!"'],['"Come here, wimp!"']],items:[{id:"enemy",level:2}]}]]},{id:"[CODEX-Events] Filler (medium) - The One (2): One level 2 enemy.",ignoreForHeroTags:["weak"],steps:[[{id:"spawn",atPercentage:50,roomDescriptions:[['"I\'m sorry for you, {heroClass}!"'],['"I\'ll mince you up, {heroClass}!"'],['"Say goodbye, {heroClass}!"']],items:[{id:"enemy",level:2}]}]]}],y=[{id:"[CODEX-Events] Filler (medium) - The One: One level 2 enemy.",onlyForHeroTags:["weak"],steps:[[{id:"spawn",atPercentage:99,roomDescriptions:[['"I\'m sorry for you, {heroClass}!"'],['"I\'ll mince you up, {heroClass}!"'],['"Say goodbye, {heroClass}!"']],items:[{id:"enemy",level:2}]}]]},{id:"[CODEX-Events] Filler (hard) - The Weak Pair: Two level 1 enemies.",steps:[[{id:"spawn",atPercentage:99,roomDescriptions:[['"See you in hell, {heroClass}!"'],['"Farewell, {heroClass}!"'],['"End of the line, {heroClass}!"']],items:[{id:"enemy",level:1},{id:"enemy",level:1}]}]]},{id:"[CODEX-Events] Filler (hard) - The Strong Pair: Two level 2 enemies.",steps:[[{id:"spawn",atPercentage:99,roomDescriptions:[['"Let\'s get it on, guys!"'],['"Let\'s tear it up!"'],['"I want that head on a pike!"']],items:[{id:"enemy",level:2},{id:"enemy",level:2}]}]]}],a=[{id:"[CODEX-Events] Filler (very hard) - The One: One Level 4 enemy.",steps:[[{id:"spawn",isOptionalRoom:!0,atPercentage:{from:1,to:99},roomDescriptions:[['"Your bones taste good. Give me bones."'],['"You woke me up from my sleep. Now you will die."'],['"You should be my lunch. Come closer!"']],items:[{id:"enemy",level:3,ignoreXp:!0}]}]]},{id:"[CODEX-Events] Filler (very hard) - The Deadly Sip: Gain all your health... or die.",steps:[[{id:"room",labels:["Bottle"],isOptionalRoom:!0,atPercentage:{from:1,to:99},items:[{genericItem:"glass"}],roomDescriptions:[["There is a bottle with a black liquid in a glass display case.",'{ifMoveOn:glass}{and}"Let\'s end this"{then}{markItem:glass}, {rollDie}{range:1-3} {killHero}, {range:4-6} {gainFullHp}']]}]]},{id:"[CODEX-Events] Filler (very hard) - The Critters: Five level 0 enemy.",steps:[[{id:"spawn",labels:["Crowded"],isOptionalRoom:!0,atPercentage:{from:1,to:99},roomDescriptions:[['"Meat! Meat! Meat!"'],["\"It's mine! It's mine! It's mine!\""],['"Yummy!"']],items:[{id:"enemy",level:0,ignoreXp:!0},{id:"enemy",level:0,ignoreXp:!0},{id:"enemy",level:0,ignoreXp:!0},{id:"enemy",level:0,ignoreXp:!0},{id:"enemy",level:0,ignoreXp:!0}]}]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]},{steps:[[]]}],u=function(e){let o=["Beginning","Stairs","Enter","Exit"],t=[];return[{id:"[CODEX-Events] Main quest - The Missing Key: Find the key and beat the boss.",minRooms:4,adventureTitle:["The Quest For The {villainName}","The {villainName}'s Hideout","The {villainName}'s Trap","The {villainName}'s Plan","The Dungeons Of The {villainName}","The {heroClass}'s Revenge","The {heroClass}'s Quest","The Lost {placeName}"],steps:[[{id:"keyRoom",labels:["Boss Key"],atPercentage:{from:50,to:90},items:[{genericItem:"bossKey"},{id:"enemy",level:1}],roomDescriptions:[["{ifMoveOn:bossKey}{then}You got the {bossKey}, {markRoom:keyRoom}, {markItem:bossKey}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:keyRoom}{then}{roomIsEmpty}, {stopReading}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[['"Please, hero! Kill the {villainName} and save the {placeName}!"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Boss Battle: Beat the boss.",minRooms:1,adventureTitle:["The End Of The {villainName}","The {villainName}'s Bounty","The {villainName}'s Den","The {villainName}'s Revenge","The Battle Of The {villainName}","To The Rescue Of The {goodGuyName}","The {heroClass}'s Final Battle","The {villainName} &amp; The {goodGuyName}","The {goodGuyName} &amp; The {villainName}","The Cursed {placeName}","The {villainName}'s {placeName}"],steps:[[{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[['"The {goodGuyName} will die... and so will you!", {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}']]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[['"Please, hero! You\'re the only one that can stop the {villainName}!"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Gang: Beat a sequence of enemies.",minRooms:3,adventureTitle:["The {placeName}'s {villainName} Gang","The {goodGuyName} Deception","The {heroClass}'s Expedition","The {placeName} Liberation","The {villainName} Trail","The Reclaimed {placeName}","The {heroClass}'s Harvest"],steps:[[{id:"enemy1room",labels:["1st Encounter","One"],atPercentage:{from:20,to:90},items:[{id:"enemy",level:0}],roomDescriptions:[['"We will stop you at any cost!"','{ifKilledLastFoe}{then}"I\'ve to warn... the {villainName}", {markRoom:enemy1room}']]},{id:"enemy2room",labels:["2nd Encounter","Two"],atPercentage:100,items:[{id:"enemy",level:1}],roomDescriptions:[["{ifRoomIsNotMarked:enemy1room}{then}You feel watched, {roomIsEmpty}, {stopReading}",'{ifKilledLastFoe}{then}"Wrong move, bwahahah!", {markRoom:enemy2room}']]},{id:"bossRoom",labels:["3rd Encounter","Three"],atPercentage:{from:20,to:90},items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:enemy2room}{then}{roomIsEmpty}, {stopReading}",'"You\'re wasting time. The {placeName} is mine!", {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}']]}]],otherDescriptions:[{at:"startingRoom",labes:o,roomDescriptions:[['"Sir, we\'ve to stop the {villainName} forces!"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Spell: Break the spell and kill the bad guy.",minRooms:4,adventureTitle:["The {villainName} Deception","The {heroClass}'s Dilemma","The {placeName} Ritual","The Cursed {placeName}","The {goodGuyName}'s Murderer","The {goodGuyName} Slayer","The {heroClass}'s Murder","The {goodGuyName} Versus the {heroClass}","The {villainName}'s Ritual"],steps:[[{id:"spellRoom",labels:["Ritual"],atPercentage:55,items:[{id:"enemy",level:1}],roomDescriptions:[["A sorcerer is holding a ritual.","{ifNoFoes}{then}{hide}The ritual has been interrupted, {markRoom:spellRoom}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["\"I'm the {goodGuyName}. Can't control... Help, {heroClass}!\", {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{ifRoomIsMarked:spellRoom}{then}You did it!{hide}{stopReading}","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}You did it!{hide}but sacrified the {goodGuyName}'s life."]]}]},{id:"[CODEX-Events] Main quest - The Broken Key: Collect the key parts and beat the boss.",minRooms:4,adventureTitle:["The {bossKey} Hunt","The Shattered {bossKey}","The {bossKey}","The {bossKey} Of The {placeName}","The {villainName}'s {bossKey}","The Shattered {villainName}","The Quest For The {bossKey}","The {heroClass}'s {bossKey}"],steps:[[{id:"keyRoom1",labels:["Near Part"],atPercentage:1,items:[{genericItem:"bossKey"}],roomDescriptions:[["{ifMoveOn:bossKey}{then}You got a {bossKey} part, {markRoom:keyRoom1}, {markItem:bossKey}"]]},{id:"keyRoom2",labels:["Middle Part"],atPercentage:25,items:[{genericItem:"bossKey"},{id:"enemy",level:0}],roomDescriptions:[["{ifMoveOn:bossKey}{then}You got a {bossKey} part, {markRoom:keyRoom2}, {markItem:bossKey}"]]},{id:"keyRoom3",labels:["Far Part"],atPercentage:60,items:[{genericItem:"bossKey"},{id:"enemy",level:1}],roomDescriptions:[["{ifMoveOn:bossKey}{then}You got a {bossKey} part, {markRoom:keyRoom3}, {markItem:bossKey}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:keyRoom1}{or}{ifRoomIsNotMarked:keyRoom2}{or}{ifRoomIsNotMarked:keyRoom3}{then}{roomIsEmpty}, {stopReading}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[['"Please, hero! Kill the {villainName} and save the {placeName}!"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Lost Item: Return an item to NPC and unlock the boss and fight.",minRooms:4,adventureTitle:["The Lost {documentName}","The {documentName}","The {explorerName}","The Missing {explorerName}","The {placeName} Mystery"],steps:[[{id:"npcRoom",labels:["Explorer"],atPercentage:10,items:[{genericItem:"npc"}],roomDescriptions:[["{ifMoveOn:npc}{then}{explorerName}: 'I'm looking for the lost {documentName}! Please, help!'","{ifMoveOn:npc}{and}{ifRoomIsMarked:itemRoom}{then}{hide}'Oh, no! It says the {villainName} is hiding here!', {markRoom:npcRoom}"]]},{id:"itemRoom",labels:["Lost","Found"],atPercentage:{from:60,to:90},items:[{genericItem:"item"},{id:"enemy",level:1}],roomDescriptions:[["{ifMoveOn:item}{and}{ifRoomIsNotMarked:itemRoom}{then}You've found the {documentName}, {markRoom:itemRoom}, {markItem:item}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:npcRoom}{then}{roomIsEmpty}, {stopReading}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[['"The {explorerName} disappeared days ago. We\'re worried..."',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Kidnapping: Fight the boss, free the kidnapped, and return it.",minRooms:3,adventureTitle:["The Kidnapped {goodGuyRelativeName}","The {goodGuyName}'s {goodGuyRelativeName}","The Broken {goodGuyName}","The {goodGuyName}'s Tears","The Imprisoned {goodGuyRelativeName}","The {heroClass}'s Rescue"],steps:[[{id:"goodguyroom",labels:["{goodGuyName}"],atPercentage:{from:20,to:30},items:[{genericItem:"goodguy"}],roomDescriptions:[["{ifMoveOn:goodguy}{then}{goodGuyName}: {randomSaveRelativeRequest}","{ifMoveOn:goodguy}{and}{ifRoomIsMarked:goodguyroom}{then}{goodGuyName}: {randomThankYou}, {markRoom:startingRoom}, {markItem:goodguy}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{randomBossRevenge}, {noEscape}","{ifNoFoes}{then}{hide}You rescued the {goodGuyName}'s {goodGuyRelativeName}, {markRoom:goodguyroom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[['"The {goodGuyName} ran to the {placeName} alone... Why?"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Escort: Escort the good guy near the boss and fight.",minRooms:4,adventureTitle:["The {goodGuyName}'s Escort","The Running {goodGuyName}","The Escort {heroClass}","The {villainName} Traces","The {villainName} Hunt","The Chasing {goodGuyName}","The Wanted {villainName}","The {goodGuyName} Run"],steps:[[{id:"step1",labels:["1st Spot"],atPercentage:20,items:[{genericItem:"goodguy"},{id:"enemy",level:0}],roomDescriptions:[["{ifEnterRoom}{and}{ifGoldSpentInFifth:2-5}{then}{markItem:goodguy}, {randomGoodGuyLost}","{ifMoveOn:goodguy}{then}{goodGuyName}: {randomGoodGuyLongFollowMe}, {markItem:goodguy}, {markRoom:step1}"]]},{id:"step2",labels:["2nd Spot"],atPercentage:40,items:[{genericItem:"goodguy"},{id:"enemy",level:1}],roomDescriptions:[["{ifEnterRoom}{and}{ifGoldSpentInFifth:4-5}{then}{markItem:goodguy}, {randomGoodGuyLost}","{ifMoveOn:goodguy}{and}{ifRoomIsMarked:step1}{and}{ifGoldSpentInFifth:2-3}{then}{randomFollowMe}, {markItem:goodguy}, {markRoom:step2}"]]},{id:"step3",labels:["3rd Spot","Last Spot"],atPercentage:60,items:[{genericItem:"goodguy"}],roomDescriptions:[["{ifEnterRoom}{and}{ifGoldSpentInFifth:4-5}{then}You hear noises coming from nearby, {markRoom:bossRoom}","{ifMoveOn:goodguy}{and}{ifRoomIsMarked:step2}{and}{ifGoldSpentInFifth:4-5}{then}{randomVillainFound}, {markRoom:step3}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:bossRoom}{then}{roomIsEmpty}, {stopReading}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{ifRoomIsNotMarked:step3}{then}{hide}but the {goodGuyName} is lost in the {placeName}."]]}]},{id:"[CODEX-Events] Main quest - The Moral Compass: Do good or bad things and trigger a different ending.",minRooms:4,adventureTitle:["The End Of The {goodGuyName}","The {heroClass}'s Destiny","The {heroClass}'s Last Quest","The {goodGuyName}'s Last Words","The {heroClass}'s Destiny","The {heroClass}'s Resolve","The Dying {goodGuyName}","The {heroClass}'s Heart","The Last {heroClass}","The Last {goodGuyName}"],steps:[[{id:"step1",labels:["Slave","Slavery","Saving"],atPercentage:20,items:[{genericItem:"slaver"},{id:"enemy",level:0}],roomDescriptions:[["{ifEnterRoom}{and}{ifPayGold:3}{then}Slaver: {randomSlaverBuy}, {markItem:slaver}, {markRoom:step1}","{ifEnterRoom}{and}{ifRoomIsMarked:step1}{then}{roomIsEmpty}"]]},{id:"step2",labels:["Mob","Mobbing"],atPercentage:40,items:[{genericItem:"mobster"},{id:"enemy",level:1}],roomDescriptions:[["{ifEnterRoom}{and}{ifPayGold:3}{then}Mobster: {randomMobsterPay}, {markItem:mobster}, {markRoom:step2}","{ifEnterRoom}{and}{ifRoomIsMarked:step2}{then}{roomIsEmpty}, {markItem:mobster}"]]},{id:"step3",labels:["Dead","Goodbye"],atPercentage:80,items:[{genericItem:"goodguy"}],roomDescriptions:[['{ifMoveOn:goodguy}{and}{ifPayHp:2}{and}"Live!"{then}{goodGuyName}: {randomGoodDying}, {markItem:goodguy}, {markRoom:bossRoom}','{ifMoveOn:goodguy}{and}{ifPayXp:2}{and}"..."{then}{goodGuyName}: {randomBadDying}, {markItem:goodguy}, {markRoom:step3}']]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}","{ifNoFoes}{and}{ifRoomIsNotMarked:step1}{and}{ifRoomIsMarked:step2}{and}{ifRoomIsMarked:step3}{then}{hide}You sit on the {villainName} throne. End."]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{ifRoomIsMarked:step1}{and}{ifRoomIsNotMarked:step2}{and}{ifRoomIsMarked:bossRoom}{hide}You sit on the Stampadia thorne.","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Twins: Fight a 2-stages boss.",minRooms:4,adventureTitle:["The {villainName} Twins","The {villainName}'s Final Form","The {villainName} Double","The {heroClass}'s Endurance","The {villainName}'s Trick","The {villainName}'s Transformation"],steps:[[{id:"bossRoom1",labels:[],atPercentage:99,items:[{id:"enemy",level:1},{id:"enemy",level:1}],isExclusive:!0,roomDescriptions:[["{randomTwinBossEntrance}, {noEscape}","{ifNoFoes}{then}{hide}{randomFinalFormAnnounce}, {markRoom:bossRoom}, {teleportToRoom:bossRoom}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:bossRoom}{then}{roomIsEmpty}, {stopReading}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:t,roomDescriptions:[['"The {villainName} Twins are keeping the {placeName} on their knees!"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Suicide Mission: Fight 2 bosses at once, or...",minRooms:4,adventureTitle:["The {villainName} Victory","The {epicWeapon} {epicWeaponPart}","The {epicWeaponPart}","The Lost {epicWeaponPart}","The {epicWeapon} Forge","The {heroClass} Despair","The {heroClass} Defeat","The {epicWeapon}"],steps:[[{id:"part1",labels:["Far part"],atPercentage:{from:99,to:50},items:[{id:"enemy",level:2}],roomDescriptions:[["{ifKilledLastFoe}{and}{ifRoomIsNotMarked:part1}{then}You found a {epicWeapon} {epicWeaponPart}, {markRoom:part1}"]]},{id:"part2",labels:["Near part"],atPercentage:{from:30,to:49},items:[{id:"enemy",level:1},{genericItem:"part"}],roomDescriptions:[["{ifMoveOn:part}{then}You found a {epicWeapon} {epicWeaponPart}, {markItem:part}, {markRoom:part2}"]]},{id:"forge",labels:["Forging","Hammering"],atPercentage:{from:1,to:99},equipment:[{id:"epicWeapon"}],items:[{genericItem:"blacksmith"}],roomDescriptions:[["A blacksmith is working tirelessly on a sword.",'{ifRoomIsMarked:part1}{and}{ifRoomIsMarked:part2}{then}"Done! It\'s my masterpiece!"{hide}{getEquip:equip-epicWeapon}, {markItem:blacksmith}']]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0},{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{randomFear}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["\"You'll never get out alive! {heroClass}! Please, don't go!\"","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Great Old Ones: Beat the boss before being corrupted by madness.",minRooms:4,adventureTitle:["The {heroClass}'s Madness","The {heroClass} Mind","The {placeName} Gods","The {heroClass}'s Insanity","The Madness Of A {heroClass}","The Depths Of The {placeName}","The {placeName}'s Book","The Insane {heroClass}"],steps:[[{id:"bookRoom",labels:["Book","Pages"],atPercentage:1,equipment:[{id:"book"}],items:[{genericItem:"book"}],roomDescriptions:[['{ifMoveOn:book}{then}You read: "{randomBookQuote}", {getEquip:equip-book}, {markRoom:bookRoom}, {markItem:book}']]},{id:"enlightenment",labels:["Enlightenment"],atPercentage:80,items:[{id:"enemy",level:1}],roomDescriptions:[["{ifRoomIsMarked:bookRoom}{and}{ifRoomIsNotMarked:enlightenment}{then}Now you know the Truth, {gainHp:1}, {markRoom:enlightenment}"]]},{id:"abyss",labels:["Abyss","Call","Calling"],atPercentage:99,items:[{id:"enemy",level:1}],roomDescriptions:[["{ifRoomIsNotMarked:bookRoom}{then}You hear something calling, {roomIsEmpty}, {stopReading}","{ifNoFoes}{then}{teleportToRoom:bossRoom}"]]},{id:"bossRoom",labels:t,isHiddenRoom:!0,atPercentage:{from:1,to:99},items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifEveryBattleRoundStarts}{then}{rollDie}{range:1-1} {loseXp:2}, {range:2-5} {nothing}, {range:6-6} {gainHp:1}",'{ifNoFoes}{then}"Your mind is still mine", {markRoom:startingRoom}, {teleportToRoom:abyss}']]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["As soon as you arrive to the {placeName} your head feels heavier.","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Necromancer: Someone is trying to bring the evil back.",minRooms:4,adventureTitle:["The Resurrection Of The {villainName}","The Mad {madScientistName}","The {madScientistName}'s {villainName}","The Return Of The {villainName}","The Undead {villainName}","The {madScientistName} Last Experiment","The {madScientistName} Experiment"],steps:[[{id:"necromancer",labels:["Resurrection","Mad"],atPercentage:98,items:[{id:"enemy",level:2}],roomDescriptions:[["{ifKilledLastFoe}{then}{madScientistName}: {randomResurrection}, {markRoom:bossRoom}"]]},{id:"bossRoom",labels:t,atPercentage:99,items:[{id:"enemy",level:4,ignoreXp:!0},{id:"enemy",level:4,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:bossRoom}{then}{roomIsEmpty}, {stopReading}","{randomZombieEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:t,roomDescriptions:[["The {madScientistName} is trying to bring the {villainName} back!","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Enchantment: Find an NPC lost in the dungeons to make your final battle easier.",minRooms:4,adventureTitle:["The {heroClass}'s Trinket","The {placeName} Treasure","The {heroClass}'s Weapon","The Weakness Of The {villainName}","The {heroClass} Last Hope","The {placeName}'s Gift","The {goodGuyName}'s Gift"],steps:[{trinket:"Pendant",effect:"{applyModifierOnRoomMarked:scared.enemy,npcRoom}"},{trinket:"Boots",effect:"{applyModifierOnRoomMarked:crippled.enemy,npcRoom}"},{trinket:"Diamond",effect:"{applyModifierOnRoomMarked:blind.enemy,npcRoom}"},{trinket:"Necklace",effect:"{applyModifierOnRoomMarked:stunned.enemy,npcRoom}"},{trinket:"Shawl",effect:"{applyModifierOnRoomNotMarked:crippled.hero,npcRoom}"},{trinket:"Belt",effect:"{applyModifierOnRoomNotMarked:scared.hero,npcRoom}"},{trinket:"Goggles",effect:"{applyModifierOnRoomNotMarked:blind.hero,npcRoom}"},{trinket:"Helmet",effect:"{applyModifierOnRoomNotMarked:stunned.hero,npcRoom}"}].map((e=>[{id:"npcRoom",labels:["Rescue","Enchantment"],atPercentage:{from:60,to:90},items:[{genericItem:"npc"},{id:"enemy",level:2}],roomDescriptions:[['{ifKilledLastFoe}{then}{goodGuyName}: "You saved me! Take this '+e.trinket+'!", {markRoom:npcRoom}, {markItem:npc}']]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[[e.effect,"{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}])),otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[['"They said that the {villainName} have mystical powers. Let\'s check this out!"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Missing Familiar: Find the familiar to get your missing skill back and kill the boss.",minRooms:4,adventureTitle:["The Lost {familiarName}","The Vengeful {heroClass}","The {villainName}'s {familiarName}","The Trapped {familiarName}","The Lost Power Of The {heroClass}","The {heroClass}'s {familiarName}","The {familiarName}"],steps:[[{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[['{ifRoomIsNotMarked:familiarRoom}{then}"It\'s too late for your little friend, {heroClass}!", {markRoom:familiarRoom}, {markRoom:bossRoom}','"What a stupid reason to risk your life, {heroClass}!", {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}']]},{id:"familiarRoom",labels:["Familiar","Found","Friend"],atPercentage:99,stealHeroSkill:"losable",items:[{genericItem:"familiar"},{id:"enemy",level:2}],roomDescriptions:[["{ifNoFoes}{and}{ifRoomIsNotMarked:familiarRoom}{then}You saved your {familiarName}!","{ifNoFoes}{and}{ifRoomIsNotMarked:familiarRoom}{then}{regainSkill}, {markRoom:familiarRoom}, {markItem:familiar}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}The {villainName} paid for kidnapping your familiar.","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{ifRoomIsMarked:bossRoom}{then}{hide}But your beloved familiar is lost forever."]]}]},{id:"[CODEX-Events] Main quest - The Test: Beat the boss and get a better ending if you don't use your class item.",minRooms:4,adventureTitle:["The {heroClass}'s Bet","The {heroClass}'s Challenge","The {heroClass}'s {nameEquip:equip-heroItem}","The {nameEquip:equip-heroItem} Challenge","The {nameEquip:equip-heroItem} Trial","The {heroClass} Trial","The {heroClass} And The {nameEquip:equip-heroItem}"],steps:[[{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}You proved to be the best {heroClass}...","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{payEquip:equip-heroItem}{then}{hide}...of the world!, {gainGold:5}"]]}]},{id:"[CODEX-Events] Main quest - The Curse: Beat the boss and try to get rid of your curse.",minRooms:4,adventureTitle:["The Curse Of The {villainName}","The Cursed {heroClass}","The {heroClass}'s Curse","The {heroClass}'s Last Day","The {heroClass}'s Burden","The {heroClass}'s Sickness","The {villainName}'s Gift","The {villainName}'s Reward","The {villainName}'s Last Day"],steps:[[{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,equipment:[{id:"curse",isAvailable:!0}],roomDescriptions:[["{ifRoomIsNotMarked:bossRoom}{then}{randomCurseJoke}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labels:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}You made the {villainName} pay for it","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{ifRoomIsNotMarked:bossRoom}{then}{hide}{randomCursedEnding}"]]}]},{id:"[CODEX-Events] Main quest - The War: Conquer the dungeon and beat the leader.",minRooms:4,adventureTitle:["The Conquered {placeName}","The {placeName} Conflict","The Battle Of The {heroClass}","The {villainName}'s Generals","The Conquering {villainName}","The {heroClass}'s War","The Battle Of The {placeName}","The War Of The {placeName}"],steps:[[{id:"general1room",labels:["Weak General","1st Camp"],atPercentage:{from:30,to:50},items:[{id:"enemy",level:0}],roomDescriptions:[['{ifKilledLastFoe}{then}General: "Forgive me, {villainName}!", {markRoom:general1room}']]},{id:"general2room",labels:["Brave General","2nd Camp"],atPercentage:{from:50,to:70},items:[{id:"enemy",level:1}],roomDescriptions:[['{ifKilledLastFoe}{then}General: "Ugh... Hold on, {villainName} generals!", {markRoom:general2room}']]},{id:"general3room",labels:["Strong General","Third Camp"],atPercentage:{from:70,to:90},items:[{id:"enemy",level:2}],roomDescriptions:[['"We will stop you at any cost!"','{ifKilledLastFoe}{then}General: "Argh! You can\'t beat us all, {heroClass}!", {markRoom:general3room}']]},{id:"bossRoom",labels:t,atPercentage:{from:1,to:99},items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,isDeadEndRoom:!0,roomDescriptions:[['{ifRoomIsNotMarked:general1room}{or}{ifRoomIsNotMarked:general2room}{or}{ifRoomIsNotMarked:general3room}{then}"I see my generals are holding on! Very well!"','"You will never take the {placeName} back!", {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}']]}]],otherDescriptions:[{at:"startingRoom",labes:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}The {villainName} leader has been defeated","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{ifRoomIsMarked:general1room}{and}{ifRoomIsMarked:general2room}{and}{ifRoomIsMarked:general3room}{then}{hide}...and the {placeName} is free again."]]}]},{id:"[CODEX-Events] Main quest - The Investigation: Investigate who the impostor may be and eliminate him.",minRooms:4,adventureTitle:["The {heroClass}'s Investigation","The {goodGuyName}'s Alibi","The {placeName} Case","The {heroClass}'s Interrogations","The {lowerSoldierName}'s Testimony","The {higherSoldierName}'s Testimony","The {lowerSoldierName} And The {higherSoldierName}","The {placeName}'s Culprit","The {villainName}'s Alibi","The {placeName}'s Murder"],generator:(e,o)=>{const t={isCulpritSelf:['"I\'m the culprit!"','"I\'m behind all this!"','"It was me, {heroClass}!"','"Come on, it was me!"'],isCulpritShort:['"The {name} did it!"','"The {name} is the culprit!"','"Punish the {name}!"'],isCulpritLong:['"The one to be punished is the {name}!"','"There is the {name} behind all this!"','"The {name} is the person you are looking for"','"I\'ve the name you want: the {name}"'],isInnocentSelf:['"I\'m innocent!"','"It\'s not my fault!"','"I\'m innocent, {heroClass}!"','"I\'m not the culprit!"'],isInnocentShort:['"The {name} is innocent!"','"It wasn\'t the {name}!"'],isInnocentLong:['"The {name} is not guilty!"','"The {name} is not at fault"','"The {name} is not your target"','"It couldn\'t have been the {name}"','"I\'d keep an eye on the {name}"'],isLyingShort:['"The {name} is lying!"','"The {name} is a liar!"','"Dont\' trust the {name}!"'],isLyingLong:['"The {name} is lying!"','"The {name} is a dirty liar!"','"Don\'t trust the {name}..."','"The {name} tells lies..."'],isTrueShort:['"The {name} is true!"','"The {name} is right!"'],isTrueLong:['"The {name} is telling the truth"','"The {name} is sincere"','"The {name} is not telling lies"'],goodEnding:["...and justice is served.","...and you did a great job.","...and the truth triumphed."],badEnding:["...but something feels wrong.","...or not?","...but have you made the right decision?"]};let i=[{mark:"{markRoom:goodGuyRoom}",check:["{ifRoomIsMarked:goodGuyRoom}","{ifRoomIsNotMarked:bossRoom}"]},{mark:"{markRoom:bossRoom}",check:["{ifRoomIsMarked:bossRoom}","{ifRoomIsNotMarked:goodGuyRoom}"]}],n=[{name:"{goodGuyName}",placeholder:"goodGuySentence",killId:"killGoodGuyId",length:"Short",isId:1},{name:"{villainName}",placeholder:"villainSentence",killId:"killVillainId",length:"Short",isId:0}],r=[n[0],n[1],{name:"{lowerSoldierName}",placeholder:"lowerSoldierSentence",length:"Long",isId:-1},{name:"{higherSoldierName}",placeholder:"higherSoldierSentence",length:"Long",isId:-1}];sentences=[],isTruth=e.random(1)>.5,e.shuffleArray(n),e.shuffleArray(r),e.shuffleArray(i),sentences.push({character:r[0],who:n[0],type:isTruth?"isCulprit":"isInnocent"});for(var a=0;a<r.length-2;a++)e.random(1)>.5?sentences.push({character:r[a+1],who:r[a],type:"isTrue"}):(isTruth=!isTruth,sentences.push({character:r[a+1],who:r[a],type:"isLying"}));sentences.push({character:r[a+1],who:r[a],type:isTruth?"isTrue":"isLying"}),sentences.forEach((i=>{o[i.character.placeholder]=e.getRandom(t[i.type+(i.who===i.character?"Self":i.character.length)]).replace(/{name}/g,i.who.name)})),n.forEach(((e,t)=>{o[e.killId]=i[t].mark})),e.random()>.5?(o.caseEndId=e.getRandom(i[0].check),o.caseEndText=e.getRandom(t.goodEnding)):(o.caseEndId=e.getRandom(i[1].check),o.caseEndText=e.getRandom(t.badEnding)),e.debug&&e.debug.logCase&&console.log("Case",{sentences:sentences,solution:n[0]})},steps:[[{id:"lowerSoldierRoom",labels:["Weak General","1st Spy"],atPercentage:{from:30,to:50},items:[{id:"enemy",level:0}],roomDescriptions:[["{ifKilledLastFoe}{then}{lowerSoldierName}:{hide}{lowerSoldierSentence}"]]},{id:"higherSoldierRoom",labels:["Brave General","2nd Spy"],atPercentage:{from:50,to:70},items:[{id:"enemy",level:1}],roomDescriptions:[["{ifKilledLastFoe}{then}{higherSoldierName}:{hide}{higherSoldierSentence}"]]},{id:"goodGuyRoom",labels:["Good"],atPercentage:{from:1,to:99},items:[{id:"enemy",level:3}],roomDescriptions:[['{ifRoomIsNotMarked:startingRoom}{and}"Speak!"{then}{goodGuyName}:{hide}{goodGuySentence}, {roomIsEmpty}',"{ifRoomIsMarked:startingRoom}{then}The {goodGuyName} is gone, {roomIsEmpty}{newRule}{ifKilledLastFoe}{then}{killGoodGuyId}, {markRoom:startingRoom}"]]},{id:"bossRoom",labels:t,atPercentage:{from:1,to:99},items:[{id:"enemy",level:3,ignoreXp:!0}],roomDescriptions:[['{ifRoomIsNotMarked:startingRoom}{and}"Speak!"{then}{villainName}:{hide}{villainSentence}, {roomIsEmpty}',"{ifRoomIsMarked:startingRoom}{then}The {villainName} is gone, {roomIsEmpty}{newRule}{ifKilledLastFoe}{then}{killVillainId}, {markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labes:o,roomDescriptions:[["{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}The culprit has been punished, the case is closed","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{and}{caseEndId}{then}{hide}{caseEndText}"]]}]},{id:"[CODEX-Events] Main quest - The Items: Find the items to explore more and fight the boss.",minRooms:4,adventureTitle:["The {questLastItem}","The Lost {questLastItem}","The {heroClass}'s {questLastItem}","The Elusive {villainName}","The Quest For The {questLastItem}","The Missing {questLastItem}"],generator:(e,o)=>{const t=[{item:["Grappling Hook","Leap Stone","Gravity Boots"],cantExplore:"There is a huge chasm in front of you",cantFightBoss:"The {villainName} stares at you over the chasm"},{item:["Boomerang","Knife"],cantExplore:"A rope is keeping a bridge closed",cantFightBoss:"The bridge to the {villainName} is held up by a rope"},{item:["Flute","Ocarina"],cantExplore:"There is a score drawn on a closed door",cantFightBoss:"The {villainName} is singing a creepy song"},{item:["Bomb","Hammer"],cantExplore:"A huge rock obstructs the passage",cantFightBoss:"The {villainName} is behind a sturdy stone door"},{item:["Flippers","Gills"],cantExplore:"A large body of water separates you from the shore",cantFightBoss:"The {villainName} is in the middle of a deep lake"}];e.shuffleArray(t),o.getItem1=e.getRandom(t[0].item),o.cantExploreRoom2=t[0].cantExplore,o.getItem2=e.getRandom(t[1].item),o.cantExploreRoom3=t[1].cantExplore,o.getItem3=e.getRandom(t[2].item),o.cantFightBoss=t[2].cantFightBoss,e.globalPlaceholders.questLastItem=o.getItem3},steps:[[{id:"itemRoom1",labels:["1st Item"],atPercentage:{from:1,to:99},items:[{id:"enemy",level:1}],roomDescriptions:[["{ifKilledLastFoe}{then}{randomGotItem} {getItem1}, {markRoom:itemRoom1}"]]},{id:"itemRoom2",labels:["2nd Item"],atPercentage:{from:1,to:99},items:[{id:"enemy",level:2}],roomDescriptions:[["{ifRoomIsNotMarked:itemRoom1}{then}{cantExploreRoom2}, {roomIsEmpty}","{ifKilledLastFoe}{then}{randomGotItem} {getItem2}, {markRoom:itemRoom2}"]]},{id:"itemRoom3",labels:["3rd Item"],atPercentage:{from:1,to:99},items:[{id:"enemy",level:3}],roomDescriptions:[["{ifRoomIsNotMarked:itemRoom2}{then}{cantExploreRoom3}, {roomIsEmpty}","{ifKilledLastFoe}{then}{randomGotItem} {getItem3}, {markRoom:itemRoom3}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifRoomIsNotMarked:itemRoom3}{then}{cantFightBoss}, {roomIsEmpty}","{randomBossEntrance}, {noEscape}{newRule}{ifNoFoes}{then}{markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labes:o,roomDescriptions:[['"You won\'t be able to reach the {villainName} with your gear, {heroClass}!"',"{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]},{id:"[CODEX-Events] Main quest - The Deadly Loop: Break the time loop and kill the boss.",minRooms:4,adventureTitle:["The Looping {heroClass}","The {placeName} Loop","The Looping {placeName}","The Tenacious {heroClass}","The Neverending {placeName}","The Immortal {heroClass}","The {placeName} Loop","The {heroClass} Lost In The Loop"],steps:[[{id:"loop1room",labels:["1st Cycle"],isDeadEndRoom:!0,atPercentage:{from:1,to:99},items:[{id:"enemy",level:0}],roomDescriptions:[['{ifNoFoes}{and}{ifNotKeyword:time}{then}"Try again!", {getKeyword:break}, {getKeyword:time}, {killHero}']]},{id:"loop2room",labels:["2nd Cycle"],atPercentage:100,items:[{id:"enemy",level:1}],roomDescriptions:[["{ifNoFoes}{and}{ifLoseKeyword:break}{then}{randomDefendLoop}, {getKeyword:loop}, {killHero}"]]},{id:"bossRoom",labels:t,atPercentage:100,items:[{id:"enemy",level:3,ignoreXp:!0}],isExclusive:!0,roomDescriptions:[["{ifNotKeyword:loop}{then}{roomIsEmpty}","{randomLoopBoss}, {noEscape}{newRule}{ifNoFoes}{then}{loseKeyword:time}, {loseKeyword:loop}, {markRoom:startingRoom}"]]}]],otherDescriptions:[{at:"startingRoom",labes:o,roomDescriptions:[["You came here to break a time loop... but you remember dying in here before.","{ifMoveOnStairs}{and}{ifRoomIsMarked:startingRoom}{then}{winningScene}"]]}]}]}(),k=[{id:"[CODEX-Events] Storyline - The End Of Stampadia: Discover how Stampadia ended.",steps:[[{id:"room",labels:["Sage","Machine","Creation"],atPercentage:99,isExclusive:!0,items:[{genericItem:"npc"}],roomDescriptions:[['{ifMoveOn:npc}{then}"We need machines, to help us create.", {getKeyword:computer}, {markItem:npc}']]}],[{id:"room",labels:["Sage","Energy","Growth"],atPercentage:99,isExclusive:!0,items:[{genericItem:"npc"}],roomDescriptions:[['{ifMoveOn:npc}{then}"We need energy, to help us grow.", {getKeyword:electricity}, {markItem:npc}']]}],[{id:"room",labels:["Sage","Wings","Flying"],atPercentage:99,isExclusive:!0,items:[{genericItem:"npc"}],roomDescriptions:[['{ifMoveOn:npc}{then}"We need wings, to help us fly.", {getKeyword:spaceship}, {markItem:npc}']]}],[{id:"room",labels:["Sage","Wings","Flying"],atPercentage:99,isExclusive:!0,items:[{genericItem:"npc"}],roomDescriptions:[['{ifMoveOn:npc}{then}"We need places, to help us share.", {getKeyword:city}, {markItem:npc}']]}],[{id:"room",labels:["Sage","Time","Pressing"],atPercentage:99,isExclusive:!0,items:[{genericItem:"npc"}],roomDescriptions:[["{ifMoveOn:npc}{and}{ifLoseKeyword:computer}{and}{ifLoseKeyword:electricity}{then}{getKeyword:press}",'{ifMoveOn:npc}{and}{ifKeyword:press}{then}"Time is pressing, {heroClass}.", {markItem:npc}']]}],[{id:"room",labels:["Sage","Trace","Path"],atPercentage:99,isExclusive:!0,items:[{genericItem:"npc"}],roomDescriptions:[["{ifMoveOn:npc}{and}{ifLoseKeyword:spaceship}{and}{ifLoseKeyword:city}{then}{getKeyword:ink}",'{ifMoveOn:npc}{and}{ifKeyword:ink}{then}"The path is traced, {heroClass}.", {markItem:npc}']]}],[{id:"room",labels:["Tearing","Scrap"],atPercentage:99,isExclusive:!0,items:[{genericItem:"press"}],roomDescriptions:[["There is a rusty printing press. There are glowing sheets of paper.","{ifMoveOn:press}{and}{ifLoseKeyword:ink}{and}{ifLoseKeyword:press}{then}{hide}{getKeyword:end}, Tear off this sheet"]]}]]}],R=[{id:"[CODEX-Events] Helper - The Insurance: Pay Gold/XP for HP.",steps:[[{id:"spawn",labels:["Insurance"],atPercentage:1,roomDescriptions:[['Agent: "Stampadia {placeName} Insurance Service. Welcome, {heroClass}!"','{ifMoveOn:npc}{and}{ifPayGold:4}{then}"Thank you!", {gainHp:1}']],items:[{genericItem:"npc"}]}]]},{id:"[CODEX-Events] Helper - The Junk Shop: Trade your class item for full health.",ignoreForHeroTags:["importantStartingItem"],steps:[[{id:"spawn",labels:["Junk"],atPercentage:1,roomDescriptions:[['Junk Shop Owner: "Do you have anything interesting to trade, {heroClass}?"','{ifMoveOn:npc}{and}{payEquip:equip-heroItem}{then}"Just what I needed!", {gainFullHp}, {markItem:npc}']],items:[{genericItem:"npc"}]}]]}],v=[{id:"[CODEX-Events] Anomaly - The Lost Privacy: A level 2 enemy in an optional room.",distance:"nearest",steps:[[{id:"spawn",atPercentage:{from:1,to:99},isOptionalRoom:!0,roomDescriptions:[['"I\'m getting ready! Go away!"'],['"I\'m preparing for you, {heroClass}!"'],['"Hey, go away!"']],items:[{id:"enemy",level:2,ignoreXp:!0}]}]]},{id:"[CODEX-Events] Anomaly - The Little Lost One: A level 0 enemy lost in the depth of the dungeon.",distance:"farthest",steps:[[{id:"spawn",atPercentage:99,roomDescriptions:[['"Hey! I lost my way! Please, stop!"'],['"Wh... where am I?"'],['"Why I\'m here!"']],items:[{id:"enemy",level:0}]}]]},{id:"[CODEX-Events] Anomaly - The Couple: 2 level 0 enemy in the depth of the dungeon.",distance:"farthest",steps:[[{id:"spawn",atPercentage:99,roomDescriptions:[['"My love... We have to defend ourselves!"'],['"Hey, stop talking! That {heroClass} is spying!"'],['"Hey! Are you that {heroClass} they are talking about?"']],items:[{id:"enemy",level:0},{id:"enemy",level:0}]}]]},{id:"[CODEX-Events] Anomaly - The One In Late: A level 1 enemy lost in the depth of the dungeon.",distance:"farthest",steps:[[{id:"spawn",atPercentage:99,roomDescriptions:[['"Hey! You\'re here too early!"'],['"Y... you woke me up, {heroClass}!"'],['"What time is it? Oww..."']],items:[{id:"enemy",level:1}]}]]}],b=[{id:"[CODEX-Events] Storyline - The Rests: Finds from the world of stampadia.",steps:[[{id:"room",atPercentage:{from:50,to:70},allowBusyRooms:!0,items:[{genericItem:"storylineRest"}],labels:["Rests"],roomDescriptions:[['{ifMoveOn:storylineRest}{then}Scroll: "That printing press is way too complex for me! - Carpenter"'],['{ifMoveOn:storylineRest}{then}Scroll: "I thought I already mapped this place... - Monk"'],['{ifMoveOn:storylineRest}{then}Scroll: "That printing press is a strong temptation - Sergio"'],['{ifMoveOn:storylineRest}{then}Scroll: "I wish I had a map... - Traveller"'],['{ifMoveOn:storylineRest}{then}Scroll: "See you at the edge of the dungeon, my love! - Enemy"'],['{ifMoveOn:storylineRest}{then}Scroll: "Tomorrow is my first day! I can do it! - Enemy"'],['{ifMoveOn:storylineRest}{then}Scroll: "I hope not to get bothered as yesterday... - Enemy"'],['{ifMoveOn:storylineRest}{then}Scroll: "Hey, me! Don\'t forget where to go this time! - Enemy"'],['{ifMoveOn:storylineRest}{then}There is a book titled: "Lucky Plants"'],['{ifMoveOn:storylineRest}{then}Scroll: "I wonder where my circus friends have gone... - Clown"'],['{ifMoveOn:storylineRest}{then}There is a book titled: "How To Grow Magic Trees"'],["{ifMoveOn:storylineRest}{then}There are a few schemes of a mirror-shaped teleporter."],['{ifMoveOn:storylineRest}{then}There is a book titled: "Dangerous Explosives"'],['{ifMoveOn:storylineRest}{then}There is a book titled: "Random Items And Where to Find Them"'],['{ifMoveOn:storylineRest}{then}Scroll: "God always gives one last chance to a Stampadian - Saint"'],['{ifMoveOn:storylineRest}{then}Scroll: "Heroes are coming! Time to rise the prices! - Shopkeeper"'],['{ifMoveOn:storylineRest}{then}There is a manual titled: "Teleports Are Fun!"'],['{ifMoveOn:storylineRest}{then}There is a book titled: "Stampadian Wildness"'],["{ifMoveOn:storylineRest}{then}This scroll is so chewed that's unreadable."],['{ifMoveOn:storylineRest}{then}There is a book titled: "Deadly Recipes"'],["{ifMoveOn:storylineRest}{then}On this scroll there is a drawing of a huge monster with four eyes."],['{ifMoveOn:storylineRest}{then}Scroll: "We should open a new branch here - Insurance Manager"'],['{ifMoveOn:storylineRest}{then}Scroll: "We Pay For Your Useless Stuff! - Junk Shop"'],['{ifMoveOn:storylineRest}{then}Scroll: "News: Stampadia Has A New Ruler"'],['{ifMoveOn:storylineRest}{then}Scroll: "News: Broken Key Found In Stampadia"'],['{ifMoveOn:storylineRest}{then}Scroll: "News: Evil Ritual Traces Found In Stampadia"'],['{ifMoveOn:storylineRest}{then}Scroll: "News: Still No Trace Of The Missing"'],['{ifMoveOn:storylineRest}{then}Letter: "I am looking for a companion for a dangerous mission."'],['{ifMoveOn:storylineRest}{then}Scroll: "News: The Gang Of Evil Is Back"'],["{ifMoveOn:storylineRest}{then}Scroll: \"We've to find him before it's too late...\""],["{ifMoveOn:storylineRest}{then}Scroll: \"We've to find her before it's too late...\""],['{ifMoveOn:storylineRest}{then}Scroll: "News: The Sacred Item Is Still Missing"'],['{ifMoveOn:storylineRest}{then}Letter: "Without my familiar... I\'m lost..."'],['{ifMoveOn:storylineRest}{then}Scroll: "News: Are The Old Gods Back From Their Long Sleep?"{hide}Yes We Are Back For You {heroClass}'],["{ifMoveOn:storylineRest}{then}There is a dungeon map with a boss key sign on it."],['{ifMoveOn:storylineRest}{then}There is a diary titled: "How I Became The Ruler Of Stampadia"'],["{ifMoveOn:storylineRest}{then}There is a necromancy book full of notes."],['{ifMoveOn:storylineRest}{then}Scroll: "News: Two Evil Colossus Found In Stampadia"'],['{ifMoveOn:storylineRest}{then}There is a book titled: "Becoming One"'],['{ifMoveOn:storylineRest}{then}Scroll: "News: The War Goes On"'],['{ifMoveOn:storylineRest}{then}Letter: "This curse is consuming me. I have to move."'],['{ifMoveOn:storylineRest}{then}Scroll: "Are you the best {heroClass}? Join the challenge! Win Gold!"'],['{ifMoveOn:storylineRest}{then}Letter: "Lie and your life will be spared - Enemy"'],['{ifMoveOn:storylineRest}{then}Letter: "In the loop you can\'t die. Please, come quickly."'],["{ifMoveOn:storylineRest}{then}On this scroll there is a list of items and some of them are dashed."],['{ifMoveOn:storylineRest}{then}Letter: "You won\'t get away that easily, {heroClass} - Enemy"'],['{ifMoveOn:storylineRest}{then}Scroll: "If a trap sends him back to the stairs, he\'ll go away! - Enemy"'],['{ifMoveOn:storylineRest}{then}Letter: "I found the target. It\'s time to finish the job."'],["{ifMoveOn:storylineRest}{then}There are some spare parts of a trap."],['{ifMoveOn:storylineRest}{then}There is a book titled: "Bad Luck"'],["{ifMoveOn:storylineRest}{then}There is a broken pressure plate."],['{ifMoveOn:storylineRest}{then}Scroll: "I\'m in my lab. Use the teleport for urgency only! - Enemy"'],["{ifMoveOn:storylineRest}{then}The sand of a broken hourglass is all over the places."],['{ifMoveOn:storylineRest}{then}Scroll: "I\'m waiting for you, {heroClass}! Hee hee... - Witch"'],["{ifMoveOn:storylineRest}{then}There is a small prayer book."],['{ifMoveOn:storylineRest}{then}Scroll: "Root Beer, Snacks, Water, Orange Juice, ... - Barman"'],["{ifMoveOn:storylineRest}{then}On this scroll there are two kids throwing Beastcrafters cards!"],['{ifMoveOn:storylineRest}{then}Scroll: "You\'ve to bet your life to win! - Bloody Gambler"'],['{ifMoveOn:storylineRest}{then}There is a book titled: "How To Fix A Teleport"'],['{ifMoveOn:storylineRest}{then}Scroll: "Why does only one fountain work at a time? - Enemy"'],['{ifMoveOn:storylineRest}{then}Scroll: "That chest is too intimidating... I\'m leaving! - Enemy"'],['{ifMoveOn:storylineRest}{then}Scroll: "You\'ve to bet your gold to win! - Gambler"'],['{ifMoveOn:storylineRest}{then}Scroll: "Just say: We are the Guardian Twins, we cannot let you pass."'],["{ifMoveOn:storylineRest}{then}There is a map with a small key in one corner."],['{ifMoveOn:storylineRest}{then}There is a stack of signs that say: "Room closed due to a landslide".'],["{ifMoveOn:storylineRest}{then}There is such a large spool of thread that it could join two far rooms!"],["{ifMoveOn:storylineRest}{then}A monk has lost his map of this place here."],['{ifMoveOn:storylineRest}{then}Scroll: "News: Another Murder Case In Stampadia"'],['{ifMoveOn:storylineRest}{then}Scroll: "Once The Nothing is opened, there is no way back..."'],["{ifMoveOn:storylineRest}{then}There are some scribbled shapes and numbers on this scroll."],['{ifMoveOn:storylineRest}{then}There is a book titled: "Hard Riddles For Smart Heroes"'],['{ifMoveOn:storylineRest}{then}Scroll: "That... monster... is eating the entire room!"'],['{ifMoveOn:storylineRest}{then}There is a book titled: "Good Training For Good Heroes"'],["{ifMoveOn:storylineRest}{then}Letter: \"I'm sick of this place... I'll leave soon. - Enemy\""],["{ifMoveOn:storylineRest}{then}There are two dice and dozens of annotated scrolls with grids."],['{ifMoveOn:storylineRest}{then}Scroll: "Fire and bolts, but nothing beats a good teleport - Wizard"'],['{ifMoveOn:storylineRest}{then}Scroll: "Remember to fill your healing flask - Warrior"'],['{ifMoveOn:storylineRest}{then}Scroll: "Keep your eyes on the enemy and learn from him - Ranger"'],['{ifMoveOn:storylineRest}{then}Scroll: "Hammer, leather, and mead makes a good day! - Dwarf"']]}]]}],t();var S},this.getWebFooter=function(){return E('Best on Firefox/Chrome &dash; <a class=mark href="index.html">{projectName}</a> v{version} &dash; &copy; {rangeYear} by KesieV &dash; Sources at <a class=mark href="https://{sourcesPage}">{sourcesPage}</a>',0)},this.generateAdventureDaily=function(e,o){e=e||0;const t=new Date,i=Math.floor((t.getTime()-6e4*t.getTimezoneOffset())/864e5)+e,r=this.generateAdventureById(i,o);return r.coreMetadata={filename:n.filePrefix+"-"+t.getFullYear()+"_"+(t.getMonth()+1)+"_"+t.getDate()},r},this.generateAdventureById=function(o,i){const n=Math.pow(10,10);o=o||Math.floor(Math.random()*n);let M=E("{projectName} v{version} - Page #{seed} - (c) {rangeYear} by KesieV - Manual &amp; adventures at {homepage} - Code at {sourcesPage}"+(i&&i.footer?" ["+i.footer+"]":""),o);const S=new t(e.root,20,20,o,i);return S.setSymbolsMap(i&&i.symbolsMap?i.symbolsMap:{items:{mark:"x",map:[0,1,2,3,4,5,6,7,8,9],roomsTable:["[0]","[1]","[2]","[3]","[4]","[5]","[6]","[7]","[8]","[9]"]},rooms:{label:"room ",symbol:"",markRoom:"x",notMarkRoom:"not x",unspacedLabel:"room"},equipment:{pay:"pay ",lose:"lose ",get:"get "},actions:{then:" &raquo; ",and:" &amp; ",newRule:" | ",or:" or ",move:"move",pay:"pay "}}),S.setRoomsModels([[{times:1,type:"startingRoom",width:3,height:3,isStarting:!0},{times:4,type:"largeRooms",width:4,height:4},{times:4,type:"midRooms",width:3,height:5},{times:4,type:"midRooms",width:5,height:3},{times:3,type:"corridors",width:[2,3,4],height:1,isCorridor:!0},{times:3,type:"corridors",width:1,height:[2,3,4],isCorridor:!0}],[{times:1,type:"startingRoom",width:3,height:3,isStarting:!0},{times:2,type:"largeRooms",width:4,height:4},{times:10,type:"midRooms",width:3,height:3},{times:3,type:"corridors",width:[2,3,4],height:1,isCorridor:!0},{times:3,type:"corridors",width:1,height:[2,3,4],isCorridor:!0}],[{times:1,type:"startingRoom",width:3,height:3,isStarting:!0},{times:1,type:"largeRooms",width:5,height:4},{times:1,type:"largeRooms",width:4,height:5},{times:5,type:"midRooms",width:2,height:3},{times:5,type:"midRooms",width:3,height:2},{times:3,type:"corridors",width:[2,3,4],height:1,isCorridor:!0},{times:3,type:"corridors",width:1,height:[2,3,4],isCorridor:!0}],[{times:1,type:"startingRoom",width:3,height:3,isStarting:!0},{times:1,type:"largeRooms",width:6,height:6},{times:6,type:"midRooms",width:4,height:2},{times:7,type:"midRooms",width:2,height:4},{times:2,type:"corridors",width:[2,3,4],height:1,isCorridor:!0},{times:2,type:"corridors",width:1,height:[2,3,4],isCorridor:!0}]]),S.setRoomPriorities([{startingRoom:100,largeRooms:100,midRooms:100,corridors:100},{startingRoom:50,largeRooms:150,midRooms:150,corridors:100},{startingRoom:50,largeRooms:100,midRooms:100,corridors:150},{startingRoom:100,largeRooms:150,midRooms:150,corridors:50},{startingRoom:150,largeRooms:50,midRooms:50,corridors:100},{startingRoom:200,largeRooms:50,midRooms:150,corridors:100}]),i&&null!=i.setMixMode?S.setMixMode(i.setMixMode):S.setMixMode(!1),S.setRoomIds(30),S.setGold(50),S.setQuestsStructure([{questType:"main",count:1,distance:"farthest"},{questType:"helpers",count:1,distance:"nearest"},{questType:"veryHardSub",count:1,distance:"farthest"},{questType:"sub",count:1,distance:"farthest"},{questType:"story",count:1,distance:"farthest"},{questType:"anomaly",count:1,probability:40},{questType:"easyFiller",count:2,distance:"nearest"},{questType:"hardFiller",count:1,distance:"farthest"},{questType:"bonus",count:1,distance:"farthest"},{questType:"malus",count:1,distance:"farthest"},{questType:"mediumFiller",count:1,distance:"farthest"},{questType:"sub",count:1,distance:"farthest"},{questType:"bonus",count:1,distance:"farthest"},{questType:"malus",count:1,distance:"farthest"},{questType:"sub",count:1,distance:"farthest"},{questType:"mediumFiller",count:1,distance:"random"},{questType:"scrolls",count:1,distance:"random"}]),S.setModifiers(w),S.setModifiersModel([[{atPercentage:25,modifierType:"bad"},{atPercentage:75,modifierType:"good"}],[{atPercentage:50,modifierType:"balanced"}],[{atPercentage:25,modifierType:"balanced"}],[{atPercentage:75,modifierType:"balanced"}],[{atPercentage:50,modifierType:"good"}],[{atPercentage:50,modifierType:"bad"}],[{atPercentage:50,modifierType:"balanced"},{atPercentage:75,modifierType:"good"}],[{atPercentage:50,modifierType:"bad"},{atPercentage:75,modifierType:"good"}]]),S.setShredderMode(!0),S.setComplexityEvaluation(!0),S.setPlaceholderModels(h),S.setRandomizers(s),S.setHeroModels(d),S.setEnemyModels(l),S.setFlavorTexts(m),S.setTruthMap(T),S.setEquipment(I),S.setKeywords(x),S.setQuests({main:u,sub:r,bonus:c,malus:p,easyFiller:f,mediumFiller:g,hardFiller:y,veryHardSub:a,story:k,helpers:R,anomaly:v,scrolls:b}),S.setFooter(M),S.setMapGuidesEvery(5),S}};return e.cache={"svg/model.svg":'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   xmlns:dc="http://purl.org/dc/elements/1.1/"\n   xmlns:cc="http://creativecommons.org/ns#"\n   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"\n   xmlns:svg="http://www.w3.org/2000/svg"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   width="297mm"\n   height="210mm"\n   viewBox="0 0 297 210"\n   version="1.1"\n   id="svg8"\n   inkscape:version="1.0.2 (e86c8708, 2021-01-15)"\n   sodipodi:docname="model.svg">\n  <defs\n     id="defs2" />\n  <sodipodi:namedview\n     id="base"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:pageopacity="0.0"\n     inkscape:pageshadow="2"\n     inkscape:zoom="1.1468411"\n     inkscape:cx="-117.04785"\n     inkscape:cy="82.655369"\n     inkscape:document-units="mm"\n     inkscape:current-layer="layer1"\n     inkscape:document-rotation="0"\n     showgrid="true"\n     inkscape:window-width="1440"\n     inkscape:window-height="772"\n     inkscape:window-x="0"\n     inkscape:window-y="25"\n     inkscape:window-maximized="1"\n     showguides="false" />\n  <metadata\n     id="metadata5">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about="">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />\n        <dc:title />\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <g\n     inkscape:groupmode="layer"\n     id="layer2"\n     inkscape:label="guides"\n     style="display:inline;opacity:0.357955"\n     sodipodi:insensitive="true">\n    <rect\n       style="fill:#000000;stroke:none;stroke-width:0.15;paint-order:stroke markers fill"\n       id="rect10089"\n       width="297"\n       height="210"\n       x="0"\n       y="0" />\n    <rect\n       style="fill:#00ffff;stroke:none;stroke-width:0.15;paint-order:stroke markers fill"\n       id="rect10080"\n       width="290.85001"\n       height="203.85001"\n       x="3.075"\n       y="3.075" />\n    <g\n       id="g36809"\n       transform="translate(-4.0930169)">\n      <rect\n         style="fill:#ff0000;stroke:none;stroke-width:0.15;paint-order:stroke markers fill"\n         id="rect10082"\n         width="6"\n         height="225.4411"\n         x="189.24521"\n         y="-15.162614" />\n    </g>\n    <rect\n       style="fill:#ff0000;fill-opacity:0.703833;stroke:none;stroke-width:0.15;paint-order:stroke markers fill"\n       id="rect16295"\n       width="204.11597"\n       height="5.9999995"\n       x="191.28198"\n       y="157.94814" />\n    <rect\n       style="fill:#ff0000;stroke:none;stroke-width:0.15;paint-order:stroke markers fill"\n       id="rect16361"\n       width="6"\n       height="51.139183"\n       x="240.70441"\n       y="158.82378" />\n    <rect\n       style="display:inline;opacity:0.357955;fill:#ff0000;stroke:none;stroke-width:0.15;paint-order:stroke markers fill"\n       id="rect10082-1"\n       width="6"\n       height="225.4411"\n       x="-25.694511"\n       y="-34.474594"\n       transform="rotate(-90)" />\n  </g>\n  <g\n     inkscape:label="stencils"\n     inkscape:groupmode="layer"\n     id="layer1"\n     style="display:inline">\n    <g\n       id="gridEnemy">\n      <rect\n         style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="rect1584"\n         width="0.88867116"\n         height="2.1515198"\n         x="15.014532"\n         y="30.961107" />\n      <rect\n         style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="rect1586"\n         width="0.88867116"\n         height="2.1515198"\n         x="19.551432"\n         y="30.961107" />\n      <circle\n         style="display:inline;fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="circle1296"\n         cx="17.727318"\n         cy="34.255596"\n         r="3.148931" />\n      <circle\n         style="display:inline;fill:#ffffff;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="gridEnemyLevel"\n         cx="17.727318"\n         cy="34.255596"\n         r="1.1845" />\n    </g>\n    <g\n       id="gridStairs">\n      <rect\n         style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="rect1324"\n         width="1.9500003"\n         height="5.8499999"\n         x="14.802318"\n         y="31.257818" />\n      <rect\n         style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="rect1326"\n         width="2.95"\n         height="3.9000001"\n         x="15.752556"\n         y="33.207817" />\n      <rect\n         style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="rect1328"\n         width="2.95"\n         height="1.95"\n         x="17.702557"\n         y="35.157818" />\n    </g>\n    <g\n       id="gridItem">\n      <rect\n         style="fill:#b3b3b3;stroke:none;stroke-width:0.25"\n         id="as"\n         width="4.75"\n         height="4.75"\n         x="15.352318"\n         y="31.807817" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;display:inline;fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="17.75433"\n         y="34.979176"\n         id="gridItemId"><tspan\n           sodipodi:role="line"\n           id="tspan16749-2"\n           x="17.75433"\n           y="34.979176"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#ffffff;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">99</tspan></text>\n    </g>\n    <g\n       id="enemyTier">\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="enemyBox"\n         width="10.717296"\n         height="10.694746"\n         x="247.26561"\n         y="177.15059" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="252.69142"\n         y="183.36035"\n         id="enemySkillUp"><tspan\n           sodipodi:role="line"\n           id="tspan16303"\n           x="252.69142"\n           y="183.36035"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">SKL1</tspan></text>\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="rect16307"\n         width="10.717296"\n         height="10.694746"\n         x="247.26561"\n         y="187.84534" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="252.65517"\n         y="194.0551"\n         id="enemySkillDown"><tspan\n           sodipodi:role="line"\n           id="tspan16309"\n           x="252.65517"\n           y="194.0551"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">SKL2</tspan></text>\n      <g\n         id="enemySymbol"\n         transform="translate(-3.6720677,0.52916667)">\n        <circle\n           style="display:inline;fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n           id="circle1631"\n           cx="256.2963"\n           cy="171.67905"\n           r="3.148931" />\n        <rect\n           style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n           id="rect1635"\n           width="0.88867116"\n           height="2.1515198"\n           x="253.58351"\n           y="168.38457" />\n        <rect\n           style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n           id="rect1637"\n           width="0.88867116"\n           height="2.1515198"\n           x="258.12042"\n           y="168.38457" />\n      </g>\n      <circle\n         style="fill:#ffffff;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n         id="enemyLevel"\n         cx="252.62422"\n         cy="172.13544"\n         r="1.1845" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="252.62047"\n         y="204.48405"\n         id="enemyXp"><tspan\n           sodipodi:role="line"\n           id="tspan16611-9"\n           x="252.62047"\n           y="204.48405"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">XP</tspan></text>\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="252.6024"\n         y="166.48622"\n         id="enemyDefense"><tspan\n           sodipodi:role="line"\n           id="tspan16619-8"\n           x="252.6024"\n           y="166.48622"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">DEF</tspan></text>\n      <g\n         id="enemyOutline"\n         transform="translate(-3.6720677,0.52916667)">\n        <path\n           id="xxx"\n           style="display:inline;fill:none;fill-opacity:1;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n           d="m 253.50928,168.38455 v 1.69551 a 3.1489311,3.1489311 0 0 0 -0.43615,1.59886 3.1489311,3.1489311 0 0 0 3.14917,3.14917 3.1489311,3.1489311 0 0 0 3.14864,-3.14917 3.1489311,3.1489311 0 0 0 -0.43615,-1.59886 v -1.69551 h -0.88831 v 0.72812 a 3.1489311,3.1489311 0 0 0 -1.82418,-0.58239 3.1489311,3.1489311 0 0 0 -1.82418,0.58188 v -0.72761 z" />\n        <text\n           xml:space="preserve"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.11667px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n           x="256.22321"\n           y="172.32175"\n           id="text1006"><tspan\n             sodipodi:role="line"\n             id="tspan1004"\n             x="256.22321"\n             y="172.32175"\n             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.11667px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">ALL</tspan></text>\n      </g>\n    </g>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="191.85017"\n       y="204.48405"\n       id="text16613"><tspan\n         sodipodi:role="line"\n         id="tspan16611"\n         x="191.85017"\n         y="204.48405"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">XP</tspan></text>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="191.38409"\n       y="173.06425"\n       id="text16617"><tspan\n         sodipodi:role="line"\n         id="tspan16615"\n         x="191.38409"\n         y="173.06425"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">HP</tspan></text>\n    <g\n       id="heroTier">\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="heroBox"\n         width="10.717296"\n         height="10.694746"\n         x="196.7915"\n         y="177.15059" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="202.2173"\n         y="183.36035"\n         id="heroSkillUp"><tspan\n           sodipodi:role="line"\n           id="tspan16193"\n           x="202.2173"\n           y="183.36035"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">SKL1</tspan></text>\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="rect16199"\n         width="10.717296"\n         height="10.694746"\n         x="196.7915"\n         y="187.84534" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="202.18105"\n         y="194.0551"\n         id="heroSkillDown"><tspan\n           sodipodi:role="line"\n           id="tspan16201"\n           x="202.18105"\n           y="194.0551"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">SKL2</tspan></text>\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="heroXp"\n         width="2.1188188"\n         height="2.118819"\n         x="201.09073"\n         y="202.49583" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="202.1283"\n         y="166.48622"\n         id="heroDefense"><tspan\n           sodipodi:role="line"\n           id="tspan16619"\n           x="202.1283"\n           y="166.48622"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">DEF</tspan></text>\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="heroHp"\n         width="2.1188188"\n         height="2.118819"\n         x="201.09073"\n         y="171.07603" />\n    </g>\n    <g\n       id="roomData">\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="rect7923"\n         width="12.036639"\n         height="8.1206894"\n         x="199.4924"\n         y="3.1931129" />\n      <g\n         id="roomStarting"\n         style="display:inline"\n         transform="translate(193.41174,-16.246608)">\n        <rect\n           style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n           id="rect1324-2"\n           width="1.9500003"\n           height="5.8499999"\n           x="10.018762"\n           y="20.575066" />\n        <rect\n           style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n           id="rect1326-1"\n           width="2.95"\n           height="3.9000001"\n           x="10.969"\n           y="22.525064" />\n        <rect\n           style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n           id="rect1328-6"\n           width="2.95"\n           height="1.95"\n           x="12.919"\n           y="24.475065" />\n      </g>\n      <rect\n         style="fill:#b3b3b3;fill-opacity:1;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke markers fill"\n         id="roomHeight"\n         width="8.202198"\n         height="8.1450014"\n         x="191.29022"\n         y="3.1931129" />\n      <g\n         id="roomCoords"\n         transform="translate(-4.1076901)">\n        <text\n           xml:space="preserve"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n           x="207.62897"\n           y="9.9256239"\n           id="roomSize"><tspan\n             sodipodi:role="line"\n             id="tspan7915"\n             x="207.62897"\n             y="9.9256239"\n             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">##x##</tspan></text>\n        <text\n           xml:space="preserve"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n           x="207.62897"\n           y="6.2633014"\n           id="roomPosition"><tspan\n             sodipodi:role="line"\n             id="tspan7919"\n             x="207.62897"\n             y="6.2633014"\n             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">##,##</tspan></text>\n        <rect\n           style="fill:none;fill-opacity:1;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:0.25, 0.25;stroke-dashoffset:0;stroke-opacity:1;paint-order:stroke markers fill"\n           id="rect7925"\n           width="1.6995254"\n           height="1.687674"\n           x="205.32118"\n           y="4.6790504" />\n        <rect\n           style="fill:none;fill-opacity:1;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke markers fill"\n           id="rect7927"\n           width="1.6995254"\n           height="1.687674"\n           x="205.395"\n           y="8.140193" />\n        <rect\n           style="fill:#b3b3b3;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke markers fill"\n           id="rect7583"\n           width="0.72000003"\n           height="0.72000003"\n           x="205.32118"\n           y="4.6790504" />\n      </g>\n      <rect\n         style="fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.249999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="rect15485"\n         width="82.290741"\n         height="8.1206894"\n         x="211.52904"\n         y="3.1931129" />\n      <g\n         id="g1047"\n         transform="translate(-3.6930949)">\n        <text\n           xml:space="preserve"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:3.52778px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n           x="198.78973"\n           y="8.3698092"\n           id="roomId"><tspan\n             sodipodi:role="line"\n             id="tspan7889"\n             x="198.78973"\n             y="8.3698092"\n             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:3.52778px;font-family:Seshat;-inkscape-font-specification:Seshat;fill:#ffffff;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">20</tspan></text>\n        <rect\n           style="display:inline;fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n           id="roomCheckbox"\n           width="2.1188188"\n           height="2.118819"\n           x="196.13205"\n           y="6.2062039" />\n      </g>\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="213.28682"\n         y="6.2076621"\n         id="roomLine1"><tspan\n           sodipodi:role="line"\n           id="tspan9577"\n           x="213.28682"\n           y="6.2076621"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum </tspan></text>\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="213.28682"\n         y="9.680934"\n         id="roomLine2"><tspan\n           sodipodi:role="line"\n           id="tspan15487"\n           x="213.28682"\n           y="9.680934"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum </tspan></text>\n    </g>\n    <path\n       style="fill:none;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"\n       d="M 188.35784,3.086963 V 206.91304"\n       id="path16297" />\n    <path\n       style="fill:none;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"\n       d="M 188.41538,160.882 H 293.90144"\n       id="path16299"\n       sodipodi:nodetypes="cc" />\n    <path\n       style="fill:none;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"\n       d="m 243.67492,160.98116 v 45.98893"\n       id="path16372" />\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="8.3158512"\n       y="5.2294226"\n       id="adventureHeader"><tspan\n         sodipodi:role="line"\n         id="tspan7575"\n         x="8.3158512"\n         y="5.2294226"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">The legend of </tspan></text>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:6.35px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="8.3211432"\n       y="12.741782"\n       id="adventureTitle"><tspan\n         sodipodi:role="line"\n         id="tspan7579"\n         x="8.3211432"\n         y="12.741782"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:6.35px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">The legend of </tspan></text>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="17.754328"\n       y="34.979179"\n       id="gridNumber"><tspan\n         sodipodi:role="line"\n         id="tspan16749"\n         x="17.754328"\n         y="34.979179"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">99</tspan></text>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:3.52778px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="17.995621"\n       y="27.988066"\n       id="gridCol"><tspan\n         sodipodi:role="line"\n         id="tspan16741"\n         x="17.995621"\n         y="27.988066"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:3.52778px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:center;text-anchor:middle;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">99</tspan></text>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:3.52778px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:end;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="11.579646"\n       y="35.49913"\n       id="gridRow"><tspan\n         sodipodi:role="line"\n         id="tspan16745"\n         x="11.579646"\n         y="35.49913"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:3.52778px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:end;text-anchor:end;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">99</tspan></text>\n    <rect\n       style="fill:none;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="gridGuide"\n       width="8.5780792"\n       height="8.5780802"\n       x="13.438278"\n       y="29.893784" />\n    <rect\n       style="fill:none;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.15;stroke-miterlimit:4;stroke-dasharray:0.15, 0.45;stroke-dashoffset:0;stroke-opacity:1"\n       id="gridCell"\n       width="8.5780792"\n       height="8.5780802"\n       x="13.438276"\n       y="29.893784" />\n    <rect\n       style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:0.5;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="startingRoom"\n       width="8.5780792"\n       height="8.5780802"\n       x="13.438278"\n       y="29.893784" />\n    <rect\n       style="fill:#ffffff;fill-rule:evenodd;stroke:#000000;stroke-width:0.5;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="doorUp"\n       width="2.6700983"\n       height="1.2517359"\n       x="16.392269"\n       y="29.25157" />\n    <rect\n       style="fill:#ffffff;fill-rule:evenodd;stroke:#000000;stroke-width:0.5;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="doorDown"\n       width="2.6700983"\n       height="1.2517359"\n       x="16.392269"\n       y="37.828945" />\n    <rect\n       style="fill:#ffffff;fill-rule:evenodd;stroke:#000000;stroke-width:0.5;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="doorRight"\n       width="1.2539999"\n       height="2.6700001"\n       x="21.439993"\n       y="32.847824" />\n    <rect\n       style="fill:#ffffff;fill-rule:evenodd;stroke:#000000;stroke-width:0.5;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       id="doorLeft"\n       width="1.2539999"\n       height="2.6700001"\n       x="12.788461"\n       y="32.847824" />\n    <g\n       id="serviceBox"\n       transform="translate(0.52916663,-0.14419135)">\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="121.66388"\n         y="7.0703306"\n         id="serviceName"><tspan\n           sodipodi:role="line"\n           id="tspan908"\n           x="121.66388"\n           y="7.0703306"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Service</tspan></text>\n      <rect\n         style="display:inline;fill:#ffffff;fill-rule:evenodd;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n         id="serviceCheckbox"\n         width="2.1188188"\n         height="2.118819"\n         x="117.87331"\n         y="5.1485243" />\n    </g>\n    <rect\n       style="fill:#b3b3b3;stroke-width:0.25;stroke-dasharray:0.25, 0.25"\n       id="rect954"\n       width="176.92743"\n       height="4.2387276"\n       x="8.1851292"\n       y="15.445461" />\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;display:inline;fill:#ffffff;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="9.3287992"\n       y="18.247232"\n       id="goldNotes"><tspan\n         sodipodi:role="line"\n         id="tspan950"\n         x="9.3287992"\n         y="18.247232"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#ffffff;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">goldNotes</tspan></text>\n    <path\n       style="fill:none;stroke:#b3b3b3;stroke-width:0.251203;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="m 116.20575,15.492869 v -2.108941 l 0.62615,-0.568403 -0.62615,-0.516728 V 8.8367106 l 0.52178,-0.5684021 -0.52178,-0.5167292 V 6.9764855 l 0.7305,-0.5684021 -0.7305,-0.7234209 V 3.2160093 h 68.77369 v 1.1768302 l -0.67832,0.5167292 0.67832,0.5167292 v 0.671748 l -0.52178,0.568402 0.52178,0.3100376 v 5.0122735 l -0.52178,0.723421 0.52178,0.516728 v 0.671749 l -0.56266,0.340776 0.56266,0.382645 v 1.161098"\n       id="path966"\n       sodipodi:nodetypes="ccccccccccccccccccccccccc" />\n    <path\n       style="fill:#b3b3b3;stroke:none;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"\n       d="m 116.11899,4.0348958 -0.66146,0.033073 7.4e-4,1.685832 0.22248,0.5796628 -0.22325,0.5457026 v 0 l 0.0331,1.2236979 0.37536,0.3203937 -0.40844,0.2418459 0.16537,3.9687503 0.45805,0.254248 -0.55727,0.274919 -0.0331,2.480468 0.71436,-0.150209 4e-5,-2.109084 0.62008,-0.568441 -0.62012,-0.516764 4e-5,-3.4623213 0.51672,-0.5684409 -0.51676,-0.5167643 4e-5,-0.7751463 0.72343,-0.5684407 -0.72347,-0.7234703 z"\n       id="path868"\n       sodipodi:nodetypes="cccccccccccccccccccccccc" />\n    <circle\n       style="fill:#000000;stroke-width:0.999999"\n       id="path870"\n       cx="243.67516"\n       cy="160.94814"\n       r="0.5375948" />\n    <rect\n       style="fill:#ffffff;stroke-width:1"\n       id="rect908"\n       width="13.602617"\n       height="2.8998742"\n       x="261.99866"\n       y="159.4982" />\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="262.35144"\n       y="161.60464"\n       id="enemyDefense-8"><tspan\n         sodipodi:role="line"\n         id="tspan16619-8-7"\n         x="262.35144"\n         y="161.60464"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Enemy Sheet</tspan></text>\n    <rect\n       style="fill:#ffffff;stroke-width:1"\n       id="rect906"\n       width="11.88013"\n       height="2.8998742"\n       x="210.10507"\n       y="159.35277" />\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="210.5248"\n       y="161.70395"\n       id="text904"><tspan\n         sodipodi:role="line"\n         id="tspan902"\n         x="210.5248"\n         y="161.70395"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Hero Sheet</tspan></text>\n    <circle\n       style="fill:#000000;stroke-width:0.999999"\n       id="circle3323"\n       cx="188.35799"\n       cy="160.94814"\n       r="0.5375948" />\n    <g\n       id="g37799"\n       transform="translate(0,-59.836591)">\n      <rect\n         style="fill:#ffffff;stroke-width:0.999999"\n         id="rect3325"\n         width="13.657472"\n         height="2.8998742"\n         x="-158.47729"\n         y="186.90805"\n         transform="rotate(-90)" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:end;text-anchor:end;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="-157.8889"\n         y="189.25923"\n         id="text3329"\n         transform="rotate(-90)"><tspan\n           sodipodi:role="line"\n           id="tspan3327"\n           x="-157.8889"\n           y="189.25923"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Rooms Table</tspan></text>\n    </g>\n    <circle\n       style="fill:#000000;stroke-width:0.999999"\n       id="circle3331"\n       cx="188.35799"\n       cy="22.757284"\n       r="0.5375948" />\n    <g\n       id="g19936"\n       transform="translate(-3.6720677,-3.0096355)">\n      <rect\n         style="display:inline;fill:#ffffff;stroke-width:1"\n         id="rect3366"\n         width="10.740705"\n         height="2.8998742"\n         x="10.285355"\n         y="-193.61218"\n         transform="rotate(90)" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:end;text-anchor:end;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="20.754295"\n         y="-191.52559"\n         id="text3370"\n         transform="rotate(90)"><tspan\n           sodipodi:role="line"\n           id="tspan3368"\n           x="20.754295"\n           y="-191.52559"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:end;text-anchor:end;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Inventory</tspan></text>\n    </g>\n    <path\n       style="fill:none;stroke:#000000;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"\n       d="M 8.158692,22.757282 H 188.13943"\n       id="path19929"\n       sodipodi:nodetypes="cc" />\n    <g\n       id="g3364"\n       transform="rotate(-90,144.43908,70.458272)">\n      <rect\n         style="display:inline;fill:#ffffff;stroke-width:1"\n         id="rect3325-3"\n         width="5.8522635"\n         height="2.8998742"\n         x="19.73786"\n         y="-193.59001"\n         transform="rotate(90)" />\n      <text\n         xml:space="preserve"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:end;text-anchor:end;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n         x="20.291265"\n         y="-191.23883"\n         id="text3329-6"\n         transform="rotate(90)"><tspan\n           sodipodi:role="line"\n           id="tspan3327-5"\n           x="20.291265"\n           y="-191.23883"\n           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Map</tspan></text>\n    </g>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="13.136482"\n       y="204.46982"\n       id="footer"><tspan\n         sodipodi:role="line"\n         id="tspan37785"\n         x="13.136482"\n         y="204.46982"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Footer</tspan></text>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="-292.19608"\n       y="-4.9749269"\n       id="roomLine1UpsideDown"\n       transform="scale(-1)"><tspan\n         sodipodi:role="line"\n         id="tspan328"\n         x="-292.19608"\n         y="-4.9749269"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum </tspan></text>\n    <text\n       xml:space="preserve"\n       style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;line-height:1.25;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;display:inline;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none"\n       x="-292.19608"\n       y="-8.4481983"\n       id="roomLine2UpsideDown"\n       transform="scale(-1)"><tspan\n         sodipodi:role="line"\n         id="tspan332"\n         x="-292.19608"\n         y="-8.4481983"\n         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.58978px;font-family:Seshat;-inkscape-font-specification:Seshat;text-align:start;text-anchor:start;fill:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none">Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum </tspan></text>\n    <circle\n       style="display:inline;fill:#ffffff;stroke:#b3b3b3;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n       id="goldLeft"\n       cx="39.290623"\n       cy="17.564825"\n       r="1.1845" />\n    <circle\n       style="display:inline;fill:#ffffff;stroke:#000000;stroke-width:0.25;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1;paint-order:normal"\n       id="goldLeftMark"\n       cx="39.290623"\n       cy="17.564825"\n       r="1.1845" />\n  </g>\n</svg>\n'},{run:(o,t,n,r)=>{if(Global.USE_CANVG){let o=e.cache["svg/model.svg"];o=o.replace(/x="-157.8889"/g,'x="-145.5"'),o=o.replace(/x="20.291265"/g,'x="24.9"'),o=o.replace(/x="252.62047"/g,'x="249"'),e.cache["svg/model.svg"]=o}var a=new i;a.initialize((()=>{var e=a.generateAdventureDaily();e.prepare(),e.createSVG((o=>{let i=" (#"+e.metadata.seed+" - "+e.metadata.title+")",n=" (#"+e.metadata.seed+")",a=o.getSVG();a=a.replaceAll(String.fromCharCode(187),"&#187;"),Global.svgToCanvas(a,2525,1785,(e=>{for(let e in t.meta.description)t.meta.description[e]+=i;for(let e in t.meta.title)t.meta.title[e]+=n;t.data.push({type:"sheet",data:{x:0,y:0,width:420,height:297,frame:!0,model:{EN:{isResource:!0,type:"canvas",canvas:e}}}},{type:"calculator-portrait",data:{x:430,y:0,isVariableZIndex:!1,backgroundColor:{r:120,g:120,b:120,a:1}}}),o._rooms.forEach(((e,o)=>{e.isStartingRoom&&(t.data.push({type:"token-1",data:{x:286,y:4.1+11.55*o,backgroundColor:{r:42,g:255,b:42,a:1},isTransparent:!0,isVariableZIndex:!1,mode:1}}),e.items.forEach((o=>{let i=o.x+e.x,n=o.y+e.y;if(!(o=o.item).isHidden&&"stairs"===o.id)t.data.push({type:"token-0",data:{x:21+12.15*i,y:44+12.15*n,backgroundColor:{r:255,g:42,b:42,a:1},isTransparent:!0,isVariableZIndex:!1,mode:2}})})))})),t.data.push({type:"tray",data:{x:430,y:247,mode:0,backgroundColor:{r:20,g:20,b:20,a:1}}},{type:"dice-d6",data:{x:440,y:252,backgroundColor:{r:42,g:255,b:42,a:1}}},{type:"dice-d6",data:{x:440,y:276,backgroundColor:{r:42,g:255,b:42,a:1}}}),r(t)}))}))}))}}}();